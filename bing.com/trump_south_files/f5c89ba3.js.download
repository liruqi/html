var bfbTel,__extends,BingAtWork;(function(n){function i(t,i){var u,r;if(n.chk(t),t.indexOf)return t.indexOf(i);for(u=t.length,r=0;r<u;r++)if(t[r]===i)return r;return-1}function r(r,u){if(n.chk(r),t&&r.classList)return r.classList.contains(u);var f=r.className.split(" ");return i(f,u)>=0}function e(i,u){(n.chk(i),r(i,u))||(t&&i.classList?i.classList.add(u):i.className+=" "+u)}function o(u,f){if(n.chk(u),r(u,f))if(t&&u.classList)u.classList.remove(f);else{var e=u.className.split(" "),o=i(e,f);o>=0&&e.splice(o,1);u.className=e.join(" ")}}function s(n){sb_st(function(){var r=0,t,i,u;n!=null&&(t=_ge(n),t!=null&&(i=_ge("b_header"),u=i!=null?i.offsetHeight:0,r=sj_go(t,"Top")-u));_w.scroll(0,r)},0)}function h(n,t){return n<t?-1:n>t?1:0}function c(n,t){return t===void 0&&(t=null),n==null||n.length===0?null:t==null?n[0]:n[0][t]}function l(t){return t=n.chk(t),t.charAt(0).toUpperCase()+t.substr(1).replace(/\s(.)/g,function(n){return n.toUpperCase()})}function a(n,t){return n!=null&&t!=null?n.indexOf(t)>-1:!1}function v(n,t,i){for(var u=0,r=n;u<=i&&r!=null;){if(r.id===t)return!0;r=r.parentElement;u++}return!1}function y(n){return n.replace(/"/g,"'")}function p(n){return n==null?"":n.toLowerCase().replace("bingatwork:","")}function w(n,t){var i=_ge(n);return i==null?(i=_d.createElement("style"),i.id=n,i.textContent!==undefined?i.textContent+=t:i.innerText=i.innerText+t,_d.body.appendChild(i),!0):!1}function b(n,t){for(var r=[],u=Object.keys(n).filter(function(n){return isNaN(parseInt(n))}),i=0;i<u.length;i++)t!=null?t(i)&&r.push(n[u[i]]):r.push(n[u[i]]);return r}function k(t,i){var r,u,f;return t==null||t.length<1?"":(r=[],u=t[0],n.containIgnoreCase(u,"sharepoint")&&n.containIgnoreCase(u,".com")?r.push("Sharepoint"):r.push(u),f=5,i&&t.length>f?(r.push("..."),r=r.concat(t.slice(t.length-f+r.length))):r=r.concat(t.slice(1)),r.join("/"))}function d(n,t,i){t===void 0&&(t="jpeg");i===void 0&&(i=!0);var r="data:image/"+t+";base64,"+n;return i?"url("+r+")":r}function g(t,i){switch(t){case n.ErrorReason.Iras401:return n.ProcessingStatus.ErrorMfa;case n.ErrorReason.Iras403:if(i===n.GleamOption.Group)return n.ProcessingStatus.ErrorPrivateGroup;break;case n.ErrorReason.Timeout:return n.ProcessingStatus.Timeout;case n.ErrorReason.NotFound:return n.ProcessingStatus.NoResults}return n.ProcessingStatus.ErrorGeneral}function nt(t){return n.DateTimeFormatter.getFormattedTime(t)}function u(n){n.parentNode!=null&&n.parentNode.removeChild(n)}function tt(n){if(n!=null){var t=_w.ReactDOM;t!=null&&typeof t.unmountComponentAtNode=="function"&&(t.unmountComponentAtNode(n),u(n))}}function f(t,i,r,u,e,o,s){e===void 0&&(e=null);o===void 0&&(o=0);s===void 0&&(s=0);t()?e!=null&&e():(s++,s<i?setTimeout(function(){return f(t,i,r+o,u,e,o,s)},r):bfbInst.log(u+"_TimedOut"))}function it(n){typeof SearchAppWrapper!="undefined"&&SearchAppWrapper.CortanaApp&&SearchAppWrapper.CortanaApp.navigateWebViewAsync?(n.indexOf("http")===-1&&(n=location.protocol+"//"+location.hostname+n),SearchAppWrapper.CortanaApp.navigateWebViewAsync(n)):typeof _w.sj_lc=="function"?_w.sj_lc(n):_w.location.href=n}function rt(n,t){return n==null||t<0||n.length<=t?null:n[t]}function ut(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return function(){for(var t,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];for(t=0;t<n.length;t++)n[t]!=null&&n[t].call(n[t],r)}}function ft(n,t,i){var r,u,f;if(n==null)return null;if(r="",u=t-n.length,u>0)for(f=0;f<u;f++)r+=i;return r+n}var t=document!=null&&document.body!=null&&typeof document.body.classList!="undefined";n.indexOf=i;n.contains=r;n.addClass=e;n.removeClass=o;n.scrollTo=s;n.sortFunc=h;n.firstOrDefault=c;n.toPascalCase=l;n.hasSub=a;n.hasAncestor=v;n.rmDoubleQuotes=y;n.shorten=p;n.tryInsertStyles=w;n.enumToArray=b;n.buildDocLoc=k;n.imgSrc=d;n.mapStatus=g;n.getFormattedTime=nt;n.removeElement=u;n.unmountFromReact=tt;n.poll=f;n.navigateTo=it;n.getNOrDefault=rt;n.createMulticastDelegate=ut;n.padLeft=ft})(BingAtWork||(BingAtWork={})),function(n){var t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt;n.rawCmdEvent="rawcomd";n.rawCmdErr="bfbqasfailure";n.rawDataEvent="rawdata";n.rawDataErr="bfbdatafailure";n.bfbPreExists="bfbPreExists";n.ajaxLoad="ajax.load";n.ajaxUnload="ajax.unload";n.skypeSignedIn="bfbskypesi";n.onTenantConfig="bfbtcfg";n.onBawInitFinish="onBawInitFinish";n.onBingFdbkStart="onFeedbackStarting";n.onBawFloorPlanRendered="onBawFloorPlanRendered";n.onBawFloorPlanRoomFetched="onBawFloorPlanRoomFetched";n.onBawFloorPlanMapFetched="onBawFloorPlanMapFetched";n.onBawFloorPlanLoaded="onBawFloorPlanLoaded";n.onBawBuildingRendered="onBawBuildingRendered";n.onBawGroupAboutRendered="onBawGroupAboutRendered";n.bawSourceName="BingAtWork";n.fireUpsell="bfbup";n.befRndPre="bfr";n.cmdHandled="bfbcmdhld";n.mapUrlTypeStatic="s";n.mapUrlTypeDraggable="d",function(n){n[n.RawQuery=0]="RawQuery";n[n.PersonDocuments=1]="PersonDocuments";n[n.Documents=2]="Documents";n[n.OrgChart=3]="OrgChart";n[n.PersonGroups=4]="PersonGroups";n[n.Command=5]="Command";n[n.Groups=6]="Groups";n[n.GroupMembers=7]="GroupMembers";n[n.GroupConversations=8]="GroupConversations";n[n.GroupFiles=9]="GroupFiles";n[n.GroupDetails=10]="GroupDetails"}(t=n.BfbRequestScenario||(n.BfbRequestScenario={})),function(n){n[n.Person=0]="Person";n[n.Document=1]="Document";n[n.PersonDocument=2]="PersonDocument";n[n.Task=3]="Task";n[n.OrgChart=4]="OrgChart";n[n.Groups=5]="Groups";n[n.GroupMembers=6]="GroupMembers";n[n.GroupConversations=7]="GroupConversations";n[n.GroupFiles=8]="GroupFiles";n[n.GroupDetails=9]="GroupDetails";n[n.Command=10]="Command";n[n.NoMatch=11]="NoMatch";n[n.FloorPlan=12]="FloorPlan";n[n.Buildings=13]="Buildings";n[n.RefQna=14]="RefQna";n[n.PowerBi=15]="PowerBi"}(i=n.BfbResponseScenario||(n.BfbResponseScenario={})),function(n){n[n.PersonalSearch=0]="PersonalSearch";n[n.Command=1]="Command";n[n.Download=2]="Download";n[n.Browse=3]="Browse";n[n.Details=4]="Details"}(r=n.IrasEndpoint||(n.IrasEndpoint={})),function(n){n[n.ContactPhoto=0]="ContactPhoto";n[n.GroupPhoto=1]="GroupPhoto"}(u=n.IrasDownloadKind||(n.IrasDownloadKind={})),function(n){n[n.Person=0]="Person";n[n.Task=1]="Task";n[n.File=2]="File";n[n.Group=3]="Group";n[n.Buildings=4]="Buildings";n[n.Email=5]="Email";n[n.RefQna=6]="RefQna";n[n.PowerBi=7]="PowerBi"}(f=n.ScopeDomain||(n.ScopeDomain={})),function(n){n[n.PersonAbout=0]="PersonAbout";n[n.Documents=1]="Documents";n[n.Organization=2]="Organization";n[n.Groups=3]="Groups";n[n.FloorPlan=4]="FloorPlan"}(e=n.PersonCardPivot||(n.PersonCardPivot={})),function(n){n[n.Personalized=0]="Personalized";n[n.All=1]="All"}(o=n.DocumentSearchPivot||(n.DocumentSearchPivot={})),function(n){n[n.GroupAbout=0]="GroupAbout";n[n.Members=1]="Members";n[n.Files=2]="Files";n[n.Conversations=3]="Conversations"}(s=n.GroupSearchPivot||(n.GroupSearchPivot={})),function(n){n[n.Owners=0]="Owners";n[n.Members=1]="Members";n[n.Files=2]="Files";n[n.Conversations=3]="Conversations"}(h=n.GroupSearchPivot2||(n.GroupSearchPivot2={})),function(n){n[n.Iras401=0]="Iras401";n[n.Iras403=1]="Iras403";n[n.Iras500=2]="Iras500";n[n.IrasOther=3]="IrasOther";n[n.AuthFail=4]="AuthFail";n[n.Timeout=5]="Timeout";n[n.HttpError=6]="HttpError";n[n.Other=7]="Other";n[n.BadParam=8]="BadParam";n[n.NotFound=9]="NotFound";n[n.InvalidData=10]="InvalidData"}(c=n.ErrorReason||(n.ErrorReason={})),function(n){n[n.Started=0]="Started";n[n.Timeout=1]="Timeout";n[n.NoResults=2]="NoResults";n[n.Complete=3]="Complete";n[n.SsoPending=4]="SsoPending";n[n.ErrorPrivateGroup=5]="ErrorPrivateGroup";n[n.ErrorMfa=6]="ErrorMfa";n[n.ErrorGeneral=7]="ErrorGeneral"}(l=n.ProcessingStatus||(n.ProcessingStatus={})),function(n){n[n.MeQueryPromotion=0]="MeQueryPromotion";n[n.SerpRequerySuppression=1]="SerpRequerySuppression";n[n.Person=2]="Person";n[n.BfbRequeryPromotion=3]="BfbRequeryPromotion";n[n.PersonQuerySuppression=4]="PersonQuerySuppression";n[n.GroupSuppression=5]="GroupSuppression";n[n.OrgRelPromotion=6]="OrgRelPromotion";n[n.SuppressFarDistancePartialName=7]="SuppressFarDistancePartialName";n[n.UserExplicit=9]="UserExplicit";n[n.PoleDefaultTreatment=10]="PoleDefaultTreatment";n[n.Groups=11]="Groups";n[n.DisambigPersonsForMobile=12]="DisambigPersonsForMobile";n[n.MobileDefaultPole=13]="MobileDefaultPole";n[n.RefQna=14]="RefQna";n[n.Documents=15]="Documents";n[n.SuppressNonBookmarkForUrlQueries=16]="SuppressNonBookmarkForUrlQueries";n[n.Bookmarks=17]="Bookmarks";n[n.Buildings=18]="Buildings";n[n.OverrideExplicit=19]="OverrideExplicit";n[n.PowerBi=20]="PowerBi"}(a=n.RankingRuleId||(n.RankingRuleId={})),function(n){n[n.Word=0]="Word";n[n.PowerPoint=1]="PowerPoint";n[n.Excel=2]="Excel";n[n.Unexpected=3]="Unexpected"}(v=n.FileType||(n.FileType={})),function(n){n[n.High=0]="High";n[n.Medium=1]="Medium";n[n.Low=2]="Low";n[n.Unknown=3]="Unknown"}(y=n.QueryFrequency||(n.QueryFrequency={})),function(n){n[n.None=0]="None";n[n.Suppress=1]="Suppress";n[n.BingAtWorkRequery=2]="BingAtWorkRequery";n[n.SerpRequery=3]="SerpRequery";n[n.Upsell=4]="Upsell"}(p=n.QueryBehavior||(n.QueryBehavior={})),function(n){n[n.Low=0]="Low";n[n.Medium=1]="Medium";n[n.High=2]="High"}(w=n.WebIntentConfidence||(n.WebIntentConfidence={})),function(n){n[n.None=0]="None";n[n.OrgChart=1]="OrgChart";n[n.Email=2]="Email";n[n.Office=3]="Office";n[n.Phone=4]="Phone";n[n.Title=5]="Title";n[n.Department=6]="Department";n[n.Group=7]="Group";n[n.GroupMembers=8]="GroupMembers";n[n.GroupFiles=9]="GroupFiles";n[n.GroupConversations=10]="GroupConversations";n[n.Building=11]="Building";n[n.PersonDocs=12]="PersonDocs";n[n.Alias=13]="Alias"}(b=n.QueryIntent||(n.QueryIntent={})),function(n){n[n.SkipLevelManager=0]="SkipLevelManager";n[n.Manager=1]="Manager";n[n.Hero=2]="Hero";n[n.Direct=3]="Direct"}(k=n.OrgChartPersonType||(n.OrgChartPersonType={})),function(n){n[n.UserIsPeer=0]="UserIsPeer";n[n.UserIsReport=1]="UserIsReport";n[n.UserIsManager=2]="UserIsManager";n[n.UserIsSelf=3]="UserIsSelf";n[n.UserIsNotInOrg=4]="UserIsNotInOrg"}(d=n.OrgRelationship||(n.OrgRelationship={})),function(n){n[n.Email=0]="Email";n[n.Phone=1]="Phone";n[n.Office=2]="Office";n[n.GroupOwners=3]="GroupOwners";n[n.Other=4]="Other"}(g=n.DataType||(n.DataType={})),function(n){n[n.email=0]="email";n[n.office=1]="office";n[n.phone=2]="phone";n[n.title=3]="title";n[n.department=4]="department";n[n.people_graph=5]="people_graph";n[n.Members=6]="Members";n[n.Files=7]="Files";n[n.Conversations=8]="Conversations";n[n.groups=9]="groups";n[n.person_docs=10]="person_docs";n[n.alias=11]="alias"}(nt=n.AttributeMetadataHint||(n.AttributeMetadataHint={})),function(n){n[n.Suppress=0]="Suppress";n[n.ShowLink=1]="ShowLink";n[n.ShowNote=2]="ShowNote"}(tt=n.NoteBehavior||(n.NoteBehavior={})),function(n){n[n.People=0]="People";n[n.Documents=1]="Documents";n[n.Bookmarks=2]="Bookmarks";n[n.Group=3]="Group";n[n.Buildings=4]="Buildings";n[n.PowerBi=5]="PowerBi"}(it=n.GleamOption||(n.GleamOption={})),function(n){n[n.High=0]="High";n[n.Low=1]="Low";n[n.None=2]="None"}(rt=n.ConfidenceQueryItem||(n.ConfidenceQueryItem={})),function(n){n[n.FloorPlan=0]="FloorPlan"}(ut=n.ResourceDependency||(n.ResourceDependency={})),function(n){n[n.People=0]="People";n[n.PeopleDisambig=1]="PeopleDisambig";n[n.Documents=2]="Documents";n[n.Bookmarks=3]="Bookmarks";n[n.Group=4]="Group";n[n.GroupDisambig=5]="GroupDisambig";n[n.Buildings=6]="Buildings";n[n.RefQna=7]="RefQna";n[n.PowerBi=8]="PowerBi"}(ft=n.Treatment||(n.Treatment={})),function(n){n[n.Unknown=0]="Unknown";n[n.Offline=1]="Offline";n[n.Online=2]="Online";n[n.Away=3]="Away";n[n.Busy=4]="Busy";n[n.BeRightBack=5]="BeRightBack";n[n.DoNotDisturb=6]="DoNotDisturb";n[n.Inactive=7]="Inactive"}(et=n.PresenceStatus||(n.PresenceStatus={})),function(n){n[n.None=0]="None";n[n.Pole=1]="Pole";n[n.ContextRegionTop=2]="ContextRegionTop";n[n.ContextRegionBottom=3]="ContextRegionBottom";n[n.Algo=4]="Algo"}(ot=n.AnswerPlacement||(n.AnswerPlacement={})),function(n){n[n.a="a"]="a";n[n.blockquote="blockquote"]="blockquote";n[n.br="br"]="br";n[n.code="code"]="code";n[n.div="div"]="div";n[n.em="em"]="em";n[n.h1="h1"]="h1";n[n.h2="h2"]="h2";n[n.h3="h3"]="h3";n[n.h4="h4"]="h4";n[n.hr="hr"]="hr";n[n.img="img"]="img";n[n.li="li"]="li";n[n.ol="ol"]="ol";n[n.ul="ul"]="ul";n[n.p="p"]="p";n[n.pre="pre"]="pre";n[n.strong="strong"]="strong";n[n.text="#text"]="text"}(st=n.QnaItemType||(n.QnaItemType={})),function(n){n[n.Append=0]="Append";n[n.InsertAsFirst=1]="InsertAsFirst";n[n.InsertBeforeGrandchild=2]="InsertBeforeGrandchild"}(ht=n.ElementInsertBehavior||(n.ElementInsertBehavior={})),function(n){n[n.Detached=0]="Detached";n[n.Attaching=1]="Attaching";n[n.Attached=2]="Attached"}(ct=n.ElementAttachmentState||(n.ElementAttachmentState={})),function(n){n[n.ContextRegion=0]="ContextRegion";n[n.DisambigSlim=1]="DisambigSlim";n[n.GroupMember=2]="GroupMember";n[n.OrgHero=3]="OrgHero";n[n.OrgDirect=4]="OrgDirect";n[n.OrgManager=5]="OrgManager";n[n.OrgPeer=6]="OrgPeer";n[n.OrgSkipManager=7]="OrgSkipManager";n[n.OrgInline=8]="OrgInline"}(lt=n.NameCardType||(n.NameCardType={})),function(n){n[n.V1_0=0]="V1_0";n[n.V1_1=1]="V1_1"}(at=n.UxDesignVersion||(n.UxDesignVersion={})),function(n){n[n.Unsent=0]="Unsent";n[n.Opened=1]="Opened";n[n.HeadersReceived=2]="HeadersReceived";n[n.Loading=3]="Loading";n[n.Done=4]="Done"}(vt=n.AjaxState||(n.AjaxState={})),function(n){n[n.Free=0]="Free";n[n.Tentative=1]="Tentative";n[n.Busy=2]="Busy";n[n.OutOfOffice=3]="OutOfOffice";n[n.NoData=4]="NoData"}(yt=n.CalendarAvailability||(n.CalendarAvailability={}))}(BingAtWork||(BingAtWork={})),function(n){var i=function(){function i(){}return i.init=function(n){n!=null&&!n.isMtr&&n.cfg!=null&&n.cfg.e&&(i.ctx=n,i.enabled=!0,i.enabled&&!i.initialized&&(i.initialized=!0,i.ariaLogger=AriaTelemetry.getLogger(n.cfg.t)),sj_evt.bind(i.signedinEvt,function(){i.log(t.BingAtWork,"SignedIn_Events")},!0,null,!0),sj_evt.bind(i.signedoutEvt,function(){i.log(t.BingAtWork,"SignedOut_Events")},!0,null,!0),i.log(t.Diag,"Diag_Events",{EdgeRef:n.eref}))},i.logShown=function(n,t,r){t!=null&&(r=r||{},r.T=t);i.log(n,"Shown_Events",r)},i.logRanking=function(n){var r=n.placement,u=n.treatment,f=n.rankingRuleId;i.log(t.BingAtWork,"Ranking_Events",{P:r,T:u,R:f})},i.logQuery=function(n){var r=n.encryptedQuery,u=n.queryCount,f=n.queryFrequency,e=n.bhvr,o=n.webIntentConf,s=n.ssp,h=n.intent,c=n.up,l=n.groupId;i.log(t.BingAtWork,"Query_Events",{QRY:r,CNT:u,FRQ:f,BHVR:e,CONF:o,SSP:s,INT:h,UP:c,GID:l})},i.logClicked=function(n,t,r,u){t!=null&&(u=u||{},t!=null&&(u.T=t),r!=null&&(u.S=r));i.log(n,"Clicked_Events",u)},i.logValue=function(n,t,r,u){u=u||{};u.N=t;u.V=r;i.log(n,"Value_Events",u)},i.logRtt=function(n,t,r,u){var f=bfbInst.getRequestRtt(r,u),e=f==null?"NOPERF":f.getCall.toFixed(2),o={N:t,V:e};i.log(n,"Rtt_Events",o)},i.log=function(r,u,f){var s,h,c,l;if(i.enabled&&i.ariaLogger!=null){var e=i.ctx,a=e.cfg,v=e.ig,y=e.sid,p=e.tid,w=e.uid,b=e.muid,k=e.f,d=e.tn,g=e.msa,nt=e.mkt,tt=e.b,o={eventType:"Client_Events",name:u||"",properties:{ENV:{value:a.env||""},SC:{value:r},IG:{value:v||""},SID:{value:y||""},TID:{value:p||""},UID:{value:w||""},MUID:{value:b||""},F:{value:k||""},TN:{value:d||""},MSA:{value:g||""},MKT:{value:nt||""},B:{value:tt||""}}};if(f!=null)for(s=0,h=Object.getOwnPropertyNames(f);s<h.length;s++)c=h[s],l=f[c],o.properties[c]={value:l!=null?l:""};i.ariaLogger.logEvent(o)}},i.signedinEvt="aad:signedin",i.signedoutEvt="aad:signedout",i.ariaLogger=null,i.enabled=!1,i.initialized=!1,i}(),t;n.WebTelemetry=i,function(n){n[n.BingAtWork=0]="BingAtWork";n[n.BfbController=1]="BfbController";n[n.Gleam=2]="Gleam";n[n.Upsell=3]="Upsell";n[n.Feedback=4]="Feedback";n[n.Paw=5]="Paw";n[n.SkypeClient=6]="SkypeClient";n[n.Person=7]="Person";n[n.Document=8]="Document";n[n.Bookmark=9]="Bookmark";n[n.Building=10]="Building";n[n.FloorPlan=11]="FloorPlan";n[n.OrgChart=12]="OrgChart";n[n.Group=13]="Group";n[n.RefQna=14]="RefQna";n[n.PowerBi=15]="PowerBi";n[n.Diag=999]="Diag"}(t=n.EventScope||(n.EventScope={}))}(BingAtWork||(BingAtWork={}));bfbTel=BingAtWork.WebTelemetry,function(n){var t;(function(t){var i=function(){function t(t){this.dataService=n.chk(t)}return t.prototype.img=function(i,r,u){var o=this,f,e;if(n.nullOrWs(i)){u(null);return}f={onSuccess:function(i){u(o.buildPhotoResponse(i));t.perfLogged||(bfbInst.logRtt("PDWLD",["download"]),bfbTel.logRtt(n.EventScope.Paw,"PDWLD",["download"]),t.perfLogged=!0)},onError:function(t){u(null)}};e={endpoint:n.IrasEndpoint.Download,downloadKind:r,qry:i};this.dataService.qry(e,f)},t.prototype.buildPhotoResponse=function(n){if(n==null||n.FileStreamInBase64==null||n.FileStreamInBase64.length===0)return null;return{base64Image:n.FileStreamInBase64}},t.perfLogged=!1,t}();t.DownloadService=i})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={})),function(n){var t=function(){function t(t){this.definition=t;this.attachmentState=n.ElementAttachmentState.Detached}return t.prototype.attach=function(t){var i=this;this.attachmentState===n.ElementAttachmentState.Detached&&(this.element==null&&this.create(),this.attachmentState=n.ElementAttachmentState.Attaching,this.insertElementWhenParentExists(function(){i.attachmentState=n.ElementAttachmentState.Attached;t!=null&&t()}),this.definition.renderContent(this.element))},t.prototype.detach=function(){this.attachmentState===n.ElementAttachmentState.Attached&&(this.element!=null&&(n.unmountFromReact(this.element),n.removeElement(this.element)),this.attachmentState=n.ElementAttachmentState.Detached)},t.prototype.create=function(){this.remove();this.element=sj_ce(this.definition.tagName,this.definition.elementId,this.definition.className)},t.prototype.remove=function(){this.element!=null&&(n.removeElement(this.element),this.element=null);var t=_ge(this.definition.elementId);t!=null&&n.removeElement(t)},t.prototype.insertElementWhenParentExists=function(t){var i=this,r=function(){var n=_ge(i.definition.parentElementId);return n==null?!1:(i.insertElement(n),!0)};n.poll(r,20,5,"insertElementWhenParentExists_"+this.definition.elementId,t,10)},t.prototype.insertElement=function(t){if(this.element!=null&&t!=null)switch(this.definition.insertBehavior){case n.ElementInsertBehavior.Append:t.appendChild(this.element);break;case n.ElementInsertBehavior.InsertAsFirst:t.insertBefore(this.element,t.firstChild);break;case n.ElementInsertBehavior.InsertBeforeGrandchild:if(n.nullOrWs(this.definition.insertBeforeGrandchildClass))return;var i=t.getElementsByClassName(this.definition.insertBeforeGrandchildClass);i.length>0?t.insertBefore(this.element,i[0].parentNode):t.appendChild(this.element)}},t}();n.BfbContainer=t}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i,r;i=function(){function i(t,i,r){this.isResponseHandled=!1;this.gotCmdResponse=!1;this.gotDataResponse=!1;this.dataErrReason=null;this.cmdEventsBound=!1;this.dataInCommandResponseMap={};this.controllers=n.chk(r,2);this.storeBuilder=n.chk(i,1);this.ctx=n.chk(t);this.pawResponseBuilder=new n.Service.PawResponseBuilder(this.ctx.cfg);this.controllers.veil.initNonWorkResultsVeil();this.dataInCommandResponseMap[n.BfbResponseScenario.Person]=!0;this.dataInCommandResponseMap[n.BfbResponseScenario.Task]=!0;this.dataInCommandResponseMap[n.BfbResponseScenario.Buildings]=this.ctx.cfg.ft.bld.e;this.dataInCommandResponseMap[n.BfbResponseScenario.RefQna]=this.ctx.cfg.ft.qna.e;this.controllers.gleam.setCommandBindFunction(this.bindCommandEvents.bind(this))}return i.prototype.init=function(){var t=this,r,u;this.dataStore=this.storeBuilder.createReduxStore(this.buildActionListeners(),this.controllers.veil.getIsVeilCancelled());this.actionCreators=n.Actions.actionCreators;this.ctx.qrynf=function(){return n.Reducers.QueryInfo.getQueryInfo(t.dataStore.getState())};this.ctx.cfg.ft.cf.e||this.ctx.qrynf().ssp&&!this.ctx.cfg.ft.mq.e||this.controllers.gleam.renderGleam();this.ctx.qrynf().up||(r=_ge("bw-upslb"),r!=null&&(r.parentElement.removeChild(r),bfbInst.log("BarDeleted"),bfbTel.logClicked(n.EventScope.Upsell,"DSMC")));this.controllers.shared.setProgress(this.ctx.qrynf().ssp?n.ProcessingStatus.SsoPending:n.ProcessingStatus.Started);this.ctx.qrynf().bhvr===n.QueryBehavior.BingAtWorkRequery&&this.ctx.cfg.ft.grpsrch.e&&this.ctx.qrynf().intent===n.QueryIntent.Group?(u=function(){t.controllers.grp.groupSearchById(t.ctx.qrynf().groupId);t.dataStore.dispatch(t.actionCreators.setSearchScenario(n.GleamOption.Group))},this.ctx.qrynf().ssp?sj_evt.bind(i.signedinEvt,u,!0,null,!0):u()):this.bindCommandEvents(!0);sj_evt.bind("BAWSearch",function(n){if(n.length>1){var i=n[1];t.controllers.gleam.setGleamOption(i)}});sj_evt.bind("OnScriptLoad:BingAtWork:FloorPlanBundle",function(){t.isFloorPlanLoaded=!0;t.dataStore.dispatch(t.actionCreators.loadDependencyCompleted(n.ResourceDependency.FloorPlan))},!0,null,!0)},i.prototype.handleCommandResponse=function(t){var r,s,i,u,f,e,o;return(this.controllers.gleam.renderGleam(),r=this.controllers.shared.getCommand(),t==null||r!=null)?r:(t.AnswerData!=null&&this.dataStore.dispatch(this.actionCreators.setAnswerData(t.AnswerData)),s=this.ctx.qrynf(),i=n.Service.PawResponseBuilder.getBfbCommand(s,this.ctx.cfg,t),i!=null&&i.userInfo!=null&&this.dataStore.dispatch(this.actionCreators.createOrUpdateUserInfo(i.userInfo)),sj_evt.fire(n.cmdHandled,i==null||i.userInfo==null?null:i.userInfo.UPN),i!=null&&((i.domain!==n.ScopeDomain.Buildings||this.ctx.cfg.ft.bld.e)&&(i.domain!==n.ScopeDomain.Group||this.ctx.cfg.ft.grpsrch.e)&&(i.domain!==n.ScopeDomain.RefQna||this.ctx.cfg.ft.qna.e)&&(i.domain!==n.ScopeDomain.PowerBi||this.ctx.cfg.ft.powerbi.e)||(i=null)),!this.doesIntentMatchDomain(i))?(this.showMismatchNoResults(),i):(this.dataStore.dispatch(this.actionCreators.setCommand(i)),this.dataStore.dispatch(this.actionCreators.setSearchScenario(this.controllers.gleam.getGleamOption())),this.controllers.rank.rankAndRouteBeforeDataResponse(),bfbInst.sLog("Domain",i==null?"":i.analysis.Domain),bfbTel.logValue(n.EventScope.BfbController,"Domain",i==null?"":i.analysis.Domain),u=this.controllers.shared.getQuery(),f=i==null||n.nullOrWs(i.qry)?u:i.qry,this.controllers.gleam.setLastCommandQuery(f!==u?f:null),this.ctx.qrynf().up&&(i==null||i.scenario===n.BfbResponseScenario.NoMatch?sj_evt.fire(n.fireUpsell):(e=_ge("bw"),o=_ge("bw-ans"),e!=null&&o!=null&&(e.className="bw",o.style.height="auto"))),i)},i.prototype.doesIntentMatchDomain=function(t){if(t==null)return!1;var i=t.domain;switch(this.ctx.qrynf().intent){case n.QueryIntent.Building:return i===n.ScopeDomain.Buildings;case n.QueryIntent.Group:return i===n.ScopeDomain.Group||i===n.ScopeDomain.Person;case n.QueryIntent.GroupConversations:case n.QueryIntent.GroupFiles:case n.QueryIntent.GroupMembers:return i===n.ScopeDomain.Group;case n.QueryIntent.Office:case n.QueryIntent.Department:case n.QueryIntent.Email:case n.QueryIntent.Title:case n.QueryIntent.Alias:case n.QueryIntent.PersonDocs:return i===n.ScopeDomain.Person;default:return!0}},i.prototype.showMismatchNoResults=function(){var i=t.GleamController.mapIntent(this.ctx.qrynf().intent);switch(i){case n.GleamOption.Buildings:this.actionCreators.buildingCompleted(null);break;case n.GleamOption.Group:this.actionCreators.groupCompleted(null);break;case n.GleamOption.People:this.actionCreators.peopleCompleted(null,null)}this.dataStore.dispatch(this.actionCreators.setSearchScenario(i));this.controllers.shared.setProgress(n.ProcessingStatus.NoResults);this.controllers.rank.rankAndRouteBeforeDataResponse()},i.prototype.loadFloorPlanBundle=function(){this.isFloorPlanLoaded||typeof n.floorPlanBundle!="function"||this.isFloorPlanLoading||(this.isFloorPlanLoading=!0,this.dataStore.dispatch(this.actionCreators.loadDependencyRequest(n.ResourceDependency.FloorPlan)),n.floorPlanBundle())},i.prototype.handleRawQueryResponse=function(t,i){var u,f;i===void 0&&(i=!1);this.isResponseHandled=!0;var r=this.controllers.shared.getCommand(),e=r!=null&&r.scenario===n.BfbResponseScenario.Document,o=t==null||t.scenario==null;if(o&&!e){this.controllers.shared.setProgress(n.ProcessingStatus.NoResults);return}if(o&&e){u=r==null||r.analysis==null?null:r.analysis;f=null;u!=null&&(f={files:null,userInfo:t==null?null:t.userInfo,keyword:n.firstOrDefault(u.KeyWords,"Keyword"),personName:n.firstOrDefault(u.Persons,"Name"),scenario:n.BfbResponseScenario.Document});this.controllers.doc.document(f,!0);return}this.processRawQueryResponseData(t);t.scenario===n.BfbResponseScenario.Document?this.controllers.doc.document(t,!1):this.controllers.rank.rankAndRoute(t);i?this.controllers.rank.promoteRankToExplicitPole():(bfbInst.sLog("BawPLT",(Date.now()-_G.ST.getTime()).toFixed(2).toString()),bfbTel.logValue(n.EventScope.BfbController,"PageLoadTime",(Date.now()-_G.ST.getTime()).toFixed(2).toString()))},i.prototype.processRawQueryResponseData=function(t){var i,r,u,f,e,o,s,h;if(t!=null&&t.scenario!=null)switch(t.scenario){case n.BfbResponseScenario.Person:i=t;this.dataStore.dispatch(this.actionCreators.peopleCompleted(i.heroPerson,i.all));break;case n.BfbResponseScenario.Task:r=t;this.dataStore.dispatch(this.actionCreators.bookmarksCompleted(r.task));break;case n.BfbResponseScenario.Document:u=t;this.dataStore.dispatch(this.actionCreators.documentsCompleted(u));break;case n.BfbResponseScenario.Groups:f=t;e=n.Reducers.Group.getValidGroups(f.groups);this.dataStore.dispatch(this.actionCreators.groupCompleted(e));break;case n.BfbResponseScenario.Buildings:o=t;this.dataStore.dispatch(this.actionCreators.buildingCompleted(o.building));break;case n.BfbResponseScenario.RefQna:this.ctx.cfg.ft.qna.e&&(s=t,this.dataStore.dispatch(this.actionCreators.refQnaCompleted(s.refQna)));break;case n.BfbResponseScenario.PowerBi:this.ctx.cfg.ft.powerbi.e&&(h=t,this.dataStore.dispatch(this.actionCreators.powerBiCompleted(h.cards)));break;default:throw new Error("Processing of "+t.scenario+" is not yet implemented");}},i.prototype.bindCommandEvents=function(t){var i=this;(t===void 0&&(t=!1),this.cmdEventsBound)||(this.cmdEventsBound=!0,sj_evt.bind(n.rawCmdEvent,function(t){var u,r,f;i.gotCmdResponse=!0;bfbInst.logRtt("PQC",["command"],["execution"]);bfbInst.logRtt("POPAT",["pawaccesstoken"]);bfbTel.logRtt(n.EventScope.BfbController,"PQC",["command"],["execution"]);bfbTel.logRtt(n.EventScope.BfbController,"POPAT",["pawaccesstoken"]);i.isResponseHandled||(u=t[1],r=i.handleCommandResponse(u),r!=null&&(i.dataInCommandResponseMap[r.scenario]?(f=i.buildCmdSearchResponse(r,u),i.handleRawQueryResponse(f)):i.dataErrReason!=null&&i.controllers.shared.handleRqstFail(i.dataErrReason)))},t,null,!0),sj_evt.bind(n.rawCmdErr,function(n){i.controllers.gleam.renderGleam();i.gotCmdResponse=!0;i.handleRequestFail(n[1])},t,null,!0),sj_evt.bind(n.rawDataEvent,function(t){var u,r,f,e;i.gotDataResponse=!0;bfbInst.logRtt("PDC",["commandexecution"]);bfbTel.logRtt(n.EventScope.BfbController,"PDC",["pawaccesstoken"]);u=t[1];r=t[2];(!i.isResponseHandled||r)&&(f=i.handleCommandResponse(u),f!=null&&(e=i.buildCmdSearchResponse(f,u),r&&i.controllers.rank.promoteRankToExplicitPole(),i.handleRawQueryResponse(e,r)))},t,null,!0),sj_evt.bind(n.rawDataErr,function(n){i.controllers.gleam.renderGleam();i.gotDataResponse=!0;var t=n[1];i.dataErrReason=t;i.handleRequestFail(t)},t,null,!0))},i.prototype.handleRequestFail=function(n){var t=this.controllers.shared.getCommand(),i=t!=null,r=this.gotCmdResponse&&this.gotDataResponse&&!i,u=i&&this.dataErrReason!=null&&!this.dataInCommandResponseMap[t.scenario];(r||u)&&this.controllers.shared.handleRqstFail(n)},i.prototype.buildCmdSearchResponse=function(t,i){var r;if(t==null||i==null||(r=n.getFirstScopeAnalysis(i.ScopeAnalysis),r==null))return null;var u=t.scenario===n.BfbResponseScenario.Person,f=u?r.QasIndexItems:i.ItemGroups,e=f!=null&&f.length!==0;if((t.domain===n.ScopeDomain.Person||t.domain===n.ScopeDomain.File)&&!e)return null;switch(t.scenario){case n.BfbResponseScenario.Task:return n.Service.PawResponseBuilder.buildTaskResponse(t.analysis);case n.BfbResponseScenario.Buildings:return this.ctx.cfg.ft.bld.e?n.Service.PawResponseBuilder.buildBuildingsResponse(t.analysis):null;case n.BfbResponseScenario.RefQna:return this.ctx.cfg.ft.qna.e?n.Service.PawResponseBuilder.buildRefQnaResponse(t.analysis):null;case n.BfbResponseScenario.PowerBi:return this.ctx.cfg.ft.powerbi.e?n.Service.PawResponseBuilder.buildPowerBiResponse(t.analysis):null;default:return this.pawResponseBuilder.buildSearchResponse(t.scenario,n.getResp(i,u),t.qry,t)}},i.prototype.buildActionListeners=function(){var n=this;return{onLoadDependencyExecuted:function(t){return n.loadDependency(t)}}},i.prototype.loadDependency=function(t){switch(t){case n.ResourceDependency.FloorPlan:this.loadFloorPlanBundle()}},i.signedinEvt="aad:signedin",i}();t.BfbController=i,function(t){t.bfbNativeAjaxUnload||sj_evt.bind(n.ajaxUnload,function(){var r,t,i,u;for(r=[_ge("bw-glm")],t=0,i=r;t<i.length;t++)u=i[t],n.unmountFromReact(u)});t.bfbNativeAjaxUnload=!0}(r=t.Impl||(t.Impl={}))})(t=n.Controller||(n.Controller={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i=function(){function t(t,i,r,u,f,e,o,s){this.ctx=n.chk(t);this.skypeController=n.chk(i,1);this.docController=n.chk(r,2);this.orgChartController=n.chk(u,3);this.locController=n.chk(f,4);this.gleamController=n.chk(e,5);this.rankController=n.chk(o,6);this.photoController=n.chk(s,7)}return t.prototype.init=function(n,t){this.dataStore=n;this.actionCreators=t},t.prototype.buildActionListeners=function(t){var i=this;t.onSearchPeopleInplaceExecuting=function(t,r){var u,f,e;n.scrollTo();u=_ge("sb_form_q");u!=null&&(u.value=t);_w.history&&typeof _w.history.pushState=="function"&&(f=n.getUserUrl(t,r,"BAWORG",n.QueryIntent.OrgChart),_w.history.pushState(_w.history.state,_d.title,f));_d.title=t;e=!i.ctx.cfg.render.isInline;i.gleamController.commandSearch(r,n.GleamOption.People,e)};t.onPeopleCompletedExecuted=function(n){return i.loadPeopleData(n)};t.onPersonOrgChartCompletedExecuted=function(t,r,u,f){i.ctx.cfg.render.isInline&&(r==null||r.length===0)&&i.dataStore.dispatch(i.actionCreators.setInplaceSearchIntent(n.QueryIntent.None));i.orgChartController.loadOrgChartPhotosAndPresence(t,r,u,f)};t.onShowPersonDisambigExecuted=function(){return i.rankController.setExplicitPoleRank(n.Treatment.PeopleDisambig)};t.onShowHeroPersonExecuted=function(){i.dataStore.dispatch(i.actionCreators.setPersonPivot(n.PersonCardPivot.PersonAbout));var t=n.Reducers.People.getHeroPersonState(i.dataStore.getState()),r=t.data;i.loadPersonTabResults(r,t);i.ctx.cfg.render.isInline&&n.scrollTo();i.rankController.setExplicitPoleRank(n.Treatment.People)};t.onPersonGroupCompletedExecuted=function(t,r){if(r!=null){var u=i.dataStore.getState(),f=n.Reducers.Photo.getGroupPhoto(u);r.forEach(function(t){f[t.Id]==null&&i.photoController.getPhoto(t.Id,n.IrasDownloadKind.GroupPhoto)})}};t.onExpandInlineAnswerPeopleExecuted=function(t,i){return n.scrollTo(t?i:null)};t.onExpandInlineAnswerPeopleOrgChartExecuted=function(t,i){t||n.scrollTo(i)};t.onExpandInlineAnswerDisambigExecuted=function(t){t||n.scrollTo()}},t.prototype.loadPersonTabResults=function(t,i){var e=i==null||i.files==null||i.files.error!=null,o=i==null||i.orgChart==null||i.orgChart.error!=null,s=i==null||i.groups==null||i.groups.error!=null,h=i==null||i.floorPlan==null||i.floorPlan.error!=null,c=i==null||i.calendar==null||i.calendar.error!=null,u=n.Components.getMainEmail(t),r=t.ObjectId,f=t.UPN,l=t.OfficeLocation,a=n.nullOrWs(t.DirectManager);this.ctx.cfg.ft.docbrwse.e&&e&&this.docController.getDocumentResults(u,!1,r);this.ctx.cfg.ft.org.e&&o&&this.orgChartController.getOrgChart(u,r,a);this.ctx.cfg.ft.pgrp.e&&s&&this.getPersonGroups(r,f);this.ctx.cfg.ft.fp.e&&h&&this.locController.floorPlanSearch(r,l);this.ctx.cfg.ft.cal.e&&c&&this.getCalendarInfo(r,f)},t.prototype.getPersonGroups=function(t,i){var r=this,u={onSuccess:function(i){bfbInst.logRtt("POG",["browse?domain=group"]);bfbTel.logRtt(n.EventScope.BfbController,"PersonGroups",["browse?domain=group"]);var u=n.Reducers.Group.getValidGroups(i.groups);r.dataStore.dispatch(r.actionCreators.personGroupCompleted(t,u))},onError:function(n){return r.dataStore.dispatch(r.actionCreators.personGroupError(t,n))}},f={scenario:n.BfbRequestScenario.PersonGroups,qry:i};this.dataStore.dispatch(this.actionCreators.personGroupRequest(t));this.ctx.srvc.search.search(f,u)},t.prototype.loadPeopleData=function(t){var e=this,i,r,u,f;t!=null&&t.length!==0&&(i=function(t,i){return e.photoController.getPhoto(n.Components.getMainEmail(t),n.IrasDownloadKind.ContactPhoto,i)},r=t[0],i(r,!0),u=1,this.ctx.cfg.uxVersion===n.UxDesignVersion.V1_1&&(f=t.slice(1,this.ctx.cfg.ft.ppl.maxDisambigPreview+1),f.forEach(function(n){return i(n,!0)}),u+=f.length),this.skypeController.getOnlinePresence(r.Email),this.loadPersonTabResults(r),t.slice(u).forEach(function(n){i(n,!1);e.skypeController.getOnlinePresenceIfNecessary(n.Email)}))},t.prototype.getCalendarInfo=function(n,t){var i=this,r={onSuccess:function(t){i.dataStore.dispatch(i.actionCreators.calendarCompleted(n,t.personAvailability,t.userAvailability,t.events))},onError:function(t){return i.dataStore.dispatch(i.actionCreators.calendarError(n,t))}};this.dataStore.dispatch(this.actionCreators.calendarRequest(n));this.ctx.srvc.calendar.search(t,r)},t}();t.PersonController=i})(t=n.Controller||(n.Controller={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i=function(){function t(t){this.ctx=n.chk(t)}return t.prototype.init=function(n,t){this.dataStore=n;this.actionCreators=t},t.prototype.buildActionListeners=function(t){var i=this;t.onBuildingCompletedExecuted=function(t){return i.loadBuildingData(t,n.Reducers.Building.getBuildingState(i.dataStore.getState()))}},t.prototype.floorPlanSearch=function(t,i){var r=this,u;if(n.nullOrWs(i)){this.dataStore.dispatch(this.actionCreators.personFloorPlanCompleted(t,null));return}u={onSuccess:function(i){r.dataStore.dispatch(r.actionCreators.personFloorPlanCompleted(t,i));i!=null&&r.dataStore.dispatch(r.actionCreators.loadDependency(n.ResourceDependency.FloorPlan))},onDataInspect:function(i){r.dataStore.dispatch(r.actionCreators.personFloorPlanRoomCompleted(t,i));i&&r.dataStore.dispatch(r.actionCreators.loadDependency(n.ResourceDependency.FloorPlan))},onError:function(n){r.dataStore.dispatch(r.actionCreators.personFloorPlanError(t,n))}};this.dataStore.dispatch(this.actionCreators.personFloorPlanRequest(t));this.ctx.srvc.floorPlan.search(i,u)},t.prototype.loadBuildingData=function(t){if(t!=null&&!n.nullOrWs(t.Floor)&&this.ctx.cfg.ft.fp.e){var i=t.Name+"/FLOOR_"+t.Floor,r=i,u=null;n.nullOrWs(t.Room)||(r=t.Name+"/"+t.Room,u=t.Room);this.buildingFloorPlanSearch(t.Name,i,r,u)}},t.prototype.buildingFloorPlanSearch=function(t,i,r,u){var f=this,e;n.nullOrWs(i)||(e={onSuccess:function(i){i!=null&&(n.nullOrWs(r)||(i.officeLocation=r),n.nullOrWs(u)||(i.officeNumber=u));f.dataStore.dispatch(f.actionCreators.buildingFloorPlanCompleted(t,i));i!=null&&f.dataStore.dispatch(f.actionCreators.loadDependency(n.ResourceDependency.FloorPlan))},onDataInspect:function(i){i==null||n.nullOrWs(u)||(i.officeNumber=u);f.dataStore.dispatch(f.actionCreators.buildingFloorPlanRoomCompleted(t,i));i&&f.dataStore.dispatch(f.actionCreators.loadDependency(n.ResourceDependency.FloorPlan))},onError:function(n){f.dataStore.dispatch(f.actionCreators.buildingFloorPlanError(t,n))}},this.dataStore.dispatch(this.actionCreators.buildingFloorPlanRequest(t)),this.ctx.srvc.floorPlan.search(i,e))},t}();t.LocationController=i})(t=n.Controller||(n.Controller={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(n){var t=function(){function n(){}return n.prototype.init=function(n,t){this.dataStore=n;this.actionCreators=t},n.prototype.buildActionListeners=function(){},n}();n.QnaController=t})(t=n.Controller||(n.Controller={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i=function(){function t(t,i,r,u,f){var e=this;this.getCommand=function(){return e.dataStore.getState().command};this.ctx=n.chk(t);this.sharedController=n.chk(i,1);this.docController=n.chk(r,2);this.groupController=n.chk(u,3);this.rankController=n.chk(f,4)}return t.prototype.init=function(n,t){this.dataStore=n;this.actionCreators=t},t.prototype.setCommandBindFunction=function(n){this.bindCommandEvents=n},t.prototype.buildActionListeners=function(t){var i=this;t.onOpenGleamExecuting=function(){i.ctx.cfg.render&&i.ctx.cfg.render.isInline&&sj_evt.fire("BingAtWork:OpenHamburgerGleam")};t.onSetGleamOptionExecuted=function(n){return i.onGleamOptionSelected(n)};t.onSetRankingExecuted=n.createMulticastDelegate(function(t){i.adjustGleamPositionForTween(t);i.rankController.attachOnlyUsedContainers();t.placement===n.AnswerPlacement.Pole&&n.scrollTo("b_header")},t.onSetRankingExecuted)},t.prototype.commandSearch=function(i,r,u){var f=this,e,o;u===void 0&&(u=!0);u&&this.sharedController.setProgress(n.ProcessingStatus.Started);this.bindCommandEvents!=null&&this.bindCommandEvents();this.dispatchRequest(r);e={onSuccess:function(i){var o=!1,u=i.rawCommand,e;u!=null&&(e=n.getFirstScopeAnalysis(u.ScopeAnalysis),o=e==null?!1:n.ScopeDomain[e.Domain]===t.getExpectedDomain(r));o?sj_evt.fire(n.rawDataEvent,u,!0):f.setNoResults(r)},onError:function(t){f.setErrorState(r,t);sj_evt.fire(n.rawDataErr,t)}};o={scenario:n.BfbRequestScenario.Command,qry:i};this.ctx.srvc.search.search(o,e)},t.prototype.renderGleam=function(){var t=this,i=this.ctx.cfg.render&&this.ctx.cfg.render.isInline;this.container==null&&(this.container=new n.BfbContainer({elementId:"bw-glm",tagName:"div",parentElementId:"b_header",insertBehavior:n.ElementInsertBehavior.Append,renderContent:function(r){i?n.NativeRender.renderInlineGleam(t.dataStore,r,t.ctx.cfg.uxVersion):n.NativeRender.renderGleam(t.dataStore,r,t.ctx.cfg.uxVersion)}}),n.Upsell!=null&&n.Upsell.glmController!=null&&n.Upsell.glmController.hide(),this.container.attach());this.glmTop==null&&(this.glmTop=sj_go(this.container.element,"Top"))},t.prototype.adjustGleamPositionForTween=function(t){var r=t!=null&&t.placement===n.AnswerPlacement.Pole,u=_ge("b_tween")!=null,i;this.container!=null&&this.container.element!=null&&this.glmTop!=null&&(i=!u&&!r?-1:0,this.container.element.style.top=(this.ctx.cfg.uxVersion===n.UxDesignVersion.V1_1?0:this.glmTop)+i+"px")},t.prototype.getGleamOption=function(){var t=this.dataStore.getState().command,i=t==null?null:t.domain;switch(i){case n.ScopeDomain.Person:return n.GleamOption.People;case n.ScopeDomain.File:return n.GleamOption.Documents;case n.ScopeDomain.Task:return n.GleamOption.Bookmarks;case n.ScopeDomain.Group:if(this.ctx.cfg.ft.grpsrch.e)return n.GleamOption.Group;break;case n.ScopeDomain.Buildings:if(this.ctx.cfg.ft.bld.e)return n.GleamOption.Buildings;break;case n.ScopeDomain.PowerBi:if(this.ctx.cfg.ft.powerbi.e)return n.GleamOption.PowerBi}return null},t.prototype.setGleamOption=function(t){var i=null;switch(t){case"bawpeople":i=n.GleamOption.People;break;case"bawdoc":i=n.GleamOption.Documents;break;case"bawbookmarks":i=n.GleamOption.Bookmarks;break;case"bawgroups":i=n.GleamOption.Group;break;case"bawbuilds":i=n.GleamOption.Buildings;break;case"bawpowerbi":i=n.GleamOption.PowerBi}bfbInst.cLog("HGC","V",i==null?"":n.GleamOption[i],"HV",t);bfbTel.logClicked(n.EventScope.Gleam,i,t);i!=null&&this.dataStore.dispatch(this.actionCreators.setGleamOption(i))},t.prototype.setLastCommandQuery=function(n){this.lastCommandQry=n},t.prototype.onGleamOptionSelected=function(t){var r,i,u;this.sharedController.setProgress(n.ProcessingStatus.Started);r=this.getCommand();i=this.lastCommandQry!=null?this.lastCommandQry:this.sharedController.getQuery();switch(t){case n.GleamOption.People:this.commandSearch(i,n.GleamOption.People);break;case n.GleamOption.Documents:this.docController.documentSearch(i);break;case n.GleamOption.Bookmarks:this.commandSearch(i,n.GleamOption.Bookmarks);break;case n.GleamOption.Group:r!=null&&r.analysis!=null&&r.domain===n.ScopeDomain.Group&&(u=r.analysis,i=u.KeyWords==null||u.KeyWords.length===0?i:u.KeyWords[0].Keyword);this.groupController.groupSearchByName(i);break;case n.GleamOption.Buildings:this.commandSearch(i,n.GleamOption.Buildings);break;case n.GleamOption.PowerBi:this.commandSearch(i,n.GleamOption.PowerBi)}this.rankController.setExplicitPoleRank(this.getDefaultTreatmentForGleamOption(t))},t.getExpectedDomain=function(t){switch(t){case n.GleamOption.People:return n.ScopeDomain.Person;case n.GleamOption.Bookmarks:return n.ScopeDomain.Task;case n.GleamOption.Buildings:return n.ScopeDomain.Buildings;case n.GleamOption.Documents:return n.ScopeDomain.File;case n.GleamOption.Group:return n.ScopeDomain.Group;case n.GleamOption.PowerBi:return n.ScopeDomain.PowerBi}return null},t.prototype.dispatchRequest=function(t){switch(t){case n.GleamOption.People:this.dataStore.dispatch(this.actionCreators.peopleRequest());break;case n.GleamOption.Documents:this.dataStore.dispatch(this.actionCreators.documentsRequest());break;case n.GleamOption.Bookmarks:this.dataStore.dispatch(this.actionCreators.bookmarksRequest());break;case n.GleamOption.Group:this.dataStore.dispatch(this.actionCreators.groupRequest());break;case n.GleamOption.Buildings:this.dataStore.dispatch(this.actionCreators.buildingRequest());break;case n.GleamOption.PowerBi:this.dataStore.dispatch(this.actionCreators.powerBiRequest())}},t.prototype.setErrorState=function(t,i){switch(t){case n.GleamOption.People:this.dataStore.dispatch(this.actionCreators.peopleError(i));break;case n.GleamOption.Documents:this.dataStore.dispatch(this.actionCreators.documentsError(i));break;case n.GleamOption.Bookmarks:this.dataStore.dispatch(this.actionCreators.bookmarksError(i));break;case n.GleamOption.Group:this.dataStore.dispatch(this.actionCreators.groupError(i));break;case n.GleamOption.Buildings:this.dataStore.dispatch(this.actionCreators.buildingError(i));break;case n.GleamOption.PowerBi:this.dataStore.dispatch(this.actionCreators.powerBiError(i))}},t.prototype.setNoResults=function(t){this.sharedController.setProgress(n.ProcessingStatus.NoResults);switch(t){case n.GleamOption.People:this.dataStore.dispatch(this.actionCreators.peopleCompleted(null,null));break;case n.GleamOption.Documents:this.dataStore.dispatch(this.actionCreators.documentsCompleted(null));break;case n.GleamOption.Bookmarks:this.dataStore.dispatch(this.actionCreators.bookmarksCompleted(null));break;case n.GleamOption.Group:this.dataStore.dispatch(this.actionCreators.groupCompleted(null));break;case n.GleamOption.Buildings:this.dataStore.dispatch(this.actionCreators.buildingCompleted(null));break;case n.GleamOption.PowerBi:this.dataStore.dispatch(this.actionCreators.powerBiCompleted(null))}},t.prototype.closeGleam=function(){this.dataStore.dispatch(this.actionCreators.closeGleam())},t.prototype.openGleam=function(){this.dataStore.dispatch(this.actionCreators.openGleam())},t.mapIntent=function(t){switch(t){case n.QueryIntent.Building:return n.GleamOption.Buildings;case n.QueryIntent.Group:case n.QueryIntent.GroupConversations:case n.QueryIntent.GroupFiles:return n.GleamOption.Group;case n.QueryIntent.Office:case n.QueryIntent.Department:case n.QueryIntent.Email:case n.QueryIntent.Title:case n.QueryIntent.Alias:case n.QueryIntent.PersonDocs:return n.GleamOption.People}return null},t.prototype.getDefaultTreatmentForGleamOption=function(t){switch(t){case n.GleamOption.Bookmarks:return n.Treatment.Bookmarks;case n.GleamOption.Buildings:return n.Treatment.Buildings;case n.GleamOption.Documents:return n.Treatment.Documents;case n.GleamOption.Group:return n.Treatment.Group;case n.GleamOption.PowerBi:return n.Treatment.PowerBi;case n.GleamOption.People:default:return n.Treatment.People}},t}();t.GleamController=i})(t=n.Controller||(n.Controller={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i=function(){function t(t,i,r){this.ctx=n.chk(t);this.sharedController=n.chk(i,1);this.rankController=n.chk(r,2)}return t.prototype.init=function(n,t){this.dataStore=n;this.actionCreators=t},t.prototype.buildActionListeners=function(){},t.prototype.document=function(n,t){this.dataStore.dispatch(this.actionCreators.documentsCompleted(n));this.getDocAllResults(n==null?null:n.keyword,n==null?null:n.personName);t&&this.rankController.rankAndRoute(n)},t.prototype.getDocumentResults=function(t,i,r,u){var f=this,o={onSuccess:function(t){i?u===n.DocumentSearchPivot.All&&(bfbInst.logRtt("PDPR",["personalsearch"]),bfbTel.logRtt(n.EventScope.BfbController,"PDPR",["personalsearch"])):(bfbInst.logRtt("PPD",["browse?domain=file"]),bfbTel.logRtt(n.EventScope.BfbController,"PPD",["browse?domain=file"]));t!=null&&t.userInfo!=null&&f.dataStore.dispatch(f.actionCreators.createOrUpdateUserInfo(t.userInfo));i?(f.sharedController.setProgress(null),f.dataStore.dispatch(f.actionCreators.allDocumentsCompleted(t==null?null:t.files))):f.dataStore.dispatch(f.actionCreators.personDocumentsCompleted(r,t==null?null:t.files))},onError:function(n){i?f.dataStore.dispatch(f.actionCreators.allDocumentsError(n)):f.dataStore.dispatch(f.actionCreators.personDocumentsError(r,n))}},e;i?this.dataStore.dispatch(this.actionCreators.allDocumentsRequest()):this.dataStore.dispatch(this.actionCreators.personDocumentsRequest(r));e=i?n.Service.PawDataService.getDocSrc(u):null;this.docSearch(t,i?n.BfbRequestScenario.Documents:n.BfbRequestScenario.PersonDocuments,o,e)},t.prototype.documentSearch=function(t){var i=this,r;this.sharedController.setProgress(n.ProcessingStatus.Started);r={onSuccess:function(n){i.document(n,!0);n&&n.userInfo!=null&&i.dataStore.dispatch(i.actionCreators.createOrUpdateUserInfo(n.userInfo))},onError:function(t){i.sharedController.handleRqstFail(t);i.dataStore.dispatch(i.actionCreators.documentsError(t))}};this.dataStore.dispatch(this.actionCreators.documentsRequest());this.docSearch(t,n.BfbRequestScenario.Documents,r,n.Service.PawDataService.getDocSrc(0))},t.prototype.docSearch=function(t,i,r,u){var e={scenario:i,qry:t,sources:u,orderBy:i===n.BfbRequestScenario.Documents?n.Service.PawDataService.OrdrRel:null,files:null},o=this.sharedController.getCommand(),f;o!=null&&(f=o.analysis,f!=null&&(e.files=f.Files));this.ctx.srvc.search.search(e,r)},t.prototype.getDocAllResults=function(t,i){var r=n.nullOrWs(t)?n.nullOrWs(i)?this.sharedController.getQuery():i:t;this.getDocumentResults(r,!0,null,n.DocumentSearchPivot.All)},t}();t.DocumentController=i})(t=n.Controller||(n.Controller={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i=function(){function t(t){this.cancelVeilTimer=null;this.ctx=n.chk(t)}return t.prototype.init=function(n,t){this.dataStore=n;this.actionCreators=t},t.prototype.buildActionListeners=function(){},t.prototype.getIsVeilCancelled=function(){return this.isVeilCanceled},t.prototype.initNonWorkResultsVeil=function(){var t=this,i,e;if(this.isVeilCanceled=!1,i=this.ctx.cfg.ft.nwrv,i&&i.e){var r=sb_gt(),o=isNaN(n.PreContentStamp)?r:n.PreContentStamp,s=r-o,u=3e3-s,f="onBawVeilCancelCompleted";u>0?(e=1e3,this.cancelVeilTimer=sb_st(function(){t.isVeilCanceled=!0;t.dataStore!=null&&t.dataStore.dispatch(t.actionCreators.cancelNonWorkResultsVeil());sb_st(function(){sj_evt.fire(f)},e)},u)):(this.isVeilCanceled=!0,this.dataStore!=null&&this.dataStore.dispatch(this.actionCreators.cancelNonWorkResultsVeil()),sj_evt.fire(f))}},t.prototype.clearCancelVeilTimer=function(n){this.ctx.cfg.ft.nwrv.e&&n!=null&&!this.isVeilCanceled&&this.cancelVeilTimer&&(sb_ct(this.cancelVeilTimer),this.cancelVeilTimer=null)},t}();t.VeilController=i})(t=n.Controller||(n.Controller={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i=function(){function t(t){var i=this;this.getCommand=function(){return i.dataStore.getState().command};this.ctx=n.chk(t)}return t.prototype.init=function(n,t){this.dataStore=n;this.actionCreators=t},t.prototype.buildActionListeners=function(){},t.prototype.setProgress=function(n){this.dataStore.dispatch(this.actionCreators.setAppRouterStatus(n))},t.prototype.getQuery=function(){return this.dataStore.getState().qrynf.qry},t.prototype.handleRqstFail=function(t){if(this.isValidStatus()){var i=n.mapStatus(t);this.setProgress(i)}},t.prototype.isValidStatus=function(){var i=n.Reducers.AppRouter.getStatus(this.dataStore.getState());return t.validProcessingStatuses.some(function(n){return i===n})},t.validProcessingStatuses=[n.ProcessingStatus.Started,n.ProcessingStatus.Complete,n.ProcessingStatus.NoResults],t}();t.SharedController=i})(t=n.Controller||(n.Controller={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i=function(){function t(t,i,r){this.ctx=n.chk(t);this.sharedController=n.chk(i,1);this.veilController=n.chk(r,2)}return t.prototype.init=function(n,t){this.dataStore=n;this.actionCreators=t;this.initializeContainers()},t.prototype.initializeContainers=function(){var t=this;this.containers=[];var r=this.ctx.cfg.render&&this.ctx.cfg.render.isInline,u=this.ctx.cfg.uxVersion===n.UxDesignVersion.V1_1?"bw-ctnr":null,i=n.Components.combineCss("b_ans",u);this.containers.push(new n.BfbContainer({placement:n.AnswerPlacement.Pole,elementId:"baw_nh",tagName:"div",className:u,parentElementId:"b_navheader",insertBehavior:n.ElementInsertBehavior.InsertAsFirst,renderContent:function(i){r?n.NativeRender.renderInlineAppRouter(t.dataStore,i,t.ctx.cfg.uxVersion):n.NativeRender.renderMainlineAppRouter(t.dataStore,i,t.ctx.cfg.uxVersion)}}));r||(this.containers.push(new n.BfbContainer({placement:n.AnswerPlacement.ContextRegionTop,elementId:"baw_cr",tagName:"li",className:i,parentElementId:"b_context",insertBehavior:n.ElementInsertBehavior.InsertAsFirst,renderContent:function(i){return n.NativeRender.renderContextRegionAppRouter(t.dataStore,i,n.AnswerPlacement.ContextRegionTop,t.ctx.cfg.uxVersion)}})),this.containers.push(new n.BfbContainer({placement:n.AnswerPlacement.ContextRegionBottom,elementId:"baw_crb",tagName:"li",className:i,parentElementId:"b_context",insertBehavior:n.ElementInsertBehavior.InsertBeforeGrandchild,insertBeforeGrandchildClass:"b_rrsr",renderContent:function(i){return n.NativeRender.renderContextRegionAppRouter(t.dataStore,i,n.AnswerPlacement.ContextRegionBottom,t.ctx.cfg.uxVersion)}})),this.containers.push(new n.BfbContainer({placement:n.AnswerPlacement.Algo,elementId:"bw-alg",tagName:"li",className:i,parentElementId:"b_results",insertBehavior:n.ElementInsertBehavior.InsertAsFirst,renderContent:function(i){return n.NativeRender.renderAlgoAppRouter(t.dataStore,i,t.ctx.cfg.uxVersion)}})))},t.prototype.buildActionListeners=function(n){var t=this;n.onSetCommand=function(){};n.onSetAnswerData=function(n){return t.onSetAnswerData(n)}},t.prototype.promoteRankToExplicitPole=function(){var n=this.getRanking();n!=null&&this.setExplicitPoleRank(n.treatment)},t.prototype.setExplicitPoleRank=function(t){var i={treatment:t,placement:n.AnswerPlacement.Pole,rankingRuleId:n.RankingRuleId.UserExplicit};this.updateRanking(i)},t.prototype.updateRanking=function(n){this.dataStore.dispatch(this.actionCreators.setRanking(n))},t.prototype.rankAndRouteBeforeDataResponse=function(){this.rankAndRoute(null)},t.prototype.rankAndRoute=function(n){var t=this.createRankingContext(n);this.dataStore.dispatch(this.actionCreators.routeSearchResponse(t));this.veilController.clearCancelVeilTimer(n);this.attachOnlyUsedContainers()},t.prototype.attachOnlyUsedContainers=function(){var t=this,i;i=this.getRanking();this.containers.forEach(function(n){i!=null&&i.placement===n.definition.placement?n.attach(t.setContainersAttached.bind(t)):(n.detach(),t.setContainersAttached())})},t.prototype.setContainersAttached=function(){this.dataStore.dispatch(this.actionCreators.setContainersAttached(this.getAttachedContainers()))},t.prototype.getAttachedContainers=function(){return this.containers.filter(function(t){return t.element!=null&&t.element.parentNode!=null&&t.attachmentState===n.ElementAttachmentState.Attached})},t.prototype.getRanking=function(){return n.Reducers.AppRouter.getRanking(this.dataStore.getState())},t.prototype.createRankingContext=function(n){return{command:this.sharedController.getCommand(),bfbContext:this.ctx,response:n}},t.prototype.onSetAnswerData=function(t){if(t!=null){var i=n.Reducers.QueryInfo.getQueryInfo(this.dataStore.getState());n.nullOrWs(i.encryptedQuery)||i.encryptedQuery!=this.lastLoggedQuery&&(this.lastLoggedQuery=i.encryptedQuery,bfbTel.logQuery(i))}},t}();t.RankingController=i})(t=n.Controller||(n.Controller={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i=function(){function t(t,i){this.ctx=n.chk(t);this.rankController=n.chk(i,1);this.photoQueue=[]}return t.prototype.init=function(n,t){this.dataStore=n;this.actionCreators=t},t.prototype.buildActionListeners=function(t){var i=this;t.onSetRankingExecuted=n.createMulticastDelegate(function(){for(var n=0;n<i.photoQueue.length;n++)i.photoQueue[n]();i.photoQueue=[]},t.onSetRankingExecuted)},t.prototype.getPhoto=function(t,i,r){var u=this,o=function(r){var f=r!=null?r.base64Image:null;i===n.IrasDownloadKind.ContactPhoto?u.dataStore.dispatch(u.actionCreators.personPhotoDownloaded(t,f)):i===n.IrasDownloadKind.GroupPhoto&&u.dataStore.dispatch(u.actionCreators.groupPhotoDownloaded(t,f))},f=function(){return u.ctx.srvc.download.img(t,i,o)},e=this.rankController.getRanking(),s=e!=null&&e.placement==n.AnswerPlacement.Pole,h=!r&&!s;h?this.photoQueue.push(f):f()},t.validProcessingStatuses=[n.ProcessingStatus.Started,n.ProcessingStatus.Complete,n.ProcessingStatus.NoResults],t}();t.PhotoController=i})(t=n.Controller||(n.Controller={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i=function(){function t(t,i,r){this.ctx=n.chk(t);this.skypeController=n.chk(i,1);this.photoController=n.chk(r,2)}return t.prototype.init=function(n,t){this.dataStore=n;this.actionCreators=t},t.prototype.buildActionListeners=function(){},t.prototype.loadOrgChartPhotosAndPresence=function(t,i,r,u){var h={},y=this.dataStore.getState(),c=y.photo,v,e,l,s,a,o,f;for(c!=null&&c.personPhotos!=null&&(h=c.personPhotos),v=i.concat(r),e=0,l=v;e<l.length;e++)o=l[e],f=o.Email,f!=null&&(h[f]==null&&this.photoController.getPhoto(f,n.IrasDownloadKind.ContactPhoto),this.skypeController.getOnlinePresenceIfNecessary(f));for(s=0,a=u;s<a.length;s++)o=a[s],f=o.Email,f!=null&&h[f]==null&&this.photoController.getPhoto(f,n.IrasDownloadKind.ContactPhoto)},t.prototype.getOrgChart=function(t,i,r){var u=this;if(this.ctx.cfg.ft.org.e){var f=function(t){u.dataStore.dispatch(u.actionCreators.personOrgChartError(i,t))},e={onSuccess:function(t){bfbInst.logRtt("POC",["details"]);bfbTel.logRtt(n.EventScope.BfbController,"POC",["details"]);u.dataStore.dispatch(u.actionCreators.personOrgChartCompleted(i,t.directs,t.managers,t.peers,u.ctx.cfg.ft.org.orgCount))},onError:f},o={scenario:n.BfbRequestScenario.OrgChart,qry:i,noManager:r};this.dataStore.dispatch(this.actionCreators.personOrgChartRequest(i));this.ctx.srvc.search.search(o,e)}},t}();t.OrgChartController=i})(t=n.Controller||(n.Controller={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i=function(){function t(t){this.buffer=[];this.initializeSkypeClient(t);this.cfg=n.chk(t,1)}return t.prototype.init=function(n,t){this.dataStore=n;this.actionCreators=t},t.prototype.buildActionListeners=function(){},t.prototype.getOnlinePresence=function(n){n!=null&&(this.skypeClient!=null?this.registerEmail(n):this.buffer.indexOf(n)<0&&this.buffer.push(n))},t.prototype.getOnlinePresenceIfNecessary=function(t){if(this.cfg.ft.skyint.enableNonHeroPresence){var i=n.Reducers.OnlinePresence.getPresence(this.dataStore.getState(),t);i||this.getOnlinePresence(t)}},t.prototype.initializeSkypeClient=function(t){var i=this,r=t.ft.skyint;r&&r.e&&(r.deferLoading?sj_evt.bind("OnScriptLoad:BingAtWork.SkypePresence",function(){var t,u,f;for(i.skypeClient=new n.SkypePresence.SkypeClient(r),t=0,u=i.buffer;t<u.length;t++)f=u[t],i.registerEmail(f);i.buffer=[]},!0):this.skypeClient=new n.SkypePresence.SkypeClient(r))},t.prototype.registerEmail=function(n){var t=this;this.skypeClient.register(n,function(i){t.dataStore.dispatch(t.actionCreators.setOnlinePresence(n,i))})},t}();t.SkypeController=i})(t=n.Controller||(n.Controller={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i=function(){function t(t,i,r,u,f){this.ctx=n.chk(t);this.sharedController=n.chk(i,1);this.skypeController=n.chk(r,2);this.rankController=n.chk(u,3);this.photoController=n.chk(f,4)}return t.prototype.init=function(n,t){this.dataStore=n;this.actionCreators=t},t.prototype.buildActionListeners=function(t){var i=this;t.onShowHeroGroupExecuted=function(){i.dataStore.dispatch(i.actionCreators.setGroupPivot(n.GroupSearchPivot.GroupAbout));var t=n.Reducers.Group.getHeroGroupState(i.dataStore.getState()),u=t.data,f=t.groupMembers,e=t.groupFiles,o=t.groupConversations,s=t.groupDetails,r=u.Id;f==null&&i.getGroupMembers(r);e==null&&i.getGroupFiles(r);o==null&&i.getGroupConversations(r);s==null&&i.getGroupDetails(r);i.rankController.setExplicitPoleRank(n.Treatment.Group)};t.onGroupCompletedExecuted=function(t){t!=null&&(i.getGroupDetails(t),i.photoController.getPhoto(t,n.IrasDownloadKind.GroupPhoto),i.getGroupMembers(t),i.getGroupFiles(t),i.getGroupConversations(t))};t.onShowGroupDisambigExecuted=function(){i.dataStore.dispatch(i.actionCreators.setHeroGroupId(null));var t=i.dataStore.getState(),r=n.Reducers.Group.getAllGroups(t),u=n.Reducers.Photo.getGroupPhoto(t);r.filter(function(n){return u[n.Id]==null}).forEach(function(t){return i.photoController.getPhoto(t.Id,n.IrasDownloadKind.GroupPhoto)});i.rankController.setExplicitPoleRank(n.Treatment.GroupDisambig)}},t.prototype.groupSearchByName=function(t){var i=this,r,u;this.sharedController.setProgress(n.ProcessingStatus.Started);r={onSuccess:function(t){var u=t!=null?n.Reducers.Group.getValidGroups(t.groups,!0):null,r;i.dataStore.dispatch(i.actionCreators.groupCompleted(u));r=t!=null?t.groups:[];r.length>1?i.dataStore.dispatch(i.actionCreators.showGroupDisambig()):i.rankController.setExplicitPoleRank(n.Treatment.Group);i.rankController.rankAndRoute(t)},onError:function(t){i.sharedController.handleRqstFail(t);i.dataStore.dispatch(i.actionCreators.groupError(t))}};this.dataStore.dispatch(this.actionCreators.groupRequest());u={scenario:n.BfbRequestScenario.Groups,qry:t};this.ctx.srvc.search.search(u,r)},t.prototype.groupSearchById=function(t){var i=this,r,u;this.sharedController.setProgress(n.ProcessingStatus.Started);this.rankController.setExplicitPoleRank(n.Treatment.Group);r=function(t){var r=t!=null&&t.group!=null?[t.group]:null,u;i.dataStore.dispatch(i.actionCreators.groupCompleted(r));u={groups:r,scenario:n.BfbResponseScenario.Groups};i.rankController.rankAndRoute(u)};u=function(t){i.sharedController.setProgress(n.mapStatus(t,n.GleamOption.Group))};this.getGroupDetails(t,r,u)},t.prototype.getGroupDetails=function(i,r,u){var f=this,e={scenario:n.BfbRequestScenario.GroupDetails,qry:this.sharedController.getQuery(),groupId:i},o={onSuccess:function(u){bfbInst.logRtt(t.groupDetailsInstEvtId,["details?domain=group"]);bfbTel.logRtt(n.EventScope.BfbController,"GRP",["details?domain=group"]);var e=u!=null&&u.group!=null?u.group:null;f.dataStore.dispatch(f.actionCreators.groupDetailsCompleted(i,e));r&&r(u)},onError:function(n){f.dataStore.dispatch(f.actionCreators.groupDetailsError(i,n));u!=null&&u(n)}};this.dataStore.dispatch(this.actionCreators.groupDetailsRequest(i));this.ctx.srvc.search.search(e,o)},t.prototype.getGroupMembers=function(i){var r=this,u={scenario:n.BfbRequestScenario.GroupMembers,qry:this.sharedController.getQuery(),groupId:i},f={onSuccess:function(u){bfbInst.logRtt(t.groupMembersInstEvtId,["browse?domain=person","groupid="]);bfbTel.logRtt(n.EventScope.BfbController,"GMBR",["browse?domain=person","groupid="]);r.dataStore.dispatch(r.actionCreators.groupMembersCompleted(i,u.groupMembers));var f=u.groupMembers!=null?u.groupMembers:[];f.slice(0,r.ctx.cfg.ft.grpsrch.maxMem).forEach(function(t){r.photoController.getPhoto(t.Email,n.IrasDownloadKind.ContactPhoto)});f.slice(0,r.ctx.cfg.ft.grpsrch.maxMem).forEach(function(n){return r.skypeController.getOnlinePresenceIfNecessary(n.Email)})},onError:function(n){return r.dataStore.dispatch(r.actionCreators.groupMembersError(i,n))}};this.dataStore.dispatch(this.actionCreators.groupMembersRequest(i));this.ctx.srvc.search.search(u,f)},t.prototype.getGroupConversations=function(i){var r=this,u={scenario:n.BfbRequestScenario.GroupConversations,qry:this.sharedController.getQuery(),groupId:i},f={onSuccess:function(u){bfbInst.logRtt(t.groupConversationsInstEvtId,["browse?domain=email","groupid="]);bfbTel.logRtt(n.EventScope.BfbController,"GCONV",["browse?domain=email","groupid="]);r.dataStore.dispatch(r.actionCreators.groupConversationsCompleted(i,u.groupConversations))},onError:function(n){return r.dataStore.dispatch(r.actionCreators.groupConversationsError(i,n))}};this.dataStore.dispatch(this.actionCreators.groupConversationsRequest(i));this.ctx.srvc.search.search(u,f)},t.prototype.getGroupFiles=function(i){var r=this,u={scenario:n.BfbRequestScenario.GroupFiles,qry:this.sharedController.getQuery(),groupId:i},f={onSuccess:function(u){bfbInst.logRtt(t.groupFilesInstEvtId,["browse?domain=file","groupid="]);bfbTel.logRtt(n.EventScope.BfbController,"GFL",["browse?domain=file","groupid="]);r.dataStore.dispatch(r.actionCreators.groupFilesCompleted(i,u.groupFiles))},onError:function(n){return r.dataStore.dispatch(r.actionCreators.groupFilesError(i,n))}};this.dataStore.dispatch(this.actionCreators.groupFilesRequest(i));this.ctx.srvc.search.search(u,f)},t.groupDetailsInstEvtId="GRPDET",t.groupMembersInstEvtId="GRPM",t.groupConversationsInstEvtId="GRPCONV",t.groupFilesInstEvtId="GRPFILE",t}();t.GroupController=i})(t=n.Controller||(n.Controller={}))}(BingAtWork||(BingAtWork={})),function(n){var t=function(){function t(n,t){this.controllers=t;this.ctx=n}return t.prototype.createReduxStore=function(i,r){var e=t.buildInitialState(this.ctx,r),u,f;this.buildActionListeners(i);u=new n.Store.BingAtWorkStore(i,e);for(f in this.controllers)this.controllers.hasOwnProperty(f)&&this.controllers[f].init(u,n.Actions.actionCreators);return u},t.buildInitialState=function(n,t){return{cfg:n.cfg,qrynf:n.qrynf(),ans:{mainline:{width:n.answerInfo.width,render:n.answerInfo.render,isNotificationVisible:!0},inline:{isPeopleExpanded:!1,isPeopleOrgChartExpanded:!1,isDisambigExpanded:!1}},veil:{shouldRender:n.cfg.ft.nwrv.e&&!t,isVisible:!0}}},t.prototype.buildActionListeners=function(n){for(var t in this.controllers)this.controllers.hasOwnProperty(t)&&this.controllers[t].buildActionListeners(n)},t}();n.StoreBuilder=t}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i=function(){function i(i,r){this.config=n.chk(r,1);this.dataService=n.chk(i);this.responseBuilder=new t.PawResponseBuilder(r)}return i.prototype.search=function(t,i){if(t=n.chk(t),!n.nullOrWs(t.qry))switch(t.scenario){case n.BfbRequestScenario.PersonDocuments:this.docSearch(t,n.BfbResponseScenario.PersonDocument,i);break;case n.BfbRequestScenario.Documents:this.docSearch(t,n.BfbResponseScenario.Document,i);break;case n.BfbRequestScenario.OrgChart:this.orgChartSearch(t,i);break;case n.BfbRequestScenario.PersonGroups:this.groupSearch(!0,t,i);break;case n.BfbRequestScenario.Groups:this.groupSearch(!1,t,i);break;case n.BfbRequestScenario.GroupMembers:this.getGroupMembers(t,i);break;case n.BfbRequestScenario.GroupConversations:this.getGroupConversations(t,i);break;case n.BfbRequestScenario.GroupFiles:this.getGroupFiles(t,i);break;case n.BfbRequestScenario.GroupDetails:this.getGroupDetails(t,i);break;case n.BfbRequestScenario.Command:this.commandSearch(t,i);break;default:throw new Error(t.scenario+" is not supported.");}},i.prototype.docSearch=function(t,i,r){var u=this,f=n.cpyErr(function(n,f){var e=u.responseBuilder.buildSearchResponse(i,n,t.qry,null,f);r.onSuccess(e)},r),e={endpoint:i===n.BfbResponseScenario.Document?n.IrasEndpoint.PersonalSearch:n.IrasEndpoint.Browse,qry:t.qry,domain:n.ScopeDomain.File,sources:t.sources,orderBy:t.orderBy,files:t.files};this.dataService.qry(e,f)},i.prototype.orgChartSearch=function(t,i){var r=this,u=function(u){var f=n.getResp(u,!0),e=r.responseBuilder.buildSearchResponse(n.BfbResponseScenario.OrgChart,f,t.qry);i.onSuccess(e)},f=n.cpyErr(u,i),e={endpoint:n.IrasEndpoint.Details,domain:n.ScopeDomain.Person,qry:this.config.ft.org.noPeer&&t.noManager?t.qry+" only":t.qry};this.dataService.qry(e,f)},i.prototype.groupSearch=function(t,i,r){var u=this,f=function(t){var f=u.responseBuilder.buildSearchResponse(n.BfbResponseScenario.Groups,t,i.qry);r.onSuccess(f)},e=n.cpyErr(f,r),o={endpoint:t?n.IrasEndpoint.Browse:n.IrasEndpoint.PersonalSearch,domain:n.ScopeDomain.Group,qry:i.qry};this.dataService.qry(o,e)},i.prototype.getGroupMembers=function(t,i){var r=this,u=function(u){var f=r.responseBuilder.buildSearchResponse(n.BfbResponseScenario.GroupMembers,u,t.qry);i.onSuccess(f)},f=n.cpyErr(u,i),e={endpoint:n.IrasEndpoint.Browse,domain:n.ScopeDomain.Person,qry:t.qry,groupId:t.groupId};this.dataService.qry(e,f)},i.prototype.getGroupConversations=function(t,i){var r=this,u=function(u){var f=r.responseBuilder.buildSearchResponse(n.BfbResponseScenario.GroupConversations,u,t.qry);i.onSuccess(f)},f=n.cpyErr(u,i),e={endpoint:n.IrasEndpoint.Browse,domain:n.ScopeDomain.Email,qry:t.qry,groupId:t.groupId};this.dataService.qry(e,f)},i.prototype.getGroupFiles=function(t,i){var r=this,u=function(u){var f=r.responseBuilder.buildSearchResponse(n.BfbResponseScenario.GroupFiles,u,t.qry);i.onSuccess(f)},f=n.cpyErr(u,i),e={endpoint:n.IrasEndpoint.Browse,domain:n.ScopeDomain.File,qry:t.qry,groupId:t.groupId};this.dataService.qry(e,f)},i.prototype.getGroupDetails=function(t,i){var r=this,u=function(u){var f=r.responseBuilder.buildSearchResponse(n.BfbResponseScenario.GroupDetails,u,t.qry);i.onSuccess(f)},f=n.cpyErr(u,i),e={endpoint:n.IrasEndpoint.Details,domain:n.ScopeDomain.Group,qry:t.groupId};this.dataService.qry(e,f)},i.prototype.commandSearch=function(t,i){var r={query:t.qry,doExecute:!1},u=n.cpyErr(function(t){var r={scenario:n.BfbResponseScenario.Command,rawCommand:t};i.onSuccess(r)},i);this.dataService.command(r,u)},i}();t.SearchService=i})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={})),function(n){function t(t,i,r){var f=!1,e=!1,u=!1,o=function(){f&&e&&!u&&(u=!0,i.init())};sj_evt.bind("OnScriptLoad:BfbDependencies",function(){f=!0;o()},!0,null,!0);sj_evt.bind("OnScriptLoad:BingAtWork:BfbContentBundle",function(){e=!0;o()},!0,null,!0);sj_evt.bind("OnP1",function(){u||sb_st(function(){!u},r)},!0,null,!0)}function i(i,r,u){if(sj_evt.fire(n.onTenantConfig,r.tenantMetadata),bfbInst.sLog("Authorized"),i=n.chk(i),i.qry=n.nullOrWs(n.normalizedQuery)?n.getNormalizedQuery():n.normalizedQuery,i.rawQuery=n.rawQuery,r=n.chk(r,1),bfbInst.sLog("Tenant",r.tenantMetadata.displayName),bfbTel.logValue(n.EventScope.BingAtWork,"TenantName",r.tenantMetadata.displayName),u=n.chk(u,2),_w.bfbConfig=r,!n.nullOrWs(i.qry)){var l={search:new n.Service.SearchService(n.dataService,r),download:new n.Service.DownloadService(n.dataService),floorPlan:new n.Service.FloorPlanService(r.ft.fp),calendar:r.ft.cal.e?new n.Service.CalendarService(r.ft.cal):null},f={cfg:r,qrynf:function(){return i},srvc:l,answerInfo:u},s=new n.Controller.SkypeController(r),o=new n.Controller.SharedController(f),a=new n.Controller.VeilController(f),e=new n.Controller.RankingController(f,o,a),h=new n.Controller.PhotoController(f,e),c=new n.Controller.DocumentController(f,o,e),v=new n.Controller.GroupController(f,o,s,e,h),y=new n.Controller.GleamController(f,o,c,v,e),p=new n.Controller.OrgChartController(f,s,h),k=new n.Controller.QnaController,w=new n.Controller.LocationController(f),d=new n.Controller.PersonController(f,s,c,p,w,y,e,h),b={skype:s,orgChart:p,gleam:y,doc:c,grp:v,veil:a,shared:o,rank:e,person:d,location:w,qna:k,photo:h},g=new n.StoreBuilder(f,b),nt=new n.Controller.BfbController(f,g,b);r.uxVersion===n.UxDesignVersion.V1_1;t(l,nt,r.renderTimeout);sj_evt.fire(n.onBawInitFinish);sj_evt.bind(n.onBingFdbkStart,function(){if(!r.ft.msftfdbk.e){var n=_ge("bw");n&&n.parentNode.removeChild(n)}},!0,null,!0)}}n.main=i}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function o(t,i){typeof Log!="undefined"&&(i==null?Log.Log(f,t,e,!1):Log.Log(f,t,e,!1,"V",i))}function r(t){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];typeof Log!="undefined"&&Log.Log.apply(null,[f,t,e,!1].concat(r))}function s(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];r.apply(null,[n,"EVT","CLICK"].concat(i))}function c(t,f,e){r(u,"S",t,"PPL",i(f),"BUSP",i(e.BusinessPhoneNumbers==null?0:e.BusinessPhoneNumbers.length),"HOMP",i(e.HomePhoneNumbers==null?0:e.HomePhoneNumbers.length),"MOBP",i(e.MobilePhoneNumbers==null?0:e.MobilePhoneNumbers.length),"EML",i(e.EmailAddresses==null?0:e.EmailAddresses.length),"DPT",i(!n.nullOrWs(e.Department)),"OFC",i(!n.nullOrWs(e.OfficeLocation)))}function l(n,t){r(u,"S",n,"C",i(t))}function a(n){r(u,"S","OrgChart","MC",i(n.managers.length),"DR",i(n.directs.length),"P",i(n.peers.length))}function v(t){r(u,"S","Task","TTL",i(t!=null&&!n.nullOrWs(t.Title)),"MATCH",i(t!=null&&!n.nullOrWs(t.MatchedActionId)),"ACT",i(t==null||t.Actions==null?0:t.Actions.length))}function y(n,t){s("TSKC","V",n?"1":"0","ID",t)}function p(t,i){var r=[];n.nullOrWs(t)||(r=r.concat("V",t));n.nullOrWs(i)||(r=r.concat("ACT",i));bfbInst.cLog.apply(bfbInst,["ORGC"].concat(r))}function w(t){r(u,"S","Building","TTL",i(t!=null&&!n.nullOrWs(t.Name)))}function b(t){r(u,"S","RefQna","TTL",i(t!=null&&!n.nullOrWs(t.Title)))}function k(n){r(u,"S","PowerBi","TTL",i(n!=null&&n.Interpretations!=null&&n.Interpretations.length>0))}function d(n,t,r){var u=h(t,r);if(u==null){o("NOPERF");return}o(n,i(u.getCall.toFixed(2)))}function h(t,i){if(performance==null||performance.getEntries==null)return null;var u=performance.getEntries(),r=u.filter(function(r){if(r.name==null)return!1;var u=function(t){var i=r.name.toLowerCase(),u=g(i)==="/search";return!u&&n.hasSub(i,t)};return t.every(u)&&(i==null||!i.some(u))});return{getCall:r.length<1?-1:r[0].duration}}function g(n){var t=document.createElement("a");return t.href=n,t.pathname}function i(n){return typeof n=="boolean"?n?"1":"0":n.toString()}var f="ClientInst",e="BAW",u="PAWDATA";t.sLog=o;t.log=r;t.cLog=s;t.instPersonData=c;t.instDocData=l;t.instOrgChartData=a;t.instTaskData=v;t.instBookmarkActionClick=y;t.instOrgChartClick=p;t.instBuildingData=w;t.instRefQnaData=b;t.instPowerBiData=k;t.logRtt=d;t.getRequestRtt=h})(t=n.Instrumentation||(n.Instrumentation={}))}(BingAtWork||(BingAtWork={}));_w.bfbInst=BingAtWork.Instrumentation,function(n){var t=function(){function t(){}return t.getFormattedTime=function(i){if(n.nullOrWs(i))return"";var r=new Date(i);return t.getTimeDiff(r)},t.getTimeDiff=function(n){return n==null||isNaN(n.getTime())?"":t.getTimeDiffDescription(n,t.now)},t.getTimeDiffDescription=function(i,r){var u=r.getTime()-i.getTime(),o,f,e;return u<0?u<=t.tenMinutesInMillisecondsNegative?"":n.Strings.JustNow:(o=u/t.timeUnits.day,o>t.dayThreshold)?t.formatDate(i):(f=u/t.timeUnits.hour,f>=t.twoUnitThreshold?i.getDay()!==r.getDay()?n.Strings[t.dayStringKey[i.getDay()]]+" "+t.formatAmPm(i):""+n.strFormat(n.Strings.HoursAgo,Math.round(f)):f>=t.oneHourThreshold?n.Strings.OneHourAgo:(e=Math.round(u/t.timeUnits.minute),e<=t.twoUnitThreshold)?n.Strings.JustNow:""+n.strFormat(n.Strings.MinutesAgo,e))},t.formatDate=function(n){return n.getMonth()+1+"/"+n.getDate()+"/"+n.getUTCFullYear()},t.formatAmPm=function(n){var t=n.getHours(),i=n.getMinutes(),r=t>=12?"PM":"AM";return t=t%12,t=t?t:12,i=i<10?"0"+i:i,t+":"+i+" "+r},t.getDayOfWeekAbbr=function(t){switch(t){case 0:return n.Strings.Sun;case 1:return n.Strings.Mon;case 2:return n.Strings.Tue;case 3:return n.Strings.Wed;case 4:return n.Strings.Thu;case 5:return n.Strings.Fri;case 6:return n.Strings.Sat;default:return null}},t.getMidnight=function(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate())},t.getFriendlyDate=function(i){var u=t.getMidnight(i),r=Math.floor((u.getTime()-t.today.getTime())/t.msPerDay);return r<0?t.getShortDate(i):r===0?n.Strings.Today:r===1?n.Strings.Tomorrow:r<7?t.getDayOfWeekAbbr(i.getDay()):t.getShortDate(i)},t.getFriendlyTimeUntil=function(i){var u=i.getTime()-t.now.getTime(),r=null,f=null,e;if(u<0)return null;if(u<t.msPerMin)return n.Strings.Now;u<t.msPerHr?(r=Math.floor(u/t.msPerMin),f="InMins"):u<t.msPerDay&&i.getDate()===t.now.getDate()?(r=Math.floor(u/t.msPerHr),f="InHours"):(e=t.getMidnight(i),r=Math.floor((e.getTime()-t.today.getTime())/t.msPerDay),f="InDays");switch(r){case 1:return n.strFormat(n.Strings[f+"1"],r);case 2:return n.strFormat(n.Strings[f+"2"],r);default:return n.strFormat(n.Strings[f],r)}},t.getShortDate=function(t){return n.strFormat(n.Strings.MonthAbbrDateFormat,n.Strings["MonthAbbr"+t.getMonth()],t.getDate())},t.getShortTime=function(t){var i=t.getHours();return(i>12?i%12:i===0?12:i)+":"+n.padLeft(String(t.getMinutes()),2,"0")+(i<12?"a":"p")},t.isSameDay=function(n,t){return n.getFullYear()===t.getFullYear()&&n.getMonth()===t.getMonth()&&n.getDate()===t.getDate()},t.dayStringKey=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t.dayThreshold=6,t.twoUnitThreshold=2,t.oneHourThreshold=.8,t.tenMinutesInMillisecondsNegative=-6e5,t.msPerMin=6e4,t.msPerHr=t.msPerMin*60,t.msPerDay=t.msPerHr*24,t.now=new Date,t.today=t.getMidnight(t.now),t.timeUnits={day:t.msPerDay,hour:t.msPerHr,minute:t.msPerMin},t}();n.DateTimeFormatter=t}(BingAtWork||(BingAtWork={})),function(n){n.Strings={ViewAllMatchesFor:"View all matches for {0}",SeeMoreDetailsOnBing:"See more details on Bing",ProcessingRequestFor:"Searching for {0}",Unavailable:"Unavailable",CallNumber:"Call {0}",TaskRelatedLinks:"Related Links",SeeDetailsForPeople:"View more about {0}",NoGroupResultsFoundFor:"No group results found for {0}",TaskBestMatch:"Best Match",MinutesAgo:"{0} minutes ago",OrgCountLabelColon:"All reports: ",PreviewMockManagerName:"Ronald Franklin",Organization:"Organization",BusinessPhone:"Work phone",PeopleResultsFor:"People results for {0}",BetaMessage:"Work Results BETA",SeeAllPeers:"Show all peers",Groups:"Groups",Tomorrow:"Tomorrow",TenantSearch:"Search on ",InHours1:"in 1 hour",InHours2:"in 2 hours",DocumentLastModifiedByColon:"Modified by: ",OrgCountLabel:"All reports",WhatIsThisLink:"What is this?",GroupConversations:"group conversations",ErrorPrivateGroup:"You can't see the results because this is a private group.",SkypeActivityPresenting:"Presenting",DirectionsFrom:"From",InDays:"in {0} days",InMins:"in {0} mins",PreviewMockDepartment:"US Contoso Studios",FeedbackOption5:"Relevance issue",FeedbackOption4:"Correct a mistake",FeedbackOption3:"Suggest",FeedbackOption2:"I don't like it",FeedbackOption1:"I like it",SkypeStatusDoNotDisturb:"Do not disturb",Owners:"Owners",SeeMoreGroupResultsFor:"See more group results for {0}",FeedbackAllowScreenshot:"Send a screenshot with my feedback.",HideNonWorkResultsVeil:"Show results from the web",OrganizationChart:"organization chart",PeersLabel:"Shares same manager",BuildingLocation:"Building location",FileResultsFor:"File results for {0}",DocSearchLoggingDisclaimer:"MS Internal: Your searches (not personal info) are used to improve Bing products.",SkypeActivityInAConference:"In a conference",Directions:"Directions",ContactInfo:"Contact Info",TimedoutRequest:"Sorry, the server did not respond in time. Please try again.",DirectionsTo:"To",DirectionsGo:"Go",GroupMembers:"group members",PeopleResultsForLabel:"People results for",MonthAbbrDateFormat:"{0} {1}",BuildingName:"Building {0}",DirectReportsLabelColon:"Direct reports: ",SkypeActivityUrgentInterruptionsOnly:"Urgent interruptions only",d98c924ac0de4504bd930a7b81f0403d_ContractorCount:"CSG: {0}",SeeMoreOnDrWhom:"See more on Dr. Whom",SkypeActivityOutOfOffice:"Out of office",ProcessingBookmarkRequestFor:"Searching bookmarks for {0}",SeeMoreOnOffice:"See more on Office.com",People:"People",MobilePhone:"Mobile phone",MonthAbbr11:"Dec",MonthAbbr10:"Nov",CalendarError:"Calendar data is currently not available.",UpcomingEvents:"Upcoming events",NoResultsFoundDescription:"We're still in training.\r\nPlease leave us feedback. Meanwhile, try out some of the tricks we already know how to do.",DrWhomLinkText:"Visit Dr.Whom for more.",DocumentTitle:"Name",DocumentLastModifiedOnColon:"Modified on: ",ViewBuildingLocation:"View building location",GroupOwners:"Group owners",JobLink:"We're Hiring!",TodaysEvents:"Today's events",Personalized:"Personalized",FloorActionTitle:"See office and floor map",FeedbackScreenshotText:"Send a screenshot with my feedback. No personal content is shared.",SkypeActivityInAMeeting:"In a meeting",FeedbackAllowAlias:"Include my alias along with my feedback.",FileResultsForLabel:"File results for",NoResultsFound:"No results found",d98c924ac0de4504bd930a7b81f0403d_VendorCount:"Vendor: {0}",NoUpcomingEventsWith:"No upcoming events with {0}",MfaLinkMessage:"Click here to sign in with multi-factor authentication",d98c924ac0de4504bd930a7b81f0403d_HiredPosition:"+ {0} Hired",SuggestBookmark:'Please add a bookmark for "{0}". Suggested URL: <enter URL here>',FeedbackEnterFeedback:"Enter your feedback here",SeeMoreOrg:"Show full organization chart",OrgChartError:"Organization data is currently not available.",HomePhone:"Home phone",SeeMorePeopleResults:"See more people results",MfaMessage:"You may require a stronger form of authentication to access corporate resources.",PersonDocDisclaimer_LinkText:"go to Delve",SkypeStatusBeRightBack:"Be right back",d98c924ac0de4504bd930a7b81f0403d_InternCount:"Intern: {0}",ProcessingGroupRequestFor:"Searching group for {0}",HoursAgo:"{0} hours ago",EmailNamed:"Email {0}",SkypeStatusAway:"Away",SkypeStatusBusy:"Busy",SkypeStatusIdle:"Inactive",UpcomingEventsWith:"Upcoming events with {0}",PowerBi:"Power BI",SeeLessResults:"See less results",DirectFteLabel:"Direct FTEs",PreviewMockManagerJobTitle:"Corporate Vice President",d98c924ac0de4504bd930a7b81f0403d_MiscCount:"Misc: {0}",Bookmarks:"Bookmarks",OpenIMChat:"Chat with {0}",NoFloorPlanResultsFoundFor:"The office location map for {0} is not available. In some cases, showing floor plans is restricted by policy.",OrganizationInfo:"Organization info",ErrorGeneral:"Sorry, we had some trouble with this request. Please try again.",BestWorkMatchIs:"Best work match is {0}",JustNow:"Just now",Fri:"Fri",Mon:"Mon",Now:"now",Wed:"Wed",Tue:"Tue",Thu:"Thu",Sun:"Sun",Sat:"Sat",Email:"Email",d98c924ac0de4504bd930a7b81f0403d_OpenPosition:"+ {0} Open",About:"About",Alias:"Alias",Files:"Files",Group:"Group",Delve:"Delve",Today:"Today",Phone:"Phone",ProcessingDocumentRequestFor:"Searching documents for {0}",MonthAbbr6:"Jul",MonthAbbr7:"Aug",MonthAbbr4:"May",MonthAbbr5:"Jun",MonthAbbr2:"Mar",MonthAbbr3:"Apr",MonthAbbr0:"Jan",MonthAbbr1:"Feb",MonthAbbr8:"Sep",MonthAbbr9:"Oct",SkypeActivityOffWork:"Off work",AllFteLabel:"All FTEs",d98c924ac0de4504bd930a7b81f0403d_OtherDetail:"{0}",MessageNamed:"Message {0}",PreviewMockHeroJobTitle:"Partner PM Manager",DocSearchShortPersonalizedDisclaimer:"Only you can see this",ProcessingPeopleRequestFor:"Searching people for {0}",ExpandViewMore:"View more",ExpandViewLess:"View less",ProcessingFloorPlanRequestFor:"Searching floor plan for {0}",GetDirectionsTo:"Get directions to {0} on Bing Maps",PreviewMockHeroPhone:"+1 (425) 321-7654",PreviewMockHeroEmail:"Partner PM Manager",OfficeLocationNamed:"Office location {0}",ShowNonWorkResultsVeil:"Hide results from the web",FeedbackCancel:"Cancel",SuggestBookmarkLinkText:"Suggest a bookmark",DocSearchPersonalizedDisclaimer:"Results are personalized and are only visible to you.",PrivacyLink:"Privacy",SeeMoreOnDelve:"See more on Delve",CalendarLoading:"Loading calendar data...",DocumentsAbout:'Documents about "{0}"',NoResultsFeedback:"Please leave us feedback. Meanwhile, try out some of the tricks we already know how to do.",SeeMoreResults:"See more results",FeedbackTellMicrosoft:"Tell Microsoft",ReportsTo:"Reports to",Conversations:"Conversations",SkypeStatusOnline:"Available",SeeMorePeopleResultsFor:"See more people results for {0}",SkypeStatusOffline:"Offline",NoDocumentResultsFoundFor:"No document results found for {0}",ExpandButtonTitle:"Expand to see more details",FeedbackDisclaimer:"The Bing@Work team uses your feedback as part of our ongoing improvement efforts and may follow up with you using your alias unless you uncheck the box above. Do not send sensitive info or details that shouldn't be shared outside of your team.",FeedbackTitle:"Work Results Feedback",FeedbackThank:"Thank you for your feedback!",Department:"Department",OneHourAgo:"About an hour ago",d98c924ac0de4504bd930a7b81f0403d_FteCount:"{0} FTE",SkypeActivityOnThePhone:"On the phone",BuildingsFullScreenMap:"Larger map",FloorPlan:"Floor plan",NoPeopleResultsFoundFor:"No people results found for {0}",GroupResultsFor:"Group results for",FeedbackLink:"Feedback",FeedbackView:"View",FeedbackSend:"Send",SendMail:"Send mail to {0}",CorpOnlyMessage:"Only {0} employees can see this",PersonDocDisclaimer_Text:"Only you can see these results. To see what coworkers can see,",Loading:"Loading...",NoResultsTraining:"We're still in training.",FeedbackSubmit:"Send",DocumentsBy:"Documents by {0}",d98c924ac0de4504bd930a7b81f0403d_FteDetail:"{0}",DirectReportsLabel:"Direct reports",Members:"Members",SeeLessOrg:"Show less organization chart",SkypeStatusUnknown:"Status unknown",OrgChartLoading:"Loading organization data...",FeedbackPrivacy:"Privacy Policy",OrgActionTitle:"See organization chart",PreviewMockHeroNickname:"mxmc",Description:"Description",InDays1:"in 1 day",InDays2:"in 2 days",InHours:"in {0} hours",InMins2:"in 2 mins",InMins1:"in 1 min",NoBookmarkResultsFoundFor:"No bookmark results found for {0}",WorkResults:"Work results",SeeMoreAllResults:"See more on SharePoint",Documents:"Documents",d98c924ac0de4504bd930a7b81f0403d_CsgCount:"+ {0} Other",GroupFiles:"group files",FeedbackTellYourCompany:"Tell your company",NoResultsFoundFor:"No results found for {0}",SeeMoreResultsFor:"See more results for {0}",ResultsFor:"Results for {0}",OfficeLocation:"Office location",PreviewMockHeroOfficeLocation:"City Center/6322",SeeMoreGroupResults:"See more group results",d98c924ac0de4504bd930a7b81f0403d_CostCenter:"Cost center",AllResults:"All Results",DocumentSource:"Location",OrgDirectReports:"Direct Reports {0}",SsoIsPending:"Signing you in ...",OpenSkypeChat:"Chat with {0} through Skype",PreviewMockHeroName:"Maxwell McCormick",DocumentLastModifiedBy:"Modified by",DocumentLastModifiedOn:"Modified on",Buildings:"Buildings"};sj_evt.fire("BingAtWork:LocStrings")}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function r(t,i,r){var u={Scenario:t,PeopleNumber:i,BusinessPhone:r.BusinessPhoneNumbers==null?0:r.BusinessPhoneNumbers.length,HomePhone:r.HomePhoneNumbers==null?0:r.HomePhoneNumbers.length,MobilePhone:r.MobilePhoneNumbers==null?0:r.MobilePhoneNumbers.length,Email:r.EmailAddresses==null?0:r.EmailAddresses.length,Department:!n.nullOrWs(r.Department),OfficeLocation:!n.nullOrWs(r.OfficeLocation)};bfbTel.logValue(n.EventScope.Paw,"Person","",u)}function u(t,i){var r={Scenario:t,DocumentNumber:i};bfbTel.logValue(n.EventScope.Paw,"Document","",r)}function f(t){var i={Managers:t.managers.length,Directs:t.directs.length,Peers:t.peers.length};bfbTel.logValue(n.EventScope.Paw,"OrgChart","",i)}function e(t){var i={TaskTitle:t!=null&&!n.nullOrWs(t.Title),MatchedId:t!=null&&!n.nullOrWs(t.MatchedActionId),Actions:t==null||t.Actions==null?0:t.Actions.length};bfbTel.logValue(n.EventScope.Paw,"Task","",i)}function o(t){var i={Name:t!=null&&!n.nullOrWs(t.Name)};bfbTel.logValue(n.EventScope.Paw,"Building","",i)}function s(t){var i={Title:t!=null&&!n.nullOrWs(t.Title)};bfbTel.logValue(n.EventScope.Paw,"RefQna","",i)}function h(t){var i={FrontendUrl:t!=null&&!n.nullOrWs(t.FrontendUrl),Interpretations:t!=null&&t.Interpretations!=null?t.Interpretations.length:0};bfbTel.logValue(n.EventScope.Paw,"PowerBi","",i)}var i=function(){function i(t){this.config=n.chk(t)}return i.prototype.buildSearchResponse=function(i,e,o,s,h){var c,p,l,w,v,y;if(s===void 0&&(s=null),e==null||e.Items==null)return{scenario:i};c=e.Items;p=s==null?e.UserInfo:s.userInfo;switch(i){case n.BfbResponseScenario.Person:return l={qry:o,scenario:i,heroPerson:c.length>0?c[0]:null,userInfo:p,all:c,command:s},bfbInst.instPersonData(n.BfbResponseScenario[i],c.length,l.heroPerson),r(n.BfbResponseScenario[i],c.length,l.heroPerson),l;case n.BfbResponseScenario.Document:case n.BfbResponseScenario.PersonDocument:bfbInst.instDocData(n.BfbResponseScenario[i],c.length);u(n.BfbResponseScenario[i],c.length);w=h==null?null:h[t.PawDataService.NoPrsBkFill];c=h==null||w==null||w.toLowerCase()!=="true"?c.filter(function(n){return n!=null&&n.Provenance!=="Exchange"}):[];var a=s==null?null:s.analysis,b=function(n,t){return a!=null&&a[n]!=null&&a[n].length>0?a[n][0][t]:null};return{scenario:i,userInfo:p,files:c,personName:b("Persons","Name"),keyword:b("KeyWords","Keyword"),command:s};case n.BfbResponseScenario.OrgChart:return v=function(n){return c==null||c[n]==null?[]:c[n]},y={scenario:i,managers:v("ManagementChain"),directs:v("DirectReports"),peers:v("Peers")},bfbInst.instOrgChartData(y),f(y),y;case n.BfbResponseScenario.Groups:return{scenario:i,groups:c};case n.BfbResponseScenario.GroupMembers:return{scenario:i,groupMembers:c};case n.BfbResponseScenario.GroupConversations:return{scenario:i,groupConversations:c};case n.BfbResponseScenario.GroupFiles:return{scenario:i,groupFiles:c};case n.BfbResponseScenario.GroupDetails:return{scenario:i,group:c.length===0?null:c[0]};default:throw new Error("dont know "+i);}},i.buildTaskResponse=function(t){var i={scenario:n.BfbResponseScenario.Task,task:JSON.parse(t.Tasks[0].Metadata)};return bfbInst.instTaskData(i.task),e(i.task),i},i.buildBuildingsResponse=function(t){if(t.Buildings==null||t.Buildings[0]==null||n.nullOrWs(t.Buildings[0].Metadata))return null;var i={scenario:n.BfbResponseScenario.Buildings,building:JSON.parse(t.Buildings[0].Metadata)};return bfbInst.instBuildingData(i.building),o(i.building),i},i.buildRefQnaResponse=function(t){if(t.RefQna==null||t.RefQna[0]==null||n.nullOrWs(t.RefQna[0].Metadata))return null;var i={scenario:n.BfbResponseScenario.RefQna,refQna:JSON.parse(t.RefQna[0].Metadata)};return bfbInst.instRefQnaData(i.refQna),s(i.refQna),i},i.buildPowerBiResponse=function(t){if(t.PowerBiInterpretations==null||t.PowerBiInterpretations.Interpretations==null||t.PowerBiInterpretations.Interpretations.length==0)return null;var i={scenario:n.BfbResponseScenario.PowerBi,cards:t.PowerBiInterpretations};return bfbInst.instPowerBiData(i.cards),h(i.cards),i},i.getBfbCommand=function(t,r,u){var f,e,o,s,h;return u==null?null:(f=n.getFirstScopeAnalysis(u.ScopeAnalysis),f==null)?null:(e=i.parseAddtionalQueryItems(u.ScopeAnalysis),o=e.intent,t.intent===n.QueryIntent.None&&(t.intent=o),s=n.ScopeDomain[f.Domain],h=i.scenarioMap[s],{qry:t.qry,domain:s,analysis:f,scenario:h,userInfo:u.UserInfo,queryIntent:o,confidence:e.confidence,answerData:u.AnswerData})},i.parseAddtionalQueryItems=function(t){var i=n.getFirstScopeAnalysis(t),r={intent:n.QueryIntent.None,confidence:n.ConfidenceQueryItem.None},u,e,f,s,o;if(i!=null&&i.AdditionalQueryItems!=null&&i.AdditionalQueryItems.length>0)for(u=0,e=i.AdditionalQueryItems;u<e.length;u++)f=e[u],f==="Confidence-High"?r.confidence=n.ConfidenceQueryItem.High:f==="Confidence-Low"?r.confidence=n.ConfidenceQueryItem.Low:(s=n.AttributeMetadataHint[f],o=this.mapAttributeMetadataHintToIntent(s),o!==n.QueryIntent.None&&(r.intent=o));return r},i.mapAttributeMetadataHintToIntent=function(t){if(t==null)return n.QueryIntent.None;switch(t){case n.AttributeMetadataHint.department:return n.QueryIntent.Department;case n.AttributeMetadataHint.email:return n.QueryIntent.Email;case n.AttributeMetadataHint.alias:return n.QueryIntent.Alias;case n.AttributeMetadataHint.office:return n.QueryIntent.Office;case n.AttributeMetadataHint.phone:return n.QueryIntent.Phone;case n.AttributeMetadataHint.title:return n.QueryIntent.Title;case n.AttributeMetadataHint.people_graph:return n.QueryIntent.OrgChart;case n.AttributeMetadataHint.person_docs:return n.QueryIntent.PersonDocs;case n.AttributeMetadataHint.Members:return n.QueryIntent.GroupMembers;case n.AttributeMetadataHint.Files:return n.QueryIntent.GroupFiles;case n.AttributeMetadataHint.Conversations:return n.QueryIntent.GroupConversations;case n.AttributeMetadataHint.groups:return n.QueryIntent.Group;default:return n.QueryIntent.None}},i.defaultFilter=function(n){return n},i.scenarioMap={},i.__ctor=function(){i.scenarioMap[n.ScopeDomain.File]=n.BfbResponseScenario.Document;i.scenarioMap[n.ScopeDomain.Person]=n.BfbResponseScenario.Person;i.scenarioMap[n.ScopeDomain.Task]=n.BfbResponseScenario.Task;i.scenarioMap[n.ScopeDomain.Group]=n.BfbResponseScenario.Groups;i.scenarioMap[n.ScopeDomain.Buildings]=n.BfbResponseScenario.Buildings;i.scenarioMap[n.ScopeDomain.RefQna]=n.BfbResponseScenario.RefQna;i.scenarioMap[n.ScopeDomain.PowerBi]=n.BfbResponseScenario.PowerBi}(),i}();t.PawResponseBuilder=i})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var i=function(){function t(n){this.id=n}return t.suppress=function(t){return{placement:n.AnswerPlacement.None,treatment:t}},t.prototype.rank=function(t){if(t==null)return null;var i=this.rankInternal(t);if(i==null)return null;if(this.id==null)throw new Error("Cannot rank: ranking rule did not provide its id.");else if(i.placement==null)throw new Error("Cannot rank: ranking rule '"+this.id+"': '"+n.RankingRuleId[this.id]+"' is missing a placement.");return{placement:i.placement,treatment:i.treatment,rankingRuleId:this.id}},t}(),r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g;t.AnswerRankingRuleBase=i;r=function(n){function t(t,i,r){var u=n.call(this,t)||this;return u.conditions=i,u.result=r,u}return __extends(t,n),t.prototype.rankInternal=function(n){var t=this.conditions,i=t.scenario,r=t.confidenceLevel,u=t.behavior,e=n.command?n.command.scenario:null,o=n.command?n.command.confidence:null,f=n.bfbContext&&n.bfbContext.qrynf!=null?n.bfbContext.qrynf():null,s=f?f.bhvr:null;return i!=null&&i!==e||r!=null&&r!==o||u!=null&&u!==s?null:this.result},t}(i);t.ContextConditionalRankingRule=r;u=function(r){function u(){return r.call(this,n.RankingRuleId.SuppressNonBookmarkForUrlQueries)||this}return __extends(u,r),u.prototype.rankInternal=function(r){var u=r.bfbContext.qrynf!=null?r.bfbContext.qrynf():null,f;return r.command==null||r.command.scenario===n.BfbResponseScenario.Task||u==null||n.nullOrWs(u.rawQuery)?null:(f=/^((https?:)?\/\/)+|(www.)+/gi,u.rawQuery.match(f)!=null)?i.suppress(t.Helpers.getDefaultTreatment(r.command.scenario)):null},u}(i);t.SuppressNonBookmarkForUrlQueriesRule=u;f=function(r){function u(t){var i=r.call(this,n.RankingRuleId.MobileDefaultPole)||this;return i.config=t,i}return __extends(u,r),u.prototype.rankInternal=function(r){if(this.config.render&&this.config.render.isInline&&r.command&&r.command.confidence!==n.ConfidenceQueryItem.Low){var u=r.command.scenario,f=t.Helpers.getDefaultTreatment(u);return this.config.middleTier.useWebIntentConf&&r.command.answerData.WebIntentConfidence===n.WebIntentConfidence.High&&u!==n.BfbResponseScenario.Task?i.suppress(f):{placement:n.AnswerPlacement.Pole,treatment:f}}return null},u}(i);t.MobileDefaultPoleRule=f;e=function(t){function i(){return t.call(this,n.RankingRuleId.MeQueryPromotion)||this}return __extends(i,t),i.prototype.rankInternal=function(t){var i=t.command?t.command.qry:null;return i==null||i.toLowerCase()!=="me"&&i.toLowerCase()!=="who am i"?null:{treatment:n.Treatment.People,placement:n.AnswerPlacement.Pole}},i}(i);t.MeQueryPromotionRule=e;o=function(t){function r(){return t.call(this,n.RankingRuleId.SerpRequerySuppression,{behavior:n.QueryBehavior.SerpRequery},i.suppress(n.Treatment.People))||this}return __extends(r,t),r}(r);t.SerpRequerySuppressionRule=o;s=function(i){function r(){return i.call(this,n.RankingRuleId.BfbRequeryPromotion)||this}return __extends(r,i),r.prototype.rankInternal=function(i){var u=i.bfbContext.qrynf!=null?i.bfbContext.qrynf():null,r;return!i.bfbContext||u==null||u.bhvr!==n.QueryBehavior.BingAtWorkRequery?null:(i.command?r=i.command.scenario:i.response?r=i.response.scenario:u.intent&&(r=t.Helpers.getDefaultScenario(u.intent)),r==null)?null:{placement:n.AnswerPlacement.Pole,treatment:t.Helpers.getDefaultTreatment(r)}},r}(i);t.BingAtWorkRequeryPromotionRule=s;h=function(t){function r(){return t.call(this,n.RankingRuleId.PersonQuerySuppression,{behavior:n.QueryBehavior.Suppress},i.suppress(n.Treatment.People))||this}return __extends(r,t),r}(r);t.PersonQuerySuppressionRule=h;c=function(t){function r(i){var r=t.call(this,n.RankingRuleId.GroupSuppression)||this;return r.config=i,r}return __extends(r,t),r.prototype.rankInternal=function(t){if(!t.command||t.command.scenario!==n.BfbResponseScenario.Groups)return null;var u=this.config.ft&&this.config.ft.grpsrch?this.config.ft.grpsrch.supAll:null,r=t.bfbContext&&t.bfbContext.qrynf!=null?t.bfbContext.qrynf():null,f=r?r.queryCount:null,e=t.bfbContext&&t.bfbContext.cfg&&t.bfbContext.cfg.ft&&t.bfbContext.cfg.ft.grpsrch?t.bfbContext.cfg.ft.grpsrch.supQc:null;return!u&&f<=e?null:i.suppress(n.Treatment.Group)},r}(i);t.GroupSuppressionRule=c;l=function(r){function u(t){var i=r.call(this,n.RankingRuleId.Person)||this;return i.config=t,i}return __extends(u,r),u.prototype.rankInternal=function(r){if(r.command==null||r.command.scenario!==n.BfbResponseScenario.Person)return null;if(this.config.middleTier.useWebIntentConf)return this.rankWithNewModel(r);var f=t.Helpers.isFullName(r),u=t.Helpers.isQueryFrequencyHigh(r),e=t.Helpers.hasIntent(r);return f?{placement:u?n.AnswerPlacement.ContextRegionBottom:n.AnswerPlacement.Pole,treatment:n.Treatment.People}:u?i.suppress(n.Treatment.People):{placement:e?n.AnswerPlacement.Pole:n.AnswerPlacement.ContextRegionBottom,treatment:n.Treatment.People}},u.prototype.rankWithNewModel=function(i){if(i.command==null||i.command.scenario!==n.BfbResponseScenario.Person||i.response==null)return null;var f=i.response,h=i.bfbContext&&i.bfbContext.qrynf!=null?i.bfbContext.qrynf():null,e=h.webIntentConf,o=f.heroPerson.Rank>this.config.ft.rank.qasHighRankThreshold,c=f.heroPerson.Rank>this.config.ft.rank.qasMedRankThreshold,u=t.Helpers.isExactPersonMatch(i),s=t.Helpers.hasIntent(i),r;return e===n.WebIntentConfidence.High?r=o&&u?n.AnswerPlacement.Pole:u?s?n.AnswerPlacement.Pole:n.AnswerPlacement.ContextRegionTop:o?n.AnswerPlacement.ContextRegionTop:n.AnswerPlacement.None:c||u?r=n.AnswerPlacement.Pole:e===n.WebIntentConfidence.Low&&s&&(r=n.AnswerPlacement.Pole),r==null&&(r=n.AnswerPlacement.ContextRegionTop),{placement:r,treatment:n.Treatment.People}},u}(i);t.PersonRule=l;a=function(r){function u(t){var i=r.call(this,n.RankingRuleId.Documents)||this;return i.config=t,i}return __extends(u,r),u.prototype.rankInternal=function(r){if(!r.command||r.command.scenario!==n.BfbResponseScenario.Document)return null;if(t.Helpers.isQueryFrequencyHigh(r))return i.suppress(n.Treatment.Documents);var u=this.config.ft.docs.placement;return{placement:u,treatment:n.Treatment.Documents}},u}(i);t.DocumentsRule=a;v=function(i){function r(t){var r=i.call(this,n.RankingRuleId.Bookmarks)||this;return r.config=t,r}return __extends(r,i),r.prototype.rankInternal=function(i){return!i.command||i.command.scenario!==n.BfbResponseScenario.Task?null:this.config.middleTier.useWebIntentConf?t.Helpers.rankWithWebIntentConfidence(i):t.Helpers.isQueryFrequencyHigh(i)&&!this.config.render.isInline?{placement:n.AnswerPlacement.ContextRegionTop,treatment:n.Treatment.Bookmarks}:{placement:n.AnswerPlacement.Pole,treatment:n.Treatment.Bookmarks}},r}(i);t.BookmarksRule=v;y=function(r){function u(t){var i=r.call(this,n.RankingRuleId.Buildings)||this;return i.config=t,i}return __extends(u,r),u.prototype.rankInternal=function(r){if(!r.command||r.command.scenario!==n.BfbResponseScenario.Buildings)return null;var u={placement:n.AnswerPlacement.Pole,treatment:n.Treatment.Buildings},f=t.Helpers.hasIntent(r)||t.Helpers.hasToken("FloorName",r);return f?u:this.config.middleTier.useWebIntentConf&&this.config.ft.bld.ecr?t.Helpers.rankWithWebIntentConfidence(r):t.Helpers.isQueryFrequencyHigh(r)||r.command.confidence===n.ConfidenceQueryItem.Low?i.suppress(n.Treatment.Buildings):u},u}(i);t.BuildingsRule=y;p=function(t){function i(){return t.call(this,n.RankingRuleId.RefQna,{scenario:n.BfbResponseScenario.RefQna},{placement:n.AnswerPlacement.Algo,treatment:n.Treatment.RefQna})||this}return __extends(i,t),i}(r);t.RefQnaRule=p;w=function(t){function i(){return t.call(this,n.RankingRuleId.Groups)||this}return __extends(i,t),i.prototype.rankInternal=function(t){return!t.command||t.command.scenario!==n.BfbResponseScenario.Groups?null:t.command.confidence===n.ConfidenceQueryItem.High?{placement:n.AnswerPlacement.Pole,treatment:n.Treatment.Group}:{placement:n.AnswerPlacement.None,treatment:n.Treatment.GroupDisambig}},i}(i);t.GroupsRule=w;b=function(t){function i(i){var r=t.call(this,n.RankingRuleId.OrgRelPromotion)||this;return r.config=i,r}return __extends(i,t),i.prototype.rankInternal=function(t){if(!t.command||t.command.scenario!==n.BfbResponseScenario.Person||this.config.middleTier.useWebIntentConf)return null;var i=t.response,r=t.bfbContext&&t.bfbContext.qrynf!=null?t.bfbContext.qrynf():null;return i.heroPerson==null||i.heroPerson.inchain==null||i.heroPerson.inchain===n.OrgRelationship.UserIsNotInOrg||r!=null&&r.bhvr===n.QueryBehavior.SerpRequery?null:{treatment:n.Treatment.People,placement:n.AnswerPlacement.Pole}},i}(i);t.OrgRelPromotionRule=b;k=function(r){function u(t){var i=r.call(this,n.RankingRuleId.SuppressFarDistancePartialName)||this;return i.config=t,i}return __extends(u,r),u.prototype.rankInternal=function(r){var s=r.command&&r.command.scenario===n.BfbResponseScenario.Person,h=this.config.ft.dstnc&&this.config.ft.dstnc.e,c=t.Helpers.isFullName(r)||t.Helpers.hasIntent(r),u=r.response.heroPerson;if(!s||!h||c||u==null||!t.Helpers.isQueryFrequencyHigh(r)||this.config.middleTier.useWebIntentConf)return null;var f=t.Helpers.getDistance(u),l=t.Helpers.getUserDepth(u.ReportingChain),e=t.Helpers.getCurrUserOrgDepth(this.config,u.inchain,f,l),o=this.config.ft&&this.config.ft.dstnc?this.config.ft.dstnc.distanceThreshold:null;return e!=null&&f!=null&&o!=null&&e>=0&&f>=0&&f>e+o?i.suppress(n.Treatment.People):null},u}(i);t.SuppressFarDistancePartialNameRule=k;d=function(i){function r(t){var r=i.call(this,n.RankingRuleId.DisambigPersonsForMobile)||this;return r.config=t,r}return __extends(r,i),r.prototype.rankInternal=function(i){if(!i.command||i.command.scenario!==n.BfbResponseScenario.Person)return null;var r=i.response,u=this.config.middleTier.useWebIntentConf&&i.command.answerData.WebIntentConfidence===n.WebIntentConfidence.High;return!this.config.render.isInline||r.all==null||r.all.length==null||r.all.length<=1||t.Helpers.hasIntent(i)?null:{treatment:n.Treatment.PeopleDisambig,placement:u?n.AnswerPlacement.None:n.AnswerPlacement.Pole}},r}(i);t.DisambigPersonsForMobileRule=d;g=function(t){function i(){return t.call(this,n.RankingRuleId.PowerBi,{scenario:n.BfbResponseScenario.PowerBi},{placement:n.AnswerPlacement.Pole,treatment:n.Treatment.PowerBi})||this}return __extends(i,t),i}(r);t.PowerBiRule=g})(t=n.Ranking||(n.Ranking={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i;(function(t){function r(t){switch(t){case n.BfbResponseScenario.Task:return n.Treatment.Bookmarks;case n.BfbResponseScenario.Document:return n.Treatment.Documents;case n.BfbResponseScenario.Person:return n.Treatment.People;case n.BfbResponseScenario.Groups:return n.Treatment.Group;case n.BfbResponseScenario.Buildings:return n.Treatment.Buildings;case n.BfbResponseScenario.RefQna:return n.Treatment.RefQna;default:return null}}function f(t){switch(t){case n.QueryIntent.Building:return n.BfbResponseScenario.Buildings;case n.QueryIntent.Group:case n.QueryIntent.GroupConversations:case n.QueryIntent.GroupFiles:case n.QueryIntent.GroupMembers:return n.BfbResponseScenario.Groups;case n.QueryIntent.Office:case n.QueryIntent.Department:case n.QueryIntent.Email:case n.QueryIntent.Title:case n.QueryIntent.Alias:case n.QueryIntent.PersonDocs:return n.BfbResponseScenario.Person;default:return null}}function e(t){if(t.inchain===n.OrgRelationship.UserIsPeer)return 2;var i=t.NonEmptyAttributeCount*.025+.775;return-1*(t.Rank-i)/t.inchain}function o(t,i,r,u){if(i==null||r<0||u<0)return-1;switch(i){case n.OrgRelationship.UserIsPeer:return u;case n.OrgRelationship.UserIsReport:return r+u;case n.OrgRelationship.UserIsManager:return u-r;case n.OrgRelationship.UserIsSelf:return u;case n.OrgRelationship.UserIsNotInOrg:return t.ft.dstnc?t.ft.dstnc.currUserOrgDepth:-1;default:return-1}}function s(n){if(n==null||n.length===0)return-1;var t=n.split(";");return t.length-1}function h(t){if(t==null||t.command==null||t.command.analysis==null)return!1;var r=t.command.qry;return!n.nullOrWs(r)&&i("fullname",t)&&r.split(" ").length>1||i("userprincipalname",t)}function i(n,t){var i,r;return t.command==null||t.command.analysis==null?!1:(i=t.command.analysis.TokenizedStream,i==null)?!1:(r=n.toLowerCase(),i.some(function(n){return n.TokenType.toLowerCase()===r}))}function c(t){var i=t.response,r,u;return i==null||i.heroPerson==null?!1:(r=i.heroPerson.Interpretation,u=["FullName","Mail","UserPrincipalName"],!n.nullOrWs(r)&&u.some(function(n){return n===r}))}function l(t){return t.bfbContext&&t.bfbContext.qrynf&&t.bfbContext.qrynf()&&t.bfbContext.qrynf().queryFrequency===n.QueryFrequency.High}function u(t){return t.bfbContext!=null&&t.bfbContext.qrynf!=null&&t.bfbContext.qrynf()!=null&&t.bfbContext.qrynf().intent!=null&&t.bfbContext.qrynf().intent!==n.QueryIntent.None}function a(t){var e=t.bfbContext.qrynf().webIntentConf,f=u(t),i;switch(e){case n.WebIntentConfidence.High:i=f?n.AnswerPlacement.Pole:n.AnswerPlacement.ContextRegionTop;break;case n.WebIntentConfidence.Medium:i=f||t.command.scenario===n.BfbResponseScenario.Task?n.AnswerPlacement.Pole:n.AnswerPlacement.ContextRegionTop;break;default:i=n.AnswerPlacement.Pole}return{placement:i,treatment:r(t.command.scenario)}}t.getDefaultTreatment=r;t.getDefaultScenario=f;t.getDistance=e;t.getCurrUserOrgDepth=o;t.getUserDepth=s;t.isFullName=h;t.hasToken=i;t.isExactPersonMatch=c;t.isQueryFrequencyHigh=l;t.hasIntent=u;t.rankWithWebIntentConfidence=a})(i=t.Helpers||(t.Helpers={}))})(t=n.Ranking||(n.Ranking={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i=function(){function i(n){this.config=n;this.afterCommandResponseRules=[new t.SuppressNonBookmarkForUrlQueriesRule,new t.MobileDefaultPoleRule(n),new t.MeQueryPromotionRule,new t.BingAtWorkRequeryPromotionRule,new t.PersonQuerySuppressionRule,new t.GroupSuppressionRule(n),new t.SerpRequerySuppressionRule,new t.PersonRule(n),new t.DocumentsRule(n),new t.BookmarksRule(n),new t.BuildingsRule(n),new t.RefQnaRule,new t.GroupsRule,new t.PowerBiRule];this.afterDataResponseRules=[new t.SuppressFarDistancePartialNameRule(n),new t.OrgRelPromotionRule(n),new t.DisambigPersonsForMobileRule(n)]}return i.prototype.rank=function(t){var i,r;return t==null||t.command==null||t.bfbContext==null,i=null,t!=null&&(i=this.evaluateRules(this.afterCommandResponseRules,t),t.response!=null&&(r=this.evaluateRules(this.afterDataResponseRules,t),r!=null&&(i=r))),i!=null&&(this.config.placementOverride!=null?(i.placement=this.config.placementOverride,i.rankingRuleId=n.RankingRuleId.OverrideExplicit):t.bfbContext.qrynf().isMtr&&(i.placement=n.AnswerPlacement.Pole,i.rankingRuleId=n.RankingRuleId.OverrideExplicit)),i},i.prototype.evaluateRules=function(t,i){for(var e,r,u=0,f=t;u<f.length;u++)if(e=f[u],r=e.rank(i),r!=null)return r;return null},i}();t.AnswerRanker=i})(t=n.Ranking||(n.Ranking={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i,r;(function(n){n[n.Initial=0]="Initial";n[n.InProgress=1]="InProgress";n[n.Succeeded=2]="Succeeded";n[n.Failed=3]="Failed"})(i||(i={}));r=function(){function t(t){var r=this;this.initializationStatus=i.Initial;this.skypeOptions=t;sj_evt.bind("onP1",function(){n.tryInsertStyles("bw-skypeFont","@font-face {font-family: 'SkypeIcons'; src: url('"+r.skypeOptions.fontResource+"') format('woff'); }");sb_st(function(){sj_evt.fire("onSkypeFontReady")},5e3)},!0);Shared.waitForModuleLoad(function(){return r.signInSkype()},"Skype","OnScriptLoad:SkypeWebSdk")}return t.prototype.register=function(n,t){var i=this;this.bindCallback(function(){i.registerForOneUser(n,t)})},t.prototype.logSkypeError=function(t){bfbInst.sLog("SKPER",t);bfbTel.logValue(n.EventScope.SkypeClient,"SkypeError",t)},t.prototype.bindCallback=function(i){if(t.skypeApp){var r=t.skypeApp.signInManager.state();if(r==="SignedIn"){i();return}if(r==="SigningIn"){sj_evt.bind(n.skypeSignedIn,function(){return i()},!0);return}}sj_evt.bind(n.skypeSignedIn,function(){return i()},!0)},t.prototype.signInSkype=function(){var r=this;(this.initializationStatus===i.Initial||this.initializationStatus===i.Failed)&&(this.initializationStatus=i.InProgress,Skype.initialize({apiKey:this.skypeOptions.apiKey},function(u){r.initializationStatus=i.Succeeded;var f=3,e=function(i){if(i!==0){t.skypeApp=new u.application({settings:{remotePresenceOnlyMode:!0,remoteSearchResultsOnly:!1}});var o=sb_st(function(){r.logSkypeError("Sign in Skype timed out. The request may be throttled.")},t.skypeTimeoutInMilliseconds);t.skypeApp.signInManager.signIn({id:"EF87F5D4-3F4A-48E9-BAB7-4CA4B3189AB8",version:r.skypeOptions.consumerVersion,client_id:r.skypeOptions.parentClientId,cors:!0,redirect_uri:location.protocol+"//"+location.hostname+r.skypeOptions.signInRedirectUri,origins:[r.skypeOptions.signInOrigin],events:!1}).then(function(){sb_ct(o);sj_evt.fire(n.skypeSignedIn)},function(t){sb_ct(o);i--;r.logSkypeError(t);e(i)})}};e(f)},function(t){r.initializationStatus=i.Failed;r.logSkypeError(t)}))},t.prototype.registerForOneUser=function(i,r){var e=this,u,f;if(!i){this.logSkypeError("no email");return}u=3;f=function(o){if(o!==0){var s=t.skypeApp.personsAndGroupsManager.createPersonSearchQuery();s.limit(1);s.text("id:"+i);s.getMore().then(function(n){if(n&&n.length>0){var t=n[0].result;if(!t)return;e.updatePresence(t,r)}},function(t){o--;e.logSkypeError(t);f(o)})}};f(u)},t.prototype.updatePresence=function(i,r){var u=this,f=function(){var f,e;f=sb_st(function(){u.logSkypeError("Get Skype status timed out for "+i.id()+". The request may be throttled.")},t.skypeTimeoutInMilliseconds);i.status.get().then(function(){sb_ct(f);u.updateStatusActivity(i,r)});e=sb_st(function(){u.logSkypeError("Get Skype activity timed out for "+i.id()+". The request may be throttled.")},t.skypeTimeoutInMilliseconds);i.activity.get().then(function(){sb_ct(e);u.updateStatusActivity(i,r)})};f();sb_si(function(){return f()},this.skypeOptions.statusUpdateIntervalInSeconds*1e3)},t.prototype.updateStatusActivity=function(t,i){var u=t.status(),r=t.activity(),f=r&&typeof r=="string"?this.skypeOptions.activityStrings[r.toLowerCase()]:this.skypeOptions.activityStrings[u.toLowerCase()],e=n.PresenceStatus[u];i({status:e,activity:f})},t.skypeTimeoutInMilliseconds=3e3,t}();t.SkypeClient=r})(t=n.SkypePresence||(n.SkypePresence={}))}(BingAtWork||(BingAtWork={}));sj_evt.fire("OnScriptLoad:BingAtWork.SkypePresence"),function(n){var t;(function(t){var i=function(){function t(n){this.config=n}return t.prototype.search=function(t,i){if(n.nullOrWs(t)){i.onError(n.ErrorReason.BadParam);return}this.getRoomInfo(t,i)},t.prototype.getRoomInfo=function(t,i){var u=this,r=this.createAjaxRequest(n.getRoomInfoUrl(this.config.r,t,this.config.rv));r.onreadystatechange=function(){var f,e;if(r.readyState===4)if(r.status===200){f=r.responseText!==""?JSON.parse(r.responseText):null;sj_evt.fire(n.onBawFloorPlanRoomFetched);i.onDataInspect(f);u.getFloorData(t,f,i)}else{e=n.ErrorReason.Other;r.status===500?e=n.ErrorReason.HttpError:r.status===404&&(e=n.ErrorReason.NotFound);i.onError(e)}};r.send()},t.prototype.getFloorData=function(t,i,r){if(i==null){r.onSuccess(null);return}if(n.nullOrWs(i.buildingName)){r.onError(n.ErrorReason.Other);return}var u=this.createAjaxRequest(n.getFloorPlanUrl(this.config.d,i.buildingName,i.floor,i.version||this.config.rv));u.onreadystatechange=function(){var e,o,f;if(u.readyState===4)if(u.status===200){e=u.responseText!==""?JSON.parse(u.responseText):null;sj_evt.fire(n.onBawFloorPlanMapFetched);o={officeLocation:t,officeNumber:i.officeNumber,buildingName:i.buildingName,floor:i.floor,floorData:e};r.onSuccess(o)}else{f=n.ErrorReason.Other;u.status===500?f=n.ErrorReason.HttpError:u.status===404&&(f=n.ErrorReason.NotFound);r.onError(f)}};u.send()},t.prototype.createAjaxRequest=function(n){var t=sj_gx();return t.withCredentials=!0,t.open("GET",n),t},t}();t.FloorPlanService=i})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function i(t,i,r,u){u===void 0&&(u="GET");var f=sj_gx();f.withCredentials=!0;f.open(u,t);f.onreadystatechange=function(){if(f.readyState===4)if(f.status===200)i(f.responseText);else{var t=n.ErrorReason.Other;f.status===500?t=n.ErrorReason.HttpError:f.status===404&&(t=n.ErrorReason.NotFound);r(t)}};f.send()}t.callAjax=i})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={})),function(n){function t(n){var t,i,n;(function(n){var t;(function(n){var t;(function(n){n[n.ROUTE_SEARCH_RESPONSE=0]="ROUTE_SEARCH_RESPONSE";n[n.SET_CONFIGURATION=1]="SET_CONFIGURATION";n[n.SET_SEARCH_SCENARIO=2]="SET_SEARCH_SCENARIO";n[n.SET_APP_ROUTER_STATUS=3]="SET_APP_ROUTER_STATUS";n[n.SET_CONTAINERS_ATTACHED=4]="SET_CONTAINERS_ATTACHED";n[n.SET_MAINLINE_ANSWER_NOTIFICATION_VISIBILITY=5]="SET_MAINLINE_ANSWER_NOTIFICATION_VISIBILITY";n[n.SET_MAINLINE_ANSWER_ORG_SKIP_VISIBILITY=6]="SET_MAINLINE_ANSWER_ORG_SKIP_VISIBILITY";n[n.SET_MAINLINE_ANSWER_ORG_EXPAND_HOVER_VISIBILITY=7]="SET_MAINLINE_ANSWER_ORG_EXPAND_HOVER_VISIBILITY";n[n.SET_CONTEXT_REGION_ANSWER_CONTAINER_ATTACHED=8]="SET_CONTEXT_REGION_ANSWER_CONTAINER_ATTACHED";n[n.SET_ALGO_ANSWER_CONTAINER_ATTACHED=9]="SET_ALGO_ANSWER_CONTAINER_ATTACHED";n[n.EXPAND_INLINE_ANSWER_PEOPLE=10]="EXPAND_INLINE_ANSWER_PEOPLE";n[n.EXPAND_INLINE_ANSWER_PEOPLE_ORGCHART=11]="EXPAND_INLINE_ANSWER_PEOPLE_ORGCHART";n[n.EXPAND_INLINE_ANSWER_DISAMBIG=12]="EXPAND_INLINE_ANSWER_DISAMBIG";n[n.OPEN_GLEAM=13]="OPEN_GLEAM";n[n.CLOSE_GLEAM=14]="CLOSE_GLEAM";n[n.TOGGLE_GLEAM=15]="TOGGLE_GLEAM";n[n.SET_GLEAM_OPTION=16]="SET_GLEAM_OPTION";n[n.SET_GLEAM_DROP_OPTION=17]="SET_GLEAM_DROP_OPTION";n[n.CREATE_OR_UPDATE_USER_INFO=18]="CREATE_OR_UPDATE_USER_INFO";n[n.QUERY_GENERIC_REQUEST=19]="QUERY_GENERIC_REQUEST";n[n.SET_HERO_PERSON_ID=20]="SET_HERO_PERSON_ID";n[n.SEARCH_PEOPLE_INPLACE=21]="SEARCH_PEOPLE_INPLACE";n[n.SET_INPLACE_SEARCH_INTENT=22]="SET_INPLACE_SEARCH_INTENT";n[n.PEOPLE_REQUEST=23]="PEOPLE_REQUEST";n[n.PEOPLE_COMPLETED=24]="PEOPLE_COMPLETED";n[n.PEOPLE_ERROR=25]="PEOPLE_ERROR";n[n.PERSON_DOCUMENTS_REQUEST=26]="PERSON_DOCUMENTS_REQUEST";n[n.PERSON_DOCUMENTS_COMPLETED=27]="PERSON_DOCUMENTS_COMPLETED";n[n.PERSON_DOCUMENTS_ERROR=28]="PERSON_DOCUMENTS_ERROR";n[n.PERSON_ORGCHART_REQUEST=29]="PERSON_ORGCHART_REQUEST";n[n.PERSON_ORGCHART_COMPLETED=30]="PERSON_ORGCHART_COMPLETED";n[n.PERSON_ORGCHART_ERROR=31]="PERSON_ORGCHART_ERROR";n[n.SET_ORGCHART_PAGE_INDEX=32]="SET_ORGCHART_PAGE_INDEX";n[n.SET_ORGCHART_WRAP_DIRECT_META=33]="SET_ORGCHART_WRAP_DIRECT_META";n[n.PERSON_GROUP_REQUEST=34]="PERSON_GROUP_REQUEST";n[n.PERSON_GROUP_COMPLETED=35]="PERSON_GROUP_COMPLETED";n[n.PERSON_GROUP_ERROR=36]="PERSON_GROUP_ERROR";n[n.PERSON_FLOORPLAN_REQUEST=37]="PERSON_FLOORPLAN_REQUEST";n[n.PERSON_FLOORPLAN_COMPLETED=38]="PERSON_FLOORPLAN_COMPLETED";n[n.PERSON_FLOORPLAN_ROOM_COMPLETED=39]="PERSON_FLOORPLAN_ROOM_COMPLETED";n[n.PERSON_FLOORPLAN_ERROR=40]="PERSON_FLOORPLAN_ERROR";n[n.SET_PERSON_PIVOT=41]="SET_PERSON_PIVOT";n[n.SHOW_PERSON_DISAMBIG=42]="SHOW_PERSON_DISAMBIG";n[n.SHOW_HERO_PERSON=43]="SHOW_HERO_PERSON";n[n.DOCUMENTS_REQUEST=44]="DOCUMENTS_REQUEST";n[n.DOCUMENTS_COMPLETED=45]="DOCUMENTS_COMPLETED";n[n.DOCUMENTS_ERROR=46]="DOCUMENTS_ERROR";n[n.ALL_DOCUMENTS_REQUEST=47]="ALL_DOCUMENTS_REQUEST";n[n.ALL_DOCUMENTS_COMPLETED=48]="ALL_DOCUMENTS_COMPLETED";n[n.ALL_DOCUMENTS_ERROR=49]="ALL_DOCUMENTS_ERROR";n[n.SET_DOCUMENTS_PIVOT=50]="SET_DOCUMENTS_PIVOT";n[n.BOOKMARKS_REQUEST=51]="BOOKMARKS_REQUEST";n[n.BOOKMARKS_COMPLETED=52]="BOOKMARKS_COMPLETED";n[n.BOOKMARKS_ERROR=53]="BOOKMARKS_ERROR";n[n.GROUP_REQUEST=54]="GROUP_REQUEST";n[n.GROUP_COMPLETED=55]="GROUP_COMPLETED";n[n.GROUP_ERROR=56]="GROUP_ERROR";n[n.GROUP_MEMBERS_REQUEST=57]="GROUP_MEMBERS_REQUEST";n[n.GROUP_MEMBERS_COMPLETED=58]="GROUP_MEMBERS_COMPLETED";n[n.GROUP_MEMBERS_ERROR=59]="GROUP_MEMBERS_ERROR";n[n.GROUP_CONVERSATIONS_REQUEST=60]="GROUP_CONVERSATIONS_REQUEST";n[n.GROUP_CONVERSATIONS_COMPLETED=61]="GROUP_CONVERSATIONS_COMPLETED";n[n.GROUP_CONVERSATIONS_ERROR=62]="GROUP_CONVERSATIONS_ERROR";n[n.GROUP_FILES_REQUEST=63]="GROUP_FILES_REQUEST";n[n.GROUP_FILES_COMPLETED=64]="GROUP_FILES_COMPLETED";n[n.GROUP_FILES_ERROR=65]="GROUP_FILES_ERROR";n[n.GROUP_DETAILS_REQUEST=66]="GROUP_DETAILS_REQUEST";n[n.GROUP_DETAILS_COMPLETED=67]="GROUP_DETAILS_COMPLETED";n[n.GROUP_DETAILS_ERROR=68]="GROUP_DETAILS_ERROR";n[n.SET_GROUP_PIVOT=69]="SET_GROUP_PIVOT";n[n.SET_HERO_GROUP_ID=70]="SET_HERO_GROUP_ID";n[n.SHOW_GROUP_DISAMBIG=71]="SHOW_GROUP_DISAMBIG";n[n.SHOW_HERO_GROUP=72]="SHOW_HERO_GROUP";n[n.BUILDING_REQUEST=73]="BUILDING_REQUEST";n[n.BUILDING_COMPLETED=74]="BUILDING_COMPLETED";n[n.BUILDING_ERROR=75]="BUILDING_ERROR";n[n.SET_BUILDING_DIRECTION_FROM=76]="SET_BUILDING_DIRECTION_FROM";n[n.SET_BUILDING_DIRECTION_TO=77]="SET_BUILDING_DIRECTION_TO";n[n.SET_BUILDING_MAP_WIDTH=78]="SET_BUILDING_MAP_WIDTH";n[n.SWAP_BUILDING_DIRECTION=79]="SWAP_BUILDING_DIRECTION";n[n.BUILDING_FLOORPLAN_REQUEST=80]="BUILDING_FLOORPLAN_REQUEST";n[n.BUILDING_FLOORPLAN_COMPLETED=81]="BUILDING_FLOORPLAN_COMPLETED";n[n.BUILDING_FLOORPLAN_ROOM_COMPLETED=82]="BUILDING_FLOORPLAN_ROOM_COMPLETED";n[n.BUILDING_FLOORPLAN_ERROR=83]="BUILDING_FLOORPLAN_ERROR";n[n.PERSON_PHOTO_DOWNLOADED=84]="PERSON_PHOTO_DOWNLOADED";n[n.GROUP_PHOTO_DOWNLOAD=85]="GROUP_PHOTO_DOWNLOAD";n[n.SET_RANKING=86]="SET_RANKING";n[n.SET_COMMAND=87]="SET_COMMAND";n[n.SET_ANSWER_DATA=88]="SET_ANSWER_DATA";n[n.LOAD_DEPENDENCY=89]="LOAD_DEPENDENCY";n[n.LOAD_DEPENDENCY_REQUEST=90]="LOAD_DEPENDENCY_REQUEST";n[n.LOAD_DEPENDENCY_COMPLETED=91]="LOAD_DEPENDENCY_COMPLETED";n[n.SET_QUERY_INTENT_INFO=92]="SET_QUERY_INTENT_INFO";n[n.AAD_TOKEN_REQUEST=93]="AAD_TOKEN_REQUEST";n[n.AAD_TOKEN_COMPLETED=94]="AAD_TOKEN_COMPLETED";n[n.AAD_TOKEN_ERROR=95]="AAD_TOKEN_ERROR";n[n.SET_NOTE_LINK_VISIBILITY=96]="SET_NOTE_LINK_VISIBILITY";n[n.SET_NOTE_VISIBILITY=97]="SET_NOTE_VISIBILITY";n[n.SET_ONLINE_PRESENCE=98]="SET_ONLINE_PRESENCE";n[n.SET_NON_WORK_RESULTS_VEIL_VISIBILITY=99]="SET_NON_WORK_RESULTS_VEIL_VISIBILITY";n[n.CANCEL_NON_WORK_RESULTS_VEIL=100]="CANCEL_NON_WORK_RESULTS_VEIL";n[n.REFQNA_COMPLETED=101]="REFQNA_COMPLETED";n[n.POWERBI_REQUEST=102]="POWERBI_REQUEST";n[n.POWERBI_COMPLETED=103]="POWERBI_COMPLETED";n[n.POWERBI_ERROR=104]="POWERBI_ERROR";n[n.SET_MAINLINE_FOOTER_ADDITIONAL_CONTENT_WIDTH=105]="SET_MAINLINE_FOOTER_ADDITIONAL_CONTENT_WIDTH";n[n.CALENDAR_REQUEST=106]="CALENDAR_REQUEST";n[n.CALENDAR_COMPLETED=107]="CALENDAR_COMPLETED";n[n.CALENDAR_ERROR=108]="CALENDAR_ERROR"})(t=n.ActionType||(n.ActionType={}))})(t=n.Actions||(n.Actions={}))})(n||(n={})),function(n){var t;(function(t){var i=function(){return{type:t.ActionType[t.ActionType.AAD_TOKEN_REQUEST]}},r=function(n){return{type:t.ActionType[t.ActionType.AAD_TOKEN_COMPLETED],token:n}},u=function(n){return{type:t.ActionType[t.ActionType.AAD_TOKEN_ERROR],error:n}},f=function(){return function(t){t(i());var f=sj_gx();f.open("POST","/orgid/accesstoken?endpoint=aadgraph",!0);f.onreadystatechange=function(){f.readyState===4&&(f.status===200?t(r(f.responseText||"")):t(u(n.ErrorReason.Other)))};f.send()}};t.aadActionCreators={getAadToken:f,aadTokenRequest:i,aadTokenCompleted:r,aadTokenError:u}})(t=n.Actions||(n.Actions={}))}(n||(n={})),function(n){var t;(function(n){var t=function(t,i,r,u){return{type:n.ActionType[n.ActionType.SEARCH_PEOPLE_INPLACE],fullName:t,upn:i,objectId:r,expectedIntent:u}},i=function(t){return{type:n.ActionType[n.ActionType.SET_INPLACE_SEARCH_INTENT],expectedIntent:t}},r=function(){return{type:n.ActionType[n.ActionType.PEOPLE_REQUEST]}},u=function(t,i){return{type:n.ActionType[n.ActionType.PEOPLE_COMPLETED],heroPerson:t,all:i,heroPersonId:t!=null?t.ObjectId:null}},f=function(t){return{type:n.ActionType[n.ActionType.PEOPLE_ERROR],error:t}},e=function(t){return{type:n.ActionType[n.ActionType.SET_HERO_PERSON_ID],heroPersonId:t}},o=function(t){return{type:n.ActionType[n.ActionType.PERSON_DOCUMENTS_REQUEST],personId:t}},s=function(t,i){return{type:n.ActionType[n.ActionType.PERSON_DOCUMENTS_COMPLETED],files:i,personId:t}},h=function(t,i){return{type:n.ActionType[n.ActionType.PERSON_DOCUMENTS_ERROR],error:i,personId:t}},c=function(t){return{type:n.ActionType[n.ActionType.PERSON_ORGCHART_REQUEST],personId:t}},l=function(t,i,r,u,f){return{type:n.ActionType[n.ActionType.PERSON_ORGCHART_COMPLETED],directs:i,managers:r,peers:u,personId:t,sortDirectReportsByOrgCount:f}},a=function(t,i){return{type:n.ActionType[n.ActionType.PERSON_ORGCHART_ERROR],error:i,personId:t}},v=function(t){return{type:n.ActionType[n.ActionType.SET_ORGCHART_PAGE_INDEX],pageIndex:t}},y=function(){return{type:n.ActionType[n.ActionType.SET_ORGCHART_WRAP_DIRECT_META]}},p=function(t){return{type:n.ActionType[n.ActionType.PERSON_GROUP_REQUEST],personId:t}},w=function(t,i){return{type:n.ActionType[n.ActionType.PERSON_GROUP_COMPLETED],groups:i,personId:t}},b=function(t,i){return{type:n.ActionType[n.ActionType.PERSON_GROUP_ERROR],error:i,personId:t}},k=function(t){return{type:n.ActionType[n.ActionType.PERSON_FLOORPLAN_REQUEST],personId:t}},d=function(t,i){return{type:n.ActionType[n.ActionType.PERSON_FLOORPLAN_COMPLETED],floorPlan:i,personId:t}},g=function(t,i){return{type:n.ActionType[n.ActionType.PERSON_FLOORPLAN_ROOM_COMPLETED],roomInfo:i,personId:t}},nt=function(t,i){return{type:n.ActionType[n.ActionType.PERSON_FLOORPLAN_ERROR],error:i,personId:t}},tt=function(t){return{type:n.ActionType[n.ActionType.CALENDAR_REQUEST],personId:t}},it=function(t,i,r,u){return{type:n.ActionType[n.ActionType.CALENDAR_COMPLETED],personId:t,personAvailability:i,userAvailability:r,events:u}},rt=function(t,i){return{type:n.ActionType[n.ActionType.CALENDAR_ERROR],personId:t,error:i}},ut=function(t){return{type:n.ActionType[n.ActionType.SET_PERSON_PIVOT],pivot:t}},ft=function(){return{type:n.ActionType[n.ActionType.SHOW_PERSON_DISAMBIG]}},et=function(){return{type:n.ActionType[n.ActionType.SHOW_HERO_PERSON]}};n.peopleActionCreators={searchPeopleInplace:t,setInplaceSearchIntent:i,peopleRequest:r,peopleCompleted:u,peopleError:f,setHeroPersonId:e,showHeroPerson:et,showPersonDisambig:ft,personDocumentsRequest:o,personDocumentsCompleted:s,personDocumentsError:h,personOrgChartRequest:c,personOrgChartCompleted:l,personOrgChartError:a,setOrgChartPageIndex:v,setOrgChartWrapDirectMeta:y,personGroupRequest:p,personGroupCompleted:w,personGroupError:b,personFloorPlanRequest:k,personFloorPlanCompleted:d,personFloorPlanRoomCompleted:g,personFloorPlanError:nt,calendarRequest:tt,calendarCompleted:it,calendarError:rt,setPersonPivot:ut}})(t=n.Actions||(n.Actions={}))}(n||(n={})),function(n){var t;(function(n){var t=function(){return{type:n.ActionType[n.ActionType.DOCUMENTS_REQUEST]}},i=function(t){return{type:n.ActionType[n.ActionType.DOCUMENTS_COMPLETED],files:t==null?null:t.files,personName:t==null?null:t.personName,keyword:t==null?null:t.keyword,userInfo:t==null?null:t.userInfo}},r=function(t){return{type:n.ActionType[n.ActionType.DOCUMENTS_ERROR],error:t}},u=function(){return{type:n.ActionType[n.ActionType.ALL_DOCUMENTS_REQUEST]}},f=function(t){return{type:n.ActionType[n.ActionType.ALL_DOCUMENTS_COMPLETED],files:t}},e=function(t){return{type:n.ActionType[n.ActionType.ALL_DOCUMENTS_ERROR],error:t}},o=function(t){return{type:n.ActionType[n.ActionType.SET_DOCUMENTS_PIVOT],pivot:t}};n.documentActionCreators={documentsRequest:t,documentsCompleted:i,documentsError:r,allDocumentsRequest:u,allDocumentsCompleted:f,allDocumentsError:e,setDocumentsPivot:o}})(t=n.Actions||(n.Actions={}))}(n||(n={})),function(n){var t;(function(n){var t=function(){return{type:n.ActionType[n.ActionType.GROUP_REQUEST]}},i=function(t){return{type:n.ActionType[n.ActionType.GROUP_COMPLETED],groups:t}},r=function(t){return{type:n.ActionType[n.ActionType.GROUP_ERROR],error:t}},u=function(t){return{type:n.ActionType[n.ActionType.GROUP_MEMBERS_REQUEST],groupId:t}},f=function(t,i){return{type:n.ActionType[n.ActionType.GROUP_MEMBERS_COMPLETED],groupMembers:i,groupId:t}},e=function(t,i){return{type:n.ActionType[n.ActionType.GROUP_MEMBERS_ERROR],error:i,groupId:t}},o=function(t){return{type:n.ActionType[n.ActionType.GROUP_CONVERSATIONS_REQUEST],groupId:t}},s=function(t,i){return{type:n.ActionType[n.ActionType.GROUP_CONVERSATIONS_COMPLETED],groupConversations:i,groupId:t}},h=function(t,i){return{type:n.ActionType[n.ActionType.GROUP_CONVERSATIONS_ERROR],error:i,groupId:t}},c=function(t){return{type:n.ActionType[n.ActionType.GROUP_FILES_REQUEST],groupId:t}},l=function(t,i){return{type:n.ActionType[n.ActionType.GROUP_FILES_COMPLETED],groupFiles:i,groupId:t}},a=function(t,i){return{type:n.ActionType[n.ActionType.GROUP_FILES_ERROR],error:i,groupId:t}},v=function(t){return{type:n.ActionType[n.ActionType.GROUP_DETAILS_REQUEST],personId:t}},y=function(t,i){return{type:n.ActionType[n.ActionType.GROUP_DETAILS_COMPLETED],groupDetails:i,groupId:t}},p=function(t,i){return{type:n.ActionType[n.ActionType.GROUP_DETAILS_ERROR],error:i,groupId:t}},w=function(t){return{type:n.ActionType[n.ActionType.SET_GROUP_PIVOT],pivot:t}},b=function(t){return{type:n.ActionType[n.ActionType.SET_HERO_GROUP_ID],heroGroupId:t}},k=function(){return{type:n.ActionType[n.ActionType.SHOW_GROUP_DISAMBIG]}},d=function(){return{type:n.ActionType[n.ActionType.SHOW_HERO_GROUP]}};n.groupActionCreators={groupRequest:t,groupCompleted:i,groupError:r,groupMembersRequest:u,groupMembersCompleted:f,groupMembersError:e,groupConversationsRequest:o,groupConversationsCompleted:s,groupConversationsError:h,groupFilesRequest:c,groupFilesCompleted:l,groupFilesError:a,groupDetailsRequest:v,groupDetailsCompleted:y,groupDetailsError:p,setGroupPivot:w,setHeroGroupId:b,showGroupDisambig:k,showHeroGroup:d}})(t=n.Actions||(n.Actions={}))}(n||(n={})),function(n){var t;(function(n){var t=function(t){return{type:n.ActionType[n.ActionType.SET_MAINLINE_ANSWER_ORG_SKIP_VISIBILITY],isOrgChartSkipManagersVisible:t}},i=function(t){return{type:n.ActionType[n.ActionType.SET_MAINLINE_ANSWER_ORG_EXPAND_HOVER_VISIBILITY],isOrgChartExpanderHoverVisible:t}},r=function(t){return{type:n.ActionType[n.ActionType.SET_MAINLINE_ANSWER_NOTIFICATION_VISIBILITY],isNotificationVisible:t}},u=function(t){return{type:n.ActionType[n.ActionType.SET_MAINLINE_FOOTER_ADDITIONAL_CONTENT_WIDTH],footerAdditionalContentWidth:t}};n.mainlineAnswerActionCreators={setMainlineAnswerNotificationVisibility:r,setMainlineAnswerOrgChartSkipManagersVisibility:t,setMainlineAnswerOrgChartExpanderHoverVisibility:i,setMainlineFooterAdditionalContentWidth:u}})(t=n.Actions||(n.Actions={}))}(n||(n={})),function(n){var t;(function(n){var t=function(t,i){return{type:n.ActionType[n.ActionType.EXPAND_INLINE_ANSWER_PEOPLE],isPeopleExpanded:t,scrollToElementId:i}},i=function(t,i){return{type:n.ActionType[n.ActionType.EXPAND_INLINE_ANSWER_PEOPLE_ORGCHART],isPeopleOrgChartExpanded:t,scrollToElementId:i}},r=function(t){return{type:n.ActionType[n.ActionType.EXPAND_INLINE_ANSWER_DISAMBIG],isDisambigExpanded:t}};n.inlineAnswerActionCreators={expandInlineAnswerPeople:t,expandInlineAnswerPeopleOrgChart:i,expandInlineAnswerDisambig:r}})(t=n.Actions||(n.Actions={}))}(n||(n={})),function(n){var t;(function(n){var t=function(){return{type:n.ActionType[n.ActionType.OPEN_GLEAM]}},i=function(){return{type:n.ActionType[n.ActionType.CLOSE_GLEAM]}},r=function(){return{type:n.ActionType[n.ActionType.TOGGLE_GLEAM]}},u=function(t){return{type:n.ActionType[n.ActionType.SET_SEARCH_SCENARIO],gleamOption:t}},f=function(t){return{type:n.ActionType[n.ActionType.SET_APP_ROUTER_STATUS],status:t}},e=function(t){return{type:n.ActionType[n.ActionType.SET_QUERY_INTENT_INFO],intent:t}},o=function(t){return{type:n.ActionType[n.ActionType.SET_CONFIGURATION],cfg:t}},s=function(t){return{type:n.ActionType[n.ActionType.ROUTE_SEARCH_RESPONSE],rankingContext:t}},h=function(t){return{type:n.ActionType[n.ActionType.SET_GLEAM_OPTION],gleamOption:t}},c=function(t){return{type:n.ActionType[n.ActionType.SET_GLEAM_DROP_OPTION],gleamOption:t}},l=function(t){return{type:n.ActionType[n.ActionType.CREATE_OR_UPDATE_USER_INFO],userInfo:t}},a=function(){return{type:n.ActionType[n.ActionType.QUERY_GENERIC_REQUEST]}},v=function(){return{type:n.ActionType[n.ActionType.BOOKMARKS_REQUEST]}},y=function(t){return{type:n.ActionType[n.ActionType.BOOKMARKS_COMPLETED],task:t}},p=function(t){return{type:n.ActionType[n.ActionType.BOOKMARKS_ERROR],error:t}},w=function(){return{type:n.ActionType[n.ActionType.BUILDING_REQUEST]}},b=function(t){return{type:n.ActionType[n.ActionType.BUILDING_COMPLETED],building:t}},k=function(t){return{type:n.ActionType[n.ActionType.BUILDING_ERROR],error:t}},d=function(t){return{type:n.ActionType[n.ActionType.SET_BUILDING_DIRECTION_FROM],directionFrom:t}},g=function(t){return{type:n.ActionType[n.ActionType.SET_BUILDING_DIRECTION_TO],directionTo:t}},nt=function(t){return{type:n.ActionType[n.ActionType.SET_BUILDING_MAP_WIDTH],mapWidth:t}},tt=function(){return{type:n.ActionType[n.ActionType.SWAP_BUILDING_DIRECTION]}},it=function(t){return{type:n.ActionType[n.ActionType.BUILDING_FLOORPLAN_REQUEST],buildingName:t}},rt=function(t,i){return{type:n.ActionType[n.ActionType.BUILDING_FLOORPLAN_COMPLETED],floorPlan:i,buildingName:t}},ut=function(t,i){return{type:n.ActionType[n.ActionType.BUILDING_FLOORPLAN_ROOM_COMPLETED],roomInfo:i,buildingName:t}},ft=function(t,i){return{type:n.ActionType[n.ActionType.BUILDING_FLOORPLAN_ERROR],error:i,buildingName:t}},et=function(t,i){return{type:n.ActionType[n.ActionType.PERSON_PHOTO_DOWNLOADED],email:t,base64Image:i}},ot=function(t,i){return{type:n.ActionType[n.ActionType.GROUP_PHOTO_DOWNLOAD],groupId:t,base64Image:i}},st=function(t){return{type:n.ActionType[n.ActionType.SET_RANKING],ranking:t}},ht=function(t){return{type:n.ActionType[n.ActionType.SET_COMMAND],command:t}},ct=function(t){return{type:n.ActionType[n.ActionType.SET_ANSWER_DATA],answerData:t}},lt=function(t){return{type:n.ActionType[n.ActionType.LOAD_DEPENDENCY],dependency:t}},at=function(t){return{type:n.ActionType[n.ActionType.LOAD_DEPENDENCY_REQUEST],dependency:t}},vt=function(t){return{type:n.ActionType[n.ActionType.LOAD_DEPENDENCY_COMPLETED],dependency:t}},yt=function(t,i){return{type:n.ActionType[n.ActionType.SET_ONLINE_PRESENCE],email:t,presence:i}},pt=function(t){return{type:n.ActionType[n.ActionType.SET_NON_WORK_RESULTS_VEIL_VISIBILITY],isVisible:t}},wt=function(){return{type:n.ActionType[n.ActionType.CANCEL_NON_WORK_RESULTS_VEIL]}},bt=function(t){return{type:n.ActionType[n.ActionType.REFQNA_COMPLETED],refQna:t}},kt=function(){return{type:n.ActionType[n.ActionType.POWERBI_REQUEST]}},dt=function(t){return{type:n.ActionType[n.ActionType.POWERBI_COMPLETED],cards:t}},gt=function(t){return{type:n.ActionType[n.ActionType.POWERBI_ERROR],error:t}},ni=function(t){return{type:n.ActionType[n.ActionType.SET_CONTAINERS_ATTACHED],attachedContainers:t}},ti={setSearchScenario:u,setAppRouterStatus:f,setQueryIntentInfo:e,setConfiguration:o,setGleamOption:h,setGleamDropOption:c,routeSearchResponse:s,openGleam:t,closeGleam:i,toggleGleam:r,createOrUpdateUserInfo:l,queryGenericRequest:a,bookmarksRequest:v,bookmarksCompleted:y,bookmarksError:p,refQnaCompleted:bt,buildingRequest:w,buildingCompleted:b,buildingError:k,setBuildingDirectionFrom:d,setBuildingDirectionTo:g,setBuildingMapWidth:nt,swapBuildingDirection:tt,buildingFloorPlanRequest:it,buildingFloorPlanCompleted:rt,buildingFloorPlanRoomCompleted:ut,buildingFloorPlanError:ft,personPhotoDownloaded:et,groupPhotoDownloaded:ot,setRanking:st,setCommand:ht,setAnswerData:ct,loadDependency:lt,loadDependencyRequest:at,loadDependencyCompleted:vt,setOnlinePresence:yt,setNonWorkResultsVeilVisibility:pt,cancelNonWorkResultsVeil:wt,setContainersAttached:ni,powerBiRequest:kt,powerBiCompleted:dt,powerBiError:gt};n.actionCreators=Object.assign({},ti,n.mainlineAnswerActionCreators,n.inlineAnswerActionCreators,n.aadActionCreators,n.peopleActionCreators,n.documentActionCreators,n.groupActionCreators)})(t=n.Actions||(n.Actions={}))}(n||(n={})),function(n){var t;(function(n){n.actionListenerMiddleware=function(t){return function(){return function(i){return function(r){var s,h,c,e,u,y,k,d,g,nt;switch(r.type){case n.ActionType[n.ActionType.OPEN_GLEAM]:t.onOpenGleamExecuting();break;case n.ActionType[n.ActionType.SEARCH_PEOPLE_INPLACE]:var o=r,tt=o.fullName,it=o.upn;t.onSearchPeopleInplaceExecuting(tt,it)}s=i(r);switch(r.type){case n.ActionType[n.ActionType.SET_GLEAM_OPTION]:h=r.gleamOption;t.onSetGleamOptionExecuted(h);break;case n.ActionType[n.ActionType.GROUP_COMPLETED]:u=r.groups;c=u!=null&&u.length>0?u[0].Id:null;t.onGroupCompletedExecuted(c);break;case n.ActionType[n.ActionType.PEOPLE_COMPLETED]:var l=r,a=l.all,v=l.heroPerson,rt=a!=null?a:v!=null?[v]:null;t.onPeopleCompletedExecuted(rt);break;case n.ActionType[n.ActionType.PERSON_ORGCHART_COMPLETED]:var f=r,e=f.personId,ut=f.directs,ft=f.managers,et=f.peers;t.onPersonOrgChartCompletedExecuted(e,ut,ft,et);break;case n.ActionType[n.ActionType.PERSON_GROUP_COMPLETED]:e=r.personId;u=r.groups;t.onPersonGroupCompletedExecuted(e,u);break;case n.ActionType[n.ActionType.SHOW_PERSON_DISAMBIG]:t.onShowPersonDisambigExecuted();break;case n.ActionType[n.ActionType.SHOW_HERO_PERSON]:t.onShowHeroPersonExecuted();break;case n.ActionType[n.ActionType.SHOW_GROUP_DISAMBIG]:t.onShowGroupDisambigExecuted();break;case n.ActionType[n.ActionType.SHOW_HERO_GROUP]:t.onShowHeroGroupExecuted();break;case n.ActionType[n.ActionType.LOAD_DEPENDENCY]:y=r.dependency;t.onLoadDependencyExecuted(y);break;case n.ActionType[n.ActionType.EXPAND_INLINE_ANSWER_PEOPLE]:var p=r,ot=p.isPeopleExpanded,w=p.scrollToElementId;t.onExpandInlineAnswerPeopleExecuted(ot,w);break;case n.ActionType[n.ActionType.EXPAND_INLINE_ANSWER_PEOPLE_ORGCHART]:var b=r,st=b.isPeopleOrgChartExpanded,w=b.scrollToElementId;t.onExpandInlineAnswerPeopleOrgChartExecuted(st,w);break;case n.ActionType[n.ActionType.EXPAND_INLINE_ANSWER_DISAMBIG]:k=r.isDisambigExpanded;t.onExpandInlineAnswerDisambigExecuted(k);break;case n.ActionType[n.ActionType.SET_RANKING]:d=r.ranking;t.onSetRankingExecuted(d);break;case n.ActionType[n.ActionType.SET_COMMAND]:g=r.command;t.onSetCommand(g);break;case n.ActionType[n.ActionType.SET_ANSWER_DATA]:t.onSetAnswerData(r.answerData);break;case n.ActionType[n.ActionType.BUILDING_COMPLETED]:nt=r.building;t.onBuildingCompletedExecuted(nt)}return s}}}}})(t=n.Actions||(n.Actions={}))}(n||(n={})),function(n){var t;(function(t){var i;(function(t){var i=n.Actions.ActionType;t.reducer=function(n,t){return(n===void 0&&(n={token:null}),t.type===i[i.AAD_TOKEN_COMPLETED])?Object.assign({},n,{token:t.token}):n}})(i=t.Aad||(t.Aad={}))})(t=n.Reducers||(n.Reducers={}))}(n||(n={})),function(n){var t;(function(t){var i;(function(t){var i=n.Actions.ActionType;t.initialState=null;t.reducer=function(n,r){n===void 0&&(n=t.initialState);switch(r.type){case i[i.SET_CONFIGURATION]:return Object.assign({},r.cfg);default:return n}}})(i=t.Configuration||(t.Configuration={}))})(t=n.Reducers||(n.Reducers={}))}(n||(n={})),function(n){var t;(function(t){var i;(function(i){function u(n){return n.appRouter.status}function f(n){return n.appRouter.ranking}function e(n,t){var i=n.attachedContainers;return i==null?!1:i.some(function(n){return n.definition.placement===t})}function o(n,t){var i=n.rank(t);return i!=null&&(h(i),r(i)),i}function s(i,r){var u=i.rankingContext.response,o,s,h,c,e,l,a,f;switch(u.scenario){case n.BfbResponseScenario.Person:return o=u,o.heroPerson==null?n.ProcessingStatus.NoResults:null;case n.BfbResponseScenario.Task:return s=u,s.task==null?n.ProcessingStatus.NoResults:null;case n.BfbResponseScenario.Document:return h=u,h.files==null?n.ProcessingStatus.NoResults:null;case n.BfbResponseScenario.Groups:return c=u,e=t.Group.getValidGroups(c.groups),e==null||e.length===0?n.ProcessingStatus.NoResults:null;case n.BfbResponseScenario.Buildings:return l=u,l.building==null?n.ProcessingStatus.NoResults:null;case n.BfbResponseScenario.RefQna:return a=u,!r.ft.qna.e||a.refQna==null?n.ProcessingStatus.NoResults:null;case n.BfbResponseScenario.PowerBi:return f=u,!r.ft.powerbi.e||f.cards==null||f.cards.Interpretations==null||f.cards.Interpretations.length==0?n.ProcessingStatus.NoResults:null;default:throw new Error("Render of "+u.scenario+" is not yet implemented");}}function h(n){var t=n.placement+","+n.treatment+","+n.rankingRuleId;bfbInst.sLog("ACJ",t);bfbTel.logRanking(n)}function r(t){t!=null&&t.placement!==n.AnswerPlacement.None&&bfbInst.sLog("Expand")}i.initialState={status:n.ProcessingStatus.Started};i.reducer=function(t,u){return function(f,e){f===void 0&&(f=i.initialState);switch(e.type){case n.Actions.ActionType[n.Actions.ActionType.SET_APP_ROUTER_STATUS]:return Object.assign({},f,{status:e.status});case n.Actions.ActionType[n.Actions.ActionType.ROUTE_SEARCH_RESPONSE]:var h=f.ranking,c=h!=null&&h.rankingRuleId===n.RankingRuleId.UserExplicit?h:o(u,e.rankingContext);return Object.assign({},f,{status:e.rankingContext.response?s(e,t):f.status,ranking:c==null?f.ranking:c});case n.Actions.ActionType[n.Actions.ActionType.SET_RANKING]:return r(e.ranking),Object.assign({},f,{status:f.status,ranking:e.ranking});case n.Actions.ActionType[n.Actions.ActionType.SET_CONTAINERS_ATTACHED]:return Object.assign({},f,{attachedContainers:e.attachedContainers});default:return f}}};i.getStatus=u;i.getRanking=f;i.isContainerAttached=e})(i=t.AppRouter||(t.AppRouter={}))})(t=n.Reducers||(n.Reducers={}))}(n||(n={})),function(n){var t;(function(t){var i;(function(i){function u(i,r){var f=i.rankingContext.response,u=f.command,s,e,o;switch(f.scenario){case n.BfbResponseScenario.Person:if(s=f,s.heroPerson!=null&&(r.intent==null||r.intent===n.QueryIntent.None)&&u!=null&&u.queryIntent!=null&&u.queryIntent!==n.QueryIntent.None)return u.queryIntent;case n.BfbResponseScenario.Groups:if(e=f,o=t.Group.getValidGroups(e==null?null:e.groups),o!=null&&o.length!==0)return u!=null?u.queryIntent:null}return r==null?null:r.intent}function f(t){if(t==null)return null;var i={};return i.encryptedQuery=t.EncryptedQuery,t.QueryStats!=null&&(i.queryCount=t.QueryStats.QueryFrequency),i.queryFrequency=t.QueryConfidence,i.webIntentConf=t.WebIntentConfidence,t.QueryBehavior!=n.QueryBehavior.None&&(i.bhvr=t.QueryBehavior),i}function e(n){return n.qrynf}var r=n.Actions.ActionType;i.reducer=function(t,i){var e,o;t===void 0&&(t=null);switch(i.type){case r[r.SET_GLEAM_OPTION]:return Object.assign({},t,{intent:n.QueryIntent.None});case r[r.SET_QUERY_INTENT_INFO]:return e=i,Object.assign({},t,{intent:e.intent});case r[r.SEARCH_PEOPLE_INPLACE]:return e=i,Object.assign({},t,{qry:e.fullName,intent:e.expectedIntent});case r[r.SET_INPLACE_SEARCH_INTENT]:return e=i,Object.assign({},t,{intent:e.expectedIntent});case n.Actions.ActionType[n.Actions.ActionType.ROUTE_SEARCH_RESPONSE]:return i.rankingContext.response==null?t:Object.assign({},t,{intent:u(i,t)});case n.Actions.ActionType[n.Actions.ActionType.SET_ANSWER_DATA]:return(o=f(i.answerData),o==null)?t:Object.assign({},t,o);default:return t}};i.getQueryInfo=e})(i=t.QueryInfo||(t.QueryInfo={}))})(t=n.Reducers||(n.Reducers={}))}(n||(n={})),function(n){var t;(function(t){var i;(function(t){var i=n.Actions.ActionType;t.reducer=function(n,t){n===void 0&&(n=null);switch(t.type){case i[i.BOOKMARKS_REQUEST]:return Object.assign({},n,{data:null,isLoading:!0,error:null});case i[i.BOOKMARKS_COMPLETED]:return Object.assign({},n,{data:t.task,isLoading:!1,error:null});case i[i.BOOKMARKS_ERROR]:return Object.assign({},n,{data:null,isLoading:!1,error:t.error});default:return n}}})(i=t.Bookmarks||(t.Bookmarks={}))})(t=n.Reducers||(n.Reducers={}))}(n||(n={})),function(n){var t;(function(t){var i;(function(t){var i=n.Actions.ActionType,r=null;t.reducer=function(n,t){n===void 0&&(n=r);switch(t.type){case i[i.REFQNA_COMPLETED]:return Object.assign({},n,t.refQna);default:return n}}})(i=t.RefQna||(t.RefQna={}))})(t=n.Reducers||(n.Reducers={}))}(n||(n={})),function(n){var t;(function(t){var i;(function(t){function r(n){return n.building}var i=n.Actions.ActionType;t.reducer=function(n,t){var r,f,e,u,o;n===void 0&&(n={data:null,isLoading:!1,error:null,directionFrom:"",directionTo:"",mapWidth:0});switch(t.type){case i[i.BUILDING_REQUEST]:return Object.assign({},n,{data:null,isLoading:!0,error:null,floorPlan:null});case i[i.BUILDING_COMPLETED]:return Object.assign({},n,{data:t.building,isLoading:!1,error:null});case i[i.BUILDING_ERROR]:return Object.assign({},n,{data:null,isLoading:!1,error:t.error,floorPlan:null});case i[i.SET_BUILDING_DIRECTION_TO]:return Object.assign({},n,{directionTo:t.directionTo});case i[i.SET_BUILDING_DIRECTION_FROM]:return Object.assign({},n,{directionFrom:t.directionFrom});case i[i.SET_BUILDING_MAP_WIDTH]:return Object.assign({},n,{mapWidth:t.mapWidth});case i[i.SWAP_BUILDING_DIRECTION]:return Object.assign({},n,{directionFrom:n.directionTo,directionTo:n.directionFrom});case i[i.BUILDING_FLOORPLAN_REQUEST]:return Object.assign({},n,{floorPlan:{isLoading:!0,data:null,error:null}});case i[i.BUILDING_FLOORPLAN_ROOM_COMPLETED]:return(r=t,n.data==null||r.buildingName!=n.data.Name)?n:(f=Object.assign({},n.floorPlan&&n.floorPlan.data,{roomInfo:r.roomInfo}),e=Object.assign({},n.floorPlan,{isLoading:!0,data:f}),Object.assign({},n,{floorPlan:e}));case i[i.BUILDING_FLOORPLAN_COMPLETED]:return(u=t,n.data==null||u.buildingName!=n.data.Name)?n:Object.assign({},n,{floorPlan:{isLoading:!1,data:Object.assign({},n.floorPlan&&n.floorPlan.data,{floorPlan:u.floorPlan}),error:null}});case i[i.BUILDING_FLOORPLAN_ERROR]:return(o=t,n.data==null||o.buildingName!=n.data.Name)?n:Object.assign({},n,{floorPlan:{isLoading:!1,data:null,error:t.error}});default:return n}};t.getBuildingState=r})(i=t.Building||(t.Building={}))})(t=n.Reducers||(n.Reducers={}))}(n||(n={})),function(n){var t;(function(t){var i;(function(t){var i=n.Actions.ActionType;t.reducer=function(n,t){n===void 0&&(n={isEnabled:!1});switch(t.type){case i[i.QUERY_GENERIC_REQUEST]:case i[i.PEOPLE_REQUEST]:case i[i.DOCUMENTS_REQUEST]:case i[i.BOOKMARKS_REQUEST]:case i[i.GROUP_REQUEST]:case i[i.BUILDING_REQUEST]:return Object.assign({},n,{isEnabled:!1});case i[i.PEOPLE_COMPLETED]:case i[i.DOCUMENTS_COMPLETED]:case i[i.BOOKMARKS_COMPLETED]:case i[i.GROUP_COMPLETED]:case i[i.BUILDING_COMPLETED]:case i[i.REFQNA_COMPLETED]:return Object.assign({},n,{isEnabled:!0});default:return n}}})(i=t.Disclaimer||(t.Disclaimer={}))})(t=n.Reducers||(n.Reducers={}))}(n||(n={})),function(n){var t;(function(t){var i;(function(t){var i=n.Actions.ActionType;t.reducer=function(t,r){var u,f,e;t===void 0&&(t=null);switch(r.type){case i[i.QUERY_GENERIC_REQUEST]:return Object.assign({},t,{files:{isLoading:!1,data:null},allFiles:null,personName:null,keyword:null,selectedPivot:null});case i[i.DOCUMENTS_REQUEST]:return Object.assign({},t,{files:{isLoading:!0,data:null},allFiles:null,personName:null,keyword:null,selectedPivot:null});case i[i.DOCUMENTS_COMPLETED]:return u=r,Object.assign({},t,{files:{isLoading:!1,data:u.files||[]},personName:u.personName||t&&t.personName,keyword:u.keyword||t&&t.keyword});case i[i.DOCUMENTS_ERROR]:return Object.assign({},t,{files:{isLoading:!1,error:r.error}});case i[i.ALL_DOCUMENTS_REQUEST]:return Object.assign({},t,{allFiles:{isLoading:!0,data:null}});case i[i.ALL_DOCUMENTS_COMPLETED]:return f=r,e=t.selectedPivot,t.files&&t.files.data!=null&&t.files.data.length===0&&f.files&&f.files.length>0&&(e=n.DocumentSearchPivot.All),Object.assign({},t,{allFiles:{isLoading:!1,data:f.files||[]},selectedPivot:e});case i[i.ALL_DOCUMENTS_ERROR]:return Object.assign({},t,{allFiles:{isLoading:!1,error:r.error}});case i[i.SET_DOCUMENTS_PIVOT]:return Object.assign({},t,{selectedPivot:r.pivot});default:return t}}})(i=t.Documents||(t.Documents={}))})(t=n.Reducers||(n.Reducers={}))}(n||(n={})),function(n){var t;(function(t){var i;(function(t){var i=n.Actions.ActionType;t.reducer=function(n,t){n===void 0&&(n={isOpen:!1,wasOpen:!1,dropOption:null});switch(t.type){case i[i.OPEN_GLEAM]:return Object.assign({},n,{isOpen:!0,wasOpen:n.isOpen});case i[i.CLOSE_GLEAM]:return Object.assign({},n,{isOpen:!1,wasOpen:n.isOpen});case i[i.TOGGLE_GLEAM]:return Object.assign({},n,{isOpen:!n.isOpen,wasOpen:n.isOpen});case i[i.SET_SEARCH_SCENARIO]:return Object.assign({},n,{isOpen:!1,wasOpen:n.isOpen,dropOption:t.gleamOption});case i[i.SET_GLEAM_OPTION]:return Object.assign({},n,{dropOption:t.gleamOption});case i[i.SET_GLEAM_DROP_OPTION]:return Object.assign({},n,{dropOption:t.gleamOption});default:return n}}})(i=t.Gleam||(t.Gleam={}))})(t=n.Reducers||(n.Reducers={}))}(n||(n={})),function(n){var t;(function(t){var i;(function(t){function f(n){return n.group}function s(n){var t=f(n);return t!=null?t.selectedPivot:null}function u(n){var t=f(n);return t!=null?t.data:null}function h(n){var t=u(n);return t!=null?t.length:0}function e(n){var t=u(n);return t!=null&&t.length>0?t[0]:null}function c(n){var t=e(n);return t!=null?t.data:null}function r(n){var o=f(n),t,i,r;return o==null?null:(t=o.heroGroupId,t==null)?e(n):(i=u(n),i==null)?null:(r=i.filter(function(n){return n.data.Id===t}),r.length>0?r[0]:null)}function l(n){var t=r(n);return t!=null?t.data:null}function a(n){var t=f(n);return t!=null?t.heroGroupId:null}function v(n){var t=o(n);return t!=null?t.data:null}function o(n){var t=r(n);return t!=null?t.groupMembers:null}function y(n){var t=r(n);return t!=null?t.groupFiles:null}function p(n){var t=r(n);return t!=null?t.groupConversations:null}function w(n){var t=r(n);return t!=null?t.groupDetails:null}function b(n){var t=u(n);return t!=null?t.map(function(n){return n.data}):[]}function k(t,i){return i===void 0&&(i=!1),t==null?[]:t.filter(function(t){return!n.nullOrWs(t.Id)&&!n.nullOrWs(t.Mail)&&(!i||!n.nullOrWs(t.MailNickname))&&!n.nullOrWs(t.DisplayName)})}var i=n.Actions.ActionType;t.singleGroupReducer=function(n,t){n===void 0&&(n=null);switch(t.type){case i[i.GROUP_MEMBERS_REQUEST]:return Object.assign({},n,{groupMembers:{isLoading:!0,data:null}});case i[i.GROUP_MEMBERS_COMPLETED]:return Object.assign({},n,{groupMembers:{data:t.groupMembers,isLoading:!1}});case i[i.GROUP_MEMBERS_ERROR]:return Object.assign({},n,{groupMembers:{isLoading:!1,error:t.error}});case i[i.GROUP_CONVERSATIONS_REQUEST]:return Object.assign({},n,{groupConversations:{isLoading:!0,data:null}});case i[i.GROUP_CONVERSATIONS_COMPLETED]:return Object.assign({},n,{groupConversations:{data:t.groupConversations,isLoading:!1}});case i[i.GROUP_CONVERSATIONS_ERROR]:return Object.assign({},n,{groupConversations:{isLoading:!1,error:t.error}});case i[i.GROUP_FILES_REQUEST]:return Object.assign({},n,{groupFiles:{isLoading:!0,data:null}});case i[i.GROUP_FILES_COMPLETED]:return Object.assign({},n,{groupFiles:{data:t.groupFiles,isLoading:!1}});case i[i.GROUP_FILES_ERROR]:return Object.assign({},n,{groupFiles:{isLoading:!1,error:t.error}});case i[i.GROUP_DETAILS_REQUEST]:return Object.assign({},n,{groupDetails:{isLoading:!0,data:null}});case i[i.GROUP_DETAILS_COMPLETED]:return Object.assign({},n,{groupDetails:{data:t.groupDetails,isLoading:!1}});case i[i.GROUP_DETAILS_ERROR]:return Object.assign({},n,{groupDetails:{isLoading:!1,error:t.error}});default:return n}};t.reducer=function(n,r){var e,o,u,f,s;n===void 0&&(n=null);switch(r.type){case i[i.GROUP_REQUEST]:return Object.assign({},n,{data:null,isLoading:!0,error:null});case i[i.GROUP_COMPLETED]:return e=r.groups,Object.assign({},n,{heroGroupId:e.length>0?e[0].Id:null,data:e.map(function(n){return{groupId:n.Id,data:n}}),isLoading:!1,error:null});case i[i.GROUP_ERROR]:return Object.assign({},n,{data:null,isLoading:!1,error:r.error});case i[i.SET_GROUP_PIVOT]:return Object.assign({},n,{selectedPivot:r.pivot});case i[i.SET_HERO_GROUP_ID]:return Object.assign({},n,{heroGroupId:r.heroGroupId});default:if(o=r,o.groupId==null||n==null||n.data==null)return n;for(u=-1,f=0;f<n.data.length;f++)if(n.data[f].groupId===o.groupId){u=f;break}return u<0?n:(s=t.singleGroupReducer(n.data[u],r),s==null)?n:Object.assign({},n,{data:n.data.slice(0,u).concat([s],n.data.slice(u+1))})}};t.getGroupSelectedPivot=s;t.getAllSingleGroupStates=u;t.getGroupsCount=h;t.getBestMatchGroupState=e;t.getBestMatchGroup=c;t.getHeroGroupState=r;t.getHeroGroup=l;t.getHeroGroupId=a;t.getHeroGroupMembers=v;t.getAsyncHeroGroupMembers=o;t.getAsyncHeroGroupFiles=y;t.getAsyncHeroGroupConversations=p;t.getAsyncHeroGroupDetails=w;t.getAllGroups=b;t.getValidGroups=k})(i=t.Group||(t.Group={}))})(t=n.Reducers||(n.Reducers={}))}(n||(n={})),function(n){var t;(function(t){var i;(function(t){function v(t,i){var r;if(t==null)return[];if(r=function(t,i){return n.sortFunc(t.FullName,i.FullName)},i){var u=t.filter(function(n){return n.OrgCount!=null&&n.OrgCount>0}),f=t.filter(function(n){return n.OrgCount==null||n.OrgCount<1}),e=u.sort(r),o=f.sort(r);return e.concat(o)}return t.sort(r)}function r(n){return n.people}function s(n){var t=r(n);return t!=null?t.people:null}function y(n){var t=r(n);return t!=null?t.card:null}function e(n){var t=s(n);return t!=null?t.values:null}function p(n){var i=r(n),t=i.inplaceSearchExpectedIntent,u=n.qrynf.intent;return t!=null?t:u}function w(n){var t=r(n);return t!=null?t.selectedPivot:null}function b(n){var t=e(n);return t!=null?t.length:0}function k(n){var t=e(n);return t!=null?t.map(function(n){return n.data}):[]}function o(n){var t=y(n);return t!=null?t.heroPersonId:null}function u(n){var r=o(n),t,i;return r==null?null:(t=s(n),i=t!=null?t.index[r]:null,t!=null&&i!=null?t.values[i]:null)}function d(n){var t=u(n);return t!=null?t.data:null}function g(n){var t=u(n);return t!=null&&t.floorPlan!=null?t.floorPlan.data:null}function nt(n){var t=u(n);return t!=null&&t.calendar!=null?t.calendar.data:null}function tt(n){var t=n.cfg.user;return t&&t.id&&t.id===o(n)}function h(n){var t=e(n);return t!=null&&t.length>0?t[0]:null}function it(n){var t=h(n);return t!=null?t.data:null}function rt(n){var t=f(n);return t!=null?t.data:null}function f(n){var t=u(n);return t!=null?t.orgChart:null}function ut(n){var t=r(n);return t!=null?t.orgChartPageIndex:0}function c(n){var t=f(n);return t!=null&&t.data!=null&&t.data.managers!=null?t.data.managers:null}function ft(n){var t=c(n);return t!=null&&t.length>0}function l(n){var t=f(n);return t!=null&&t.data!=null&&t.data.directs!=null?t.data.directs:null}function et(n){var t=l(n);return t!=null&&t.length>0}var i=n.Actions.ActionType,a=Redux.combineReducers;t.peopleCardReducer=function(n,t){n===void 0&&(n=null);switch(t.type){case i[i.QUERY_GENERIC_REQUEST]:return Object.assign({},n,{heroPersonId:null,allPersonIds:null,isLoading:!1,error:null});case i[i.PEOPLE_REQUEST]:return Object.assign({},n,{heroPersonId:null,allPersonIds:null,isLoading:!0,error:null});case i[i.PEOPLE_COMPLETED]:return Object.assign({},n,{heroPersonId:t.heroPerson!=null?t.heroPerson.ObjectId:null,allPersonIds:t.all!=null?t.all.map(function(n){return n.ObjectId}):[],error:null,isLoading:!1});case i[i.PEOPLE_ERROR]:return Object.assign({},n,{heroPersonId:null,allPersonIds:null,isLoading:!1,error:t.error});case i[i.SET_HERO_PERSON_ID]:return Object.assign({},n,{heroPersonId:t.heroPersonId});case i[i.SEARCH_PEOPLE_INPLACE]:return Object.assign({},n,{heroPersonId:t.objectId});default:return n}};t.personStateReducer=function(t,r){var h,c;t===void 0&&(t=null);switch(r.type){case i[i.PERSON_DOCUMENTS_REQUEST]:return Object.assign({},t,{files:{isLoading:!0,data:null}});case i[i.PERSON_DOCUMENTS_COMPLETED]:return Object.assign({},t,{files:{data:r.files,isLoading:!1}});case i[i.PERSON_DOCUMENTS_ERROR]:return Object.assign({},t,{files:{isLoading:!1,error:r.error}});case i[i.PERSON_FLOORPLAN_REQUEST]:return Object.assign({},t,{floorPlan:{isLoading:!0,data:null}});case i[i.PERSON_FLOORPLAN_ROOM_COMPLETED]:return h=Object.assign({},t.floorPlan&&t.floorPlan.data,{roomInfo:r.roomInfo}),c=Object.assign({},t.floorPlan,{isLoading:!0,data:h}),Object.assign({},t,{floorPlan:c});case i[i.PERSON_FLOORPLAN_COMPLETED]:return Object.assign({},t,{floorPlan:{isLoading:!1,data:Object.assign({},t.floorPlan&&t.floorPlan.data,{floorPlan:r.floorPlan})}});case i[i.PERSON_FLOORPLAN_ERROR]:return Object.assign({},t,{floorPlan:{isLoading:!1,error:r.error}});case i[i.CALENDAR_REQUEST]:return Object.assign({},t,{calendar:{isLoading:!0,data:null}});case i[i.CALENDAR_COMPLETED]:var s=r,l=s.personAvailability,a=s.userAvailability,y=s.events;return Object.assign({},t,{calendar:{isLoading:!1,data:Object.assign({},t.calendar&&t.calendar.data,{personAvailability:l,userAvailability:a,events:y})}});case i[i.CALENDAR_ERROR]:return Object.assign({},t,{calendar:{isLoading:!1,error:r.error}});case i[i.PERSON_ORGCHART_REQUEST]:return Object.assign({},t,{orgChart:{isLoading:!0,data:null}});case i[i.PERSON_ORGCHART_COMPLETED]:var u=r,f=u.directs,e=u.managers,o=u.peers,p=u.personId,w=u.sortDirectReportsByOrgCount;return f=f!=null?v(f,w):[],e=e!=null?e:[],o=o!=null?o.filter(function(n){return n.ObjectId!==p}).sort(function(t,i){return n.sortFunc(t.FullName,i.FullName)}):[],Object.assign({},t,{orgChart:{data:{directs:f,managers:e,peers:o},isLoading:!1}});case i[i.PERSON_ORGCHART_ERROR]:return Object.assign({},t,{orgChart:{isLoading:!1,error:r.error}});case i[i.PERSON_GROUP_REQUEST]:return Object.assign({},t,{groups:{isLoading:!0,data:null}});case i[i.PERSON_GROUP_COMPLETED]:return Object.assign({},t,{groups:{data:r.groups,isLoading:!1}});case i[i.PERSON_GROUP_ERROR]:return Object.assign({},t,{groups:{isLoading:!1,error:r.error}})}return null};t.peopleStoreReducer=function(n,r){var h,f,e,s,c,u,l,o,a;n===void 0&&(n={values:[],index:{}});switch(r.type){case i[i.PEOPLE_COMPLETED]:if(h=r,h.all==null)return n;for(f=Object.assign(n.index),e=n.values.slice(),s=0,c=h.all;s<c.length;s++)u=c[s],f[u.ObjectId]==null?(e.push({objectId:u.ObjectId,data:u}),f[u.ObjectId]=e.length-1):Object.assign(e[f[u.ObjectId]],{data:u});return Object.assign({},n,{values:e,index:f});default:return(l=r,o=void 0,l.personId==null||(o=n.index[l.personId])==null)?n:(a=t.personStateReducer(n.values[o],r),a==null)?n:Object.assign({},n,{values:n.values.slice(0,o).concat([a],n.values.slice(o+1))})}};t.peoplePivotReducer=function(n,t){n===void 0&&(n=null);switch(t.type){case i[i.SET_PERSON_PIVOT]:return t.pivot;default:return n}};t.orgChartPageIndexReducer=function(n,t){n===void 0&&(n=0);switch(t.type){case i[i.SET_ORGCHART_PAGE_INDEX]:return t.pageIndex;default:return n}};t.forceWrapDirectReportsMetaReducer=function(n,t){n===void 0&&(n=!1);switch(t.type){case i[i.SET_ORGCHART_WRAP_DIRECT_META]:return!0;default:return n}};t.inplaceSearchExpectedIntentReducer=function(n,t){n===void 0&&(n=null);switch(t.type){case i[i.SEARCH_PEOPLE_INPLACE]:return t.expectedIntent;case i[i.SET_INPLACE_SEARCH_INTENT]:return t.expectedIntent;case i[i.SET_GLEAM_OPTION]:return null;default:return n}};t.reducer=a({card:t.peopleCardReducer,people:t.peopleStoreReducer,selectedPivot:t.peoplePivotReducer,orgChartPageIndex:t.orgChartPageIndexReducer,forceWrapDirectReportsMeta:t.forceWrapDirectReportsMetaReducer,inplaceSearchExpectedIntent:t.inplaceSearchExpectedIntentReducer});t.getPeopleIntent=p;t.getPeoplePivot=w;t.getPeopleCount=b;t.getAllPeople=k;t.getHeroPersonId=o;t.getHeroPersonState=u;t.getHeroPerson=d;t.getHeroPersonFloorPlanState=g;t.getHeroPersonCalendarState=nt;t.getHeroIsMe=tt;t.getBestMatchPersonState=h;t.getBestMatchPerson=it;t.getHeroPersonOrgChartState=rt;t.getAsyncHeroPersonOrgChartState=f;t.getOrgChartPageIndex=ut;t.getOrgChartManagers=c;t.getOrgChartHasManagers=ft;t.getOrgChartDirects=l;t.getOrgChartHasDirects=et})(i=t.People||(t.People={}))})(t=n.Reducers||(n.Reducers={}))}(n||(n={})),function(n){var t;(function(t){var i;(function(t){function r(n){return n.photo.groupPhotos}function u(n){return n.photo.personPhotos}function f(n,t){var i=u(n),f=r(n);return i&&i[t]||f&&f[t]||null}var i=n.Actions.ActionType;t.reducer=function(n,t){var u,f;n===void 0&&(n={groupPhotos:{},personPhotos:{}});switch(t.type){case i[i.GROUP_PHOTO_DOWNLOAD]:var e=t,o=e.groupId,r=e.base64Image;return r==null||o==null?n:Object.assign({},n,{groupPhotos:Object.assign({},n.groupPhotos,(u={},u[o]=r,u))});case i[i.PERSON_PHOTO_DOWNLOADED]:var s=t,h=s.email,r=s.base64Image;return r==null||h==null?n:Object.assign({},n,{personPhotos:Object.assign({},n.personPhotos,(f={},f[h]=r,f))});default:return n}};t.getGroupPhoto=r;t.getPeoplePhoto=u;t.getPhoto=f})(i=t.Photo||(t.Photo={}))})(t=n.Reducers||(n.Reducers={}))}(n||(n={})),function(n){var t;(function(t){var i;(function(t){function r(n){return n.searchScenario}var i=n.Actions.ActionType;t.reducer=function(n,t){return(n===void 0&&(n=null),t.type===i[i.SET_SEARCH_SCENARIO]||t.type===i[i.SET_GLEAM_OPTION])?t.gleamOption:n};t.getGleamOption=r})(i=t.SearchScenario||(t.SearchScenario={}))})(t=n.Reducers||(n.Reducers={}))}(n||(n={})),function(n){var t;(function(t){var i;(function(t){var i=n.Actions.ActionType;t.reducer=function(n,t){n===void 0&&(n=null);switch(t.type){case i[i.PEOPLE_COMPLETED]:case i[i.DOCUMENTS_COMPLETED]:case i[i.CREATE_OR_UPDATE_USER_INFO]:var r=t.userInfo;return r==null?n:Object.assign({},t.userInfo);default:return n}}})(i=t.UserInfo||(t.UserInfo={}))})(t=n.Reducers||(n.Reducers={}))}(n||(n={})),function(n){var t;(function(t){var i;(function(t){var i=null;t.reducer=function(t,r){return(t===void 0&&(t=i),r.type===n.Actions.ActionType[n.Actions.ActionType.SET_COMMAND])?r.command==null?null:Object.assign({},t,r.command):t}})(i=t.Service||(t.Service={}))})(t=n.Reducers||(n.Reducers={}))}(n||(n={})),function(n){var t;(function(t){var i;(function(t){function r(n){var t=n.ans.mainline;return t!=null?t.orgChartRender:null}function f(n){var t=r(n);return t!=null?t.isSkipManagersVisible:null}function e(n){var t=r(n);return t!=null?t.isExpanderHoverVisible:null}var i=n.Actions.ActionType,u=Redux.combineReducers;t.mainlineAnswerReducer=function(n,t){var r;return(n===void 0&&(n={width:null,render:!1,isNotificationVisible:!1,orgChartRender:{}}),t.type===i[i.SET_MAINLINE_ANSWER_NOTIFICATION_VISIBILITY])?Object.assign({},n,{isNotificationVisible:t.isNotificationVisible}):t.type===i[i.SET_MAINLINE_ANSWER_ORG_SKIP_VISIBILITY]?(r=Object.assign({},n.orgChartRender,{isSkipManagersVisible:t.isOrgChartSkipManagersVisible}),Object.assign({},n,{orgChartRender:r})):t.type===i[i.SET_MAINLINE_ANSWER_ORG_EXPAND_HOVER_VISIBILITY]?(r=Object.assign({},n.orgChartRender,{isExpanderHoverVisible:t.isOrgChartExpanderHoverVisible}),Object.assign({},n,{orgChartRender:r})):t.type===i[i.SET_MAINLINE_FOOTER_ADDITIONAL_CONTENT_WIDTH]?Object.assign({},n,{footerAdditionalContentWidth:t.footerAdditionalContentWidth}):n};t.inlineAnswerReducer=function(n,t){return(n===void 0&&(n={isPeopleExpanded:!1,isPeopleOrgChartExpanded:!1,isDisambigExpanded:!1}),t.type===i[i.EXPAND_INLINE_ANSWER_PEOPLE])?Object.assign({},n,{isPeopleExpanded:t.isPeopleExpanded}):t.type===i[i.EXPAND_INLINE_ANSWER_PEOPLE_ORGCHART]?Object.assign({},n,{isPeopleOrgChartExpanded:t.isPeopleOrgChartExpanded}):t.type===i[i.EXPAND_INLINE_ANSWER_DISAMBIG]?Object.assign({},n,{isDisambigExpanded:t.isDisambigExpanded}):n};t.reducer=u({mainline:t.mainlineAnswerReducer,inline:t.inlineAnswerReducer});t.getMainlineOrgChartRender=r;t.getMainlineOrgChartIsSkipManagersVisible=f;t.getMainlineOrgChartIsExpanderHoverVisible=e})(i=t.Answer||(t.Answer={}))})(t=n.Reducers||(n.Reducers={}))}(n||(n={})),function(n){var t;(function(t){var i;(function(t){function r(n,t){var i=n[t];return i!=null&&i.data!=null}function u(n,t){var i=n[t];return i!=null&&i.isLoading}var i=n.Actions.ActionType;t.reducer=function(n,t){var r,u,f;n===void 0&&(n={});switch(t.type){case i[i.LOAD_DEPENDENCY_REQUEST]:return(r=t,n[r.dependency]!=null&&n[r.dependency].data!=null)?n:Object.assign({},n,(u={},u[t.dependency]={isLoading:!0,data:null,error:null},u));case i[i.LOAD_DEPENDENCY_COMPLETED]:return Object.assign({},n,(f={},f[t.dependency]={isLoading:!1,data:{},error:null},f));default:return n}};t.isDependencyLoaded=r;t.isDependencyLoading=u})(i=t.Dependency||(t.Dependency={}))})(t=n.Reducers||(n.Reducers={}))}(n||(n={})),function(n){var t;(function(t){var i;(function(t){function r(n,t){var i=n.presence;return i!=null?i[t]:null}var i=n.Actions.ActionType;t.reducer=function(n,t){n===void 0&&(n={});switch(t.type){case i[i.SET_ONLINE_PRESENCE]:return Object.assign({},n,(r={},r[t.email]=t.presence,r));default:return n}var r};t.getPresence=r})(i=t.OnlinePresence||(t.OnlinePresence={}))})(t=n.Reducers||(n.Reducers={}))}(n||(n={})),function(n){var t;(function(t){var i;(function(t){var i=n.Actions.ActionType;t.reducer=function(n,t){n===void 0&&(n={});switch(t.type){case i[i.SET_NON_WORK_RESULTS_VEIL_VISIBILITY]:return Object.assign({},n,{isVisible:t.isVisible});case i[i.CANCEL_NON_WORK_RESULTS_VEIL]:return Object.assign({},n,{shouldRender:!1});default:return n}}})(i=t.Veil||(t.Veil={}))})(t=n.Reducers||(n.Reducers={}))}(n||(n={})),function(n){var t;(function(t){var i;(function(t){function r(n){return n.powerBi}var i=n.Actions.ActionType;t.reducer=function(n,t){n===void 0&&(n={data:null,isLoading:!1,error:null});switch(t.type){case i[i.POWERBI_REQUEST]:return Object.assign({},n,{data:null,isLoading:!0,error:null});case i[i.POWERBI_COMPLETED]:return Object.assign({},n,{data:t.cards,isLoading:!1,error:null});case i[i.POWERBI_ERROR]:return Object.assign({},n,{data:null,isLoading:!1,error:t.error});default:return n}};t.getPowerBiState=r})(i=t.PowerBi||(t.PowerBi={}))})(t=n.Reducers||(n.Reducers={}))}(n||(n={})),function(n){var t;(function(t){function h(t,i){t=s(t,i);var r=n.Reducers.Configuration.reducer(t.cfg,i),u=n.Reducers.AppRouter.reducer(r,new n.Ranking.AnswerRanker(r))(t.appRouter,i);return Object.assign({},t,{cfg:r,appRouter:u})}function r(t,i){var r=typeof window=="undefined"?null:window,o=r&&r.devToolsExtension,s=[_w.ReduxThunk["default"]];return t!=null&&s.push(n.Actions.actionListenerMiddleware(t)),u(c,i,e(f.apply(void 0,s),o?o():function(n){return n}))}function l(t,r){return new i(t,r)}var u=Redux.createStore,f=Redux.applyMiddleware,e=Redux.compose,o=Redux.combineReducers,s=o({cfg:function(t){return t||n.Reducers.Configuration.initialState},appRouter:function(t){return t||n.Reducers.AppRouter.initialState},width:function(n){return n||null},qrynf:n.Reducers.QueryInfo.reducer,searchScenario:n.Reducers.SearchScenario.reducer,ans:n.Reducers.Answer.reducer,gleam:n.Reducers.Gleam.reducer,bookmarks:n.Reducers.Bookmarks.reducer,refQna:n.Reducers.RefQna.reducer,building:n.Reducers.Building.reducer,documents:n.Reducers.Documents.reducer,group:n.Reducers.Group.reducer,people:n.Reducers.People.reducer,userInfo:n.Reducers.UserInfo.reducer,photo:n.Reducers.Photo.reducer,disclaimer:n.Reducers.Disclaimer.reducer,command:n.Reducers.Service.reducer,dependency:n.Reducers.Dependency.reducer,aad:n.Reducers.Aad.reducer,presence:n.Reducers.OnlinePresence.reducer,veil:n.Reducers.Veil.reducer,powerBi:n.Reducers.PowerBi.reducer}),c=h,i;t.configureStore=r;t.createReduxStore=l;i=function(){function n(n,t){this.store=r(n,t)}return n.prototype.getStore=function(){return this.store},n.prototype.getState=function(){return this.store.getState()},n.prototype.dispatch=function(n){return this.store.dispatch(n)},n}();t.BingAtWorkStore=i})(t=n.Store||(n.Store={}))}(n||(n={})),function(n){var t;(function(t){function l(t){return Object.keys(n.GleamOption).filter(function(n){return isNaN(parseInt(n))}).map(function(t){return n.GleamOption[t]}).filter(function(i){return(t.ft.grpsrch.e||i!==n.GleamOption.Group)&&(t.ft.bld.e||i!==n.GleamOption.Buildings)&&(t.ft.powerbi.e||i!==n.GleamOption.PowerBi)})}function a(t){switch(t){case null:return n.Strings.WorkResults;case n.GleamOption.People:return n.Strings.People;case n.GleamOption.Documents:return n.Strings.Documents;case n.GleamOption.Bookmarks:return n.Strings.Bookmarks;case n.GleamOption.Group:return n.Strings.Groups;case n.GleamOption.Buildings:return n.Strings.Buildings;case n.GleamOption.PowerBi:return n.Strings.PowerBi}return""}function v(t){switch(t){case n.GleamOption.People:return"bw-gPpl";case n.GleamOption.Documents:return"bw-gDoc";case n.GleamOption.Bookmarks:return"bw-gBkm";case n.GleamOption.Group:return"bw-gGrp";case n.GleamOption.Buildings:return"bw-gBld";case n.GleamOption.PowerBi:return"bw-gPowerBi";default:return""}}function y(t){switch(t){case n.GleamOption.People:return n.Components2.SvgIconType.people;case n.GleamOption.Documents:return n.Components2.SvgIconType.page;case n.GleamOption.Bookmarks:return n.Components2.SvgIconType.doublebookmark;case n.GleamOption.Group:return n.Components2.SvgIconType.group;case n.GleamOption.Buildings:return n.Components2.SvgIconType.mapPin;case n.GleamOption.PowerBi:return n.Components2.SvgIconType.powerbi;default:return null}}function p(n,t){return t==null?!1:e(n,t,null)}function e(t,i,r){return t==null||t.placement!==n.AnswerPlacement.Pole||i==null||r!=null&&i!==r}function w(n){return n.filter(function(n){return n!=null&&n.value!=null&&n.value.length>0})}function b(t,i,r){if(t!=null&&t.length>0){var u=t.filter(function(t){return t!=null&&!n.nullOrWs(t.Number)}).map(function(n){return n.Number});return this.createInfo(u,i,n.DataType.Phone,n.QueryIntent.Phone,r)}return null}function k(t,i,r){if(t!=null&&t.length>0){var u=t.filter(function(n){return n!=null&&n.Address!=null&&n.Address!==""}).map(function(n){return n.Address});if(u.length>0)return this.createInfo(u,i,n.DataType.Email,n.QueryIntent.Email,r)}return null}function d(t,i,r,u,f){return n.nullOrWs(t)?null:o([t],i,f==null?n.DataType.Other:f,r,u)}function o(t,i,r,u,f){return{name:n.Strings[i],value:t,type:r,cssClass:u!=null&&u!=n.QueryIntent.None&&f===u?"bw-hlt":""}}function s(n){return n==null?null:n.Email||n.UPN}function g(t){var i=t.JobTitle;return n.nullOrWs(i)?t.FullName:t.FullName+" - "+i}function nt(n){if(n==null)return null;var t=n.BusinessPhoneNumbers;return t!=null&&t.length>0&&t[0]!=null&&t[0].Number!=null&&t[0].Number!==""?t[0].Number:null}function tt(){return n.Strings.BestWorkMatchIs.split("{0}")}function it(){return n.Strings.ViewAllMatchesFor.split("{0}")}function rt(n,t){for(var i=[],r=n.slice();r.length>0;)i.push(r.splice(0,t));return i}function ut(){for(var r,i=[],t=0;t<arguments.length;t++)i[t]=arguments[t];return r=i.filter(function(t){return!n.nullOrWs(t)}),r.join(" ")}function ft(t,i){if(!t.ft.bld.e||i==null||n.nullOrWs(i.OfficeLocation))return null;var r=i.OfficeLocation.split("/")[0];return n.nullOrWs(r)?null:{mapUrl:n.getBuildingMapUrl(r)}}function et(t,i,r,u){return!t.ft.fp.e||i==null||r==null?null:{buildingName:r.buildingName,officeNumber:r.officeNumber,activateFloorPlan:function(){return u(n.PersonCardPivot.FloorPlan)},requeryUrl:n.getUserUrl(i.FullName,i.UPN||"",null,n.QueryIntent.Office),buildingMapUrl:t.ft.bld.e?n.getBuildingMapUrl(r.buildingName):null}}function r(n,t){var r,o,u,e,i,f;if(n==null)return null;for(r=n,o=t.split("\\"),u=0,e=o;u<e.length;u++)if(i=e[u],i!=null&&typeof i=="string"&&i.length>0)if(f=r[i],typeof f!="undefined"&&f!=null)r=JSON.parse(f);else return null;else return null;return r}function u(t,i,u){if(u==null)return null;var f="";return u.forEach(function(u){var h=i+"_"+u.labelKey,o=n.nullOrWs(h)?null:n.Strings[h],s,e;u.path!=null&&u.path.length>0?(s=r(t,u.path),f+=" "+(o?n.strFormat(o,s):s)):u.subInfos!=null&&(e=null,u.subInfos.forEach(function(n){var i=r(t,n.path);!i||isNaN(i)||(e==null?e=i:e+=i)}),!e||(f+=" "+(o?n.strFormat(o,n.localizeNumber(e)):e)))}),f}function i(t,i,r,f,e){var h="0",o=0,c,s;try{e?o=parseInt(u(t,r,e)):(c=JSON.parse(i),c!=null&&(o=parseInt(c.TotalCount)));!isNaN(o)&&o>0&&(h=n.localizeNumber(o))}catch(l){}return(s=r&&f?u(t,r,f):null,o>0||s)?s?h+s:h:null}function h(t,i,u){var e="",l=i+"_"+u.labelKey,v=n.nullOrWs(l)?null:n.Strings[l],o,s,f,c,a;if(u.path!=null&&u.path.length>0&&(o=r(t,u.path),!!o)){try{s=parseInt(o);isNaN(s)||(o=n.localizeNumber(s))}catch(y){}e+=n.strFormat(v,o)}return u.subInfos!=null&&(f="",c=u.subInfos.map(function(r){var f=h(t,i,r),u,e;return f?f.trim():r.placeholder?(u=i+"_"+r.labelKey,e=n.nullOrWs(u)?null:n.Strings[u]," "+n.strFormat(e,r.placeholder)):void 0}),c.some(function(n){return!!n&&n.indexOf(" ")!=0})&&(a=!u.delimiter?" ":u.delimiter+" ",f=c.filter(function(n){return!!n}).join(a)),!f||(e.length>0?e+=u.wrapper?" "+n.strFormat(u.wrapper,f)+" ":" "+f+" ":e=f)),e}function f(n,t,i){if(i==null)return null;var r="";return i.forEach(function(i){var u=h(n,t,i);!u||(r.length>0&&(r+=" "),r+=u)}),r}function ot(n,t){var r={fullName:n.FullName,jobTitle:n.JobTitle,email:s(n),department:n.Department,officeLocation:n.OfficeLocation};return r.orgCount=t!=null?i(n,n.AggregatedOrgStructure,t.labelKeyPrefix,t.aggOrgAddInfos,t.aggOrgTotalInfos):i(n,n.AggregatedOrgStructure),t!=null&&(r.orgCountLabelKey=t.aggOrgTotalLabel,r.orgCountDetail=f(n,t.labelKeyPrefix,t.aggOrgDetailInfos),r.orgCountDetail&&r.orgCount===null&&(r.orgCount="0")),r.directReportsCount=t!=null?i(n,n.OrgStructure,t.labelKeyPrefix,t.orgAddInfos,t.orgTotalInfos):i(n,n.OrgStructure),t!=null&&(r.directReportsCountLabelKey=t.orgTotalLabel,r.directReportsCountDetail=f(n,t.labelKeyPrefix,t.orgDetailInfos),r.directReportsCountDetail&&r.directReportsCount===null&&(r.directReportsCount="0")),r}function st(n){return{fullName:n.FullName,jobTitle:n.JobTitle,email:n.Email}}function ht(t){var i=t&&t.Name?t.Name:"",r=new RegExp(/^\d+$/g);return r.test(i)&&(i=n.strFormat(n.Strings.BuildingName,i)),i}function ct(t){return t?n.nullOrWs(t.Room)&&n.nullOrWs(t.Floor)?t.Name:t.Name+"/"+(t.Room||t.Floor):""}function lt(t){return t?[[t.AddressLine1,t.AddressLine2,t.City,t.State].filter(function(t){return!n.nullOrWs(t)}).join(", "),t.ZipCode].filter(function(t){return!n.nullOrWs(t)}).join(" "):""}function at(n,t,i){return c(n,t,i,!0,!1)}function c(t,i,r,u,f){return u===void 0&&(u=!1),f===void 0&&(f=!0),n.strFormat(t.ft.bld.u,i.Latitude,i.Longitude,u?t.ft.bld.smallMapZoomLevel:t.ft.bld.mapZoomLevel,r,u?t.ft.bld.smallMapHeight:t.ft.bld.h,f?n.mapUrlTypeDraggable:n.mapUrlTypeStatic)}function vt(t,i,r){return n.strFormat(t.ft.bld.l,r,i.Latitude,i.Longitude)}function yt(t,i,r,u){t.preventDefault();bfbInst.cLog("BLDDR");bfbTel.logClicked(n.EventScope.Building,"BLDDR");var f=n.strFormat.call(null,i,encodeURIComponent(r),encodeURIComponent(u));n.navigateTo(f)}function pt(n,t){if(t)return"folder";var i=/(?:\.([^.]+))?$/.exec(n)[1];if(i!=null)switch(i.toLowerCase()){case"docx":return"Word";case"xlsx":return"Excel";case"one":return"OneNote";case"pptx":return"PowerPoint";case"vsdx":return"Visio";case"pdf":return"Pdf";case"url":return"url"}return"ukwn"}function wt(t,i,r,u,f,e){var s="",o="",h;return(r?u===n.DocumentSearchPivot.All?(o="SeeMoreAllResults",s=f==null||f.SpoRootSiteUrl==null?"":e.ft.moreall.deeplinkFormat.replace("{0}",f.SpoRootSiteUrl).replace("{1}",t)):u===n.DocumentSearchPivot.Personalized&&(o="SeeMoreOnOffice",s=e.ft.moreprs.deeplinkFormat.replace("{0}",t)):(o="SeeMoreOnDelve",s=f==null||f.MySiteHostUrl==null?"":e.ft.dlv.more.replace("{0}",f.MySiteHostUrl).replace("{1}",i)),h=u===n.DocumentSearchPivot.All&&e.ft.moreall.e||u===n.DocumentSearchPivot.Personalized&&e.ft.moreprs.e||!r&&e.ft.dlv.e,!h)?null:{displayText:n.Strings[o],url:s,key:o}}function bt(t,i,r){var s,h,u,e,o,f;if(r==null)return null;if(s=null,!n.nullOrWs(i.MailNickname)){for(h=i.MailNickname.toLowerCase(),u=null,e=0;e<r.length;e++){for(o=r[e].Url.split("/"),f=0;f<o.length;f++)if(o[f].toLowerCase()===h){u=o.slice(0,f+1).join("/");break}if(u!=null)break}u!=null&&(s=n.strFormat(t,u))}return{displayText:n.Strings.SeeMoreOnOffice,url:s}}function kt(n){return n.replace(/\.[^/.]+$/,"")}function dt(t){if(t!=null){bfbInst.log("TSK","GRPID",t.Id);bfbTel.logShown(n.EventScope.Bookmark,t.Id,{TT:"TSK"});var i=t.Actions.filter(function(n){return n.Id==t.MatchedActionId}).shift()||t.Actions.shift();i&&bfbInst.log("TSK","AID",i.Id,"TOP",i!=null?"1":"0");t.Actions&&t.Actions.map(function(i,r){var u=i.Id===t.MatchedActionId;bfbTel.logShown(n.EventScope.Bookmark,i.Id,{TT:"ACT",TOP:u,I:r+1,P:t.Id})})}}t.mapDispatchToProps=function(t){return Redux.bindActionCreators(n.Actions.actionCreators,t)};t.getEnabledGleamOptions=l;t.getGleamItemName=a;t.getGleamItemIconClassName=v;t.getIconType=y;t.shouldGleamLabelOpenAnswer=p;t.shouldGleamOpenAnswer=e;t.getValidInfoItems=w;t.createPhoneInfo=b;t.createEmailInfo=k;t.createOtherInfo=d;t.createInfo=o;t.getMainEmail=s;t.getFormattedPersonTitle=g;t.getMainPhoneNumber=nt;t.getBestWorkMatchIsParts=tt;t.getViewAllMatchesForParts=it;t.chunk=rt;t.combineCss=ut;t.buildBuildingInfo=ft;t.buildFloorPlanInfo=et;t.retrieveCustomPersonInfo=r;t.getOrgInfoValue=u;t.getOrgCount=i;t.getOrgDetailValue=f;t.getNameCardModelFromPerson=ot;t.getNameCardModelFromGroupMember=st;t.getTitle=ht;t.getRoomFloorTitle=ct;t.getAddress=lt;t.getSmallMapUrl=at;t.getMapUrl=c;t.getLargeMapUrl=vt;t.submitDirections=yt;t.getDocType=pt;t.buildDocumentSeeMoreLink=wt;t.buildGroupDocSeeMoreLinkUrl=bt;t.trimFileExtension=kt;t.logBookmarkShown=dt})(t=n.Components||(n.Components={}))}(n||(n={}));i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var t;(function(t){function e(i,r,u){var f=i!=null?i.isLoading:!0,e=i!=null?i.error:null,o=n.nullOrWs(r)?null:n.Strings[r].toLocaleLowerCase();return React.createElement(t.SimpleProgressContainer,{error:e,isLoading:f,queryOverwrite:o,addQuotes:u})}function o(n,i){return ReactRedux.connect(n,t.mapDispatchToProps)(i)}function r(n,t,i,r,u){var f=i.buildingMapUrl!=null?React.createElement("a",{href:i.buildingMapUrl,onMouseDown:function(){return u("BLD")}},i.buildingName):React.createElement("span",null,i.buildingName);return React.createElement("span",{key:n,className:t.cssClass},f,React.createElement("span",null,"/"),React.createElement("a",{href:i.requeryUrl,onMouseDown:function(){return u("FLP")},onClick:r},i.officeNumber))}function u(n,t,i,r,u){return React.createElement("a",{key:n,className:t.cssClass,href:i.mapUrl,onMouseDown:function(){return u("BLD")}},r)}function s(i,e,o,s,h,c,l){switch(e.type){case n.DataType.Email:return React.createElement(t.EmailAction,{key:i,email:o,onMouseDown:function(){return s("EML")},className:e.cssClass},o);case n.DataType.Phone:return f.test(o)?null:React.createElement(t.PhoneAction,{key:i,phone:o,onMouseDown:function(){return s("PHN")},className:e.cssClass},o);case n.DataType.Office:if(c!=null)return r(i,e,c,h,s);if(l!=null&&l.mapUrl!=null)return u(i,e,l,o,s)}return null}function h(r,u,f){u===void 0&&(u=null);f===void 0&&(f=null);var e={tenantName:r,additionalClassName:u,lockIconClassName:f};return n.nullOrWs(r)?null:React.createElement(t.CorpOnlyMessage,i({},e))}function c(t,i){var r=t.IconFont;return(n.nullOrWs(r)||r.toLowerCase()==="no applicable icon found")&&(r="doublebookmark"),n.nullOrWs(t.Url)&&n.nullOrWs(t.Title)&&(r=""),{id:t.Id,url:t.Url,title:t.Title,fontClass:"bw-msfont "+r,isTopAction:i}}function l(n,t,i){var u=n.url,f=n.fontClass,r=n.title;return React.createElement("li",{key:t},React.createElement("a",{href:u,onMouseDown:function(){return i(n)}},React.createElement("div",{className:f,"data-tag":"bw-scrubFont"}),React.createElement("div",{className:"bw-aTtl bw-tnc",title:r},r)))}var f=/^0*$/;t.renderSimpleProgress=e;t.simpleConnect=o;t.renderFloorPlanInfo=r;t.renderBuildingInfo=u;t.renderInfoItem=s;t.renderCorpOnlyMessage=h;t.buildBookmarkAction=c;t.renderBookmarkAction=l})(t=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(n){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,r=t.topActionProps,i=t.otherActionsProps,u=t.contentClassName,f=t.onActionMouseDown,e=t.isSlim;return React.createElement("div",null,this.renderHeader(),React.createElement("div",{id:"bw-tsk",className:u},React.createElement(n.BookmarkTopAction,{actionProps:r,hasOtherActions:i!=null&&i.length>0,onMouseDown:function(n){return f(n)},isSlim:e}),this.renderOtherActions()))},u.prototype.renderHeader=function(){var t=this.props,r=t.headerProps,u=t.isSlim;return u?React.createElement(n.SlimHeader,{text:r.title,additionalClassName:"bw-crdttl"}):React.createElement(n.SimpleHeader,i({},r))},u.prototype.renderOtherActions=function(){var t=this.props,i=t.topActionProps,r=t.otherActionsProps,u=t.onActionMouseDown,f=t.isSlim;return f?React.createElement(n.BookmarkSlimOtherActions,{actionsProps:r,hasTopActions:i!=null,onMouseDown:function(n){return u(n)}}):React.createElement(n.BookmarkOtherActions,{actionsProps:r,hasTopActions:i!=null,onMouseDown:function(n){return u(n)}})},u}(React.Component);n.Bookmark=r})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var f=function(n){var t=n.cfg,i=n.bookmarks,r=i.data;return{cfg:t,data:r}},u=function(u){function f(){return u!==null&&u.apply(this,arguments)||this}return t(f,u),f.prototype.componentDidMount=function(){var n=this.props.data;r.logBookmarkShown(n)},f.prototype.render=function(){var n=this.props,t=n.cfg,u=n.data,f=n.isSlim,e=this.buildBookmarkProps(u,t.tenantMetadata.theme,f);return React.createElement(r.Bookmark,i({},e))},f.prototype.buildBookmarkProps=function(n,t,i){var o={title:n.Title,theme:t},u=f.buildTopActionProps(n),s=u.topActionProps,e=u.topAction,r=f.buildOtherActions(n,e),h=f.buildContentClassName(e,r!=null&&r.length>0);return{headerProps:o,topActionProps:s,otherActionsProps:r,contentClassName:h,onActionMouseDown:f.onActionMouseDown.bind(this),isSlim:i}},f.buildTopActionProps=function(n){var t=f.getTopAction(n),i=t!=null?r.buildBookmarkAction(t,!0):null;return{topActionProps:i,topAction:t}},f.buildOtherActions=function(n,t){var i=n.Actions.filter(function(n){return n.Id!==(t!=null?t.Id:null)});return i.map(function(n){return r.buildBookmarkAction(n,!1)})},f.buildContentClassName=function(n,t){var i=[];return n!=null&&i.push("top"),t&&i.push("othr"),i.join(" ")},f.onActionMouseDown=function(t){bfbInst!=null&&bfbInst.instBookmarkActionClick!=null&&bfbInst.instBookmarkActionClick(t.isTopAction,t.id);bfbTel!=null&&bfbTel.logClicked!=null&&bfbTel.logClicked(n.EventScope.Bookmark,t.id,null,{TT:"ACT",TOP:t.isTopAction})},f.getTopAction=function(n){if(n.MatchedActionId!=null){var t=n.Actions.filter(function(t){return t.Id===n.MatchedActionId});if(t.length>0)return t[0]}return null},f}(React.Component);r.BookmarkContainerImpl=u;r.BookmarkContainer=r.simpleConnect(f,u)})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,r=t.actionsProps,u=t.hasTopActions,f=t.onMouseDown;return r!=null&&r.length>0?React.createElement("div",{id:"bw-act"},React.createElement("div",{className:u?"":"b_hide"},n.Strings.TaskRelatedLinks),React.createElement("ul",null,r.map(function(n,t){return i.renderBookmarkAction(n,t,f)}))):null},u}(React.Component);i.BookmarkOtherActions=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,r=t.actionsProps,u=t.hasTopActions;return r!=null&&r.length>0?React.createElement("div",{id:"bw-act"},React.createElement("div",{className:i.combineCss("bw-meta",u?null:"b_hide")},n.Strings.TaskRelatedLinks),this.renderActionsList()):null},u.prototype.renderActionsList=function(){var r=this.props,n=r.actionsProps,t=r.onMouseDown,i;return n.length>1?(i=n.length/2+n.length%2,React.createElement("div",null,React.createElement("ul",null,this.renderActions(n.slice(0,i),t)),React.createElement("ul",null,this.renderActions(n.slice(i),t)))):React.createElement("ul",null,this.renderActions(n,t))},u.prototype.renderActions=function(n,t){return n.map(function(n,r){return i.renderBookmarkAction(n,r,t)})},u}(React.Component);i.BookmarkSlimOtherActions=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,r=t.actionProps,u=t.hasOtherActions,f=t.isSlim;return r!=null?React.createElement("div",{id:"bw-topAct"},React.createElement("div",{className:i.combineCss(f?"bw-meta":null,u?null:"b_hide")},n.Strings.TaskBestMatch),this.renderAction(r)):null},u.prototype.renderAction=function(n){var t=n.url,r=n.fontClass,i=n.title,u=this.props.onMouseDown;return React.createElement("a",{href:t,onMouseDown:function(){return u(n)}},React.createElement("div",{className:r,"data-tag":"bw-scrubFont"}),React.createElement("div",{id:"bw-aInfo"},React.createElement("div",{className:"bw-aTtl bw-tnc",title:i},i),React.createElement("div",{className:"bw-aLink bw-tnc",title:t},t)))},u}(React.Component);i.BookmarkTopAction=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(n){return{data:n.bookmarks.data}},r=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){var t=this.props.data;return t==null?null:React.createElement("div",{className:"bw-ans-content"},React.createElement(n.BookmarkContainer,{isSlim:!0}))},r}(React.Component);n.ContextRegionBookmarkSearchContainer=n.simpleConnect(i,r)})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(n){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,f=t.address,r=t.directionsFormProps,u=t.isSlim;return React.createElement("div",null,this.renderHeader(),React.createElement("div",{className:"bw-bld"},React.createElement("h2",{className:u?"bw-meta":"bw-bldAddress"},f),this.renderMap(),u?React.createElement(n.BuildingDirectionsButton,i({},r)):React.createElement(n.BuildingDirectionsForm,i({},r))))},u.prototype.renderMap=function(){var t=this.props.mapProps;return t==null?null:React.createElement(n.BuildingMap,i({},t))},u.prototype.renderHeader=function(){var t=this.props,r=t.simpleHeaderProps,u=t.isSlim;return u?React.createElement(n.SlimHeader,{text:r.title,additionalClassName:"bw-crdttl"}):React.createElement(n.SimpleHeader,i({},r))},u}(React.Component);n.Building=r})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var f=function(t){var u=t.cfg,r=t.building,f=t.dependency,e=t.appRouter,o=r.data,s=r.directionFrom,h=r.directionTo,c=r.mapWidth,i=r.floorPlan,l=i!=null&&i.data!=null?i.data.floorPlan:null,a=i!=null&&i.data!=null?i.data.roomInfo:null;return{theme:t.cfg.tenantMetadata.theme,cfg:u,data:o,directionFrom:s,directionTo:h,mapWidth:c,isContainerAttached:n.Reducers.AppRouter.isContainerAttached(e,n.AnswerPlacement.Pole),floorPlanState:i,floorPlan:l,roomInfo:a,isDependencyLoaded:n.Reducers.Dependency.isDependencyLoaded(f,n.ResourceDependency.FloorPlan),isDependencyLoading:n.Reducers.Dependency.isDependencyLoading(f,n.ResourceDependency.FloorPlan),showFloorPlanZoomButton:!u.render.isInline}},u=function(u){function f(n){return u.call(this,n)||this}return t(f,u),f.prototype.componentDidMount=function(){bfbInst.sLog("BLDIN");bfbTel.logShown(n.EventScope.Building,"BLD");var t=this.props,i=t.setBuildingDirectionTo,u=t.data;i(r.getAddress(u))},f.prototype.render=function(){var t=this.props,i=t.floorPlanState,r=t.isContainerAttached,n;return r?i!=null&&(n=this.renderFloorPlan(),n!=null)?n:this.renderBuilding():null},f.prototype.renderBuilding=function(){var n=this.buildBuildingProps();return n==null?null:React.createElement(r.Building,i({},n))},f.prototype.buildBuildingProps=function(){var n=this.props,h=n.theme,i=n.cfg,t=n.data,c=n.directionFrom,l=n.directionTo,u=n.mapWidth,a=n.setBuildingDirectionTo,v=n.setBuildingDirectionFrom,y=n.setBuildingMapWidth,p=n.swapBuildingDirection,w=n.isContainerAttached,b=r.getTitle(t),f=r.getAddress(t),e=null,o,s;return t!=null&&t.Latitude!=null&&t.Longitude!=null&&w&&(e={address:f,mapWidth:u,mapHeight:i.ft.bld.h,mapUrl:r.getMapUrl(i,t,u),largeMapUrl:r.getLargeMapUrl(i,t,f),setMapWidth:y,minMapWidth:i.ft.bld.mapMinWidth}),o={from:c,to:l,setDirectionTo:a,setDirectionFrom:v,swapDirection:p,directionUrl:i.ft.bld.d},s={simpleHeaderProps:{theme:h,title:b},address:r.getAddress(t),mapProps:e,directionsFormProps:o,isSlim:!1},s},f.prototype.renderFloorPlan=function(){var c=this,t=this.props,l=t.cfg,a=t.theme,f=t.data,u=t.floorPlanState,v=t.roomInfo,e=t.floorPlan,y=t.isDependencyLoaded,p=t.isDependencyLoading,w=t.showFloorPlanZoomButton,o,s;if(u==null||u.isLoading||e==null||e.floorData==null||!y)return o=u!=null?u.error:null,s=(u!=null?u.isLoading:!1)||p,React.createElement(r.SimpleProgressContainer,{error:o,isLoading:s});var b=l.ft.bld.e?n.getBuildingMapUrl(v.buildingName):null,k={officeLocation:null,buildingMapUrl:b,onBuildingClick:function(){return c.clickInst("BLD")},isVisible:!0,floorPlan:e,showZoomButton:w},h=r.getTitle(f),d=n.nullOrWs(f.Room)&&n.nullOrWs(f.Floor)?h:h+"/"+(f.Room||f.Floor),g={simpleHeaderProps:{theme:a,title:d},floorPlanProps:k};return React.createElement(r.BuildingFloorPlan,i({},g))},f.prototype.clickInst=function(t){bfbInst.cLog("FLP","V",t,"S","FLP");bfbTel.logClicked(n.EventScope.FloorPlan,t,"FLP")},f}(React.Component);r.BuildingContainerImpl=u;r.BuildingContainer=r.simpleConnect(f,u)})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){return React.createElement("form",{className:"bw-bldForm",onSubmit:this.onSubmit.bind(this)},React.createElement("div",{className:"cbtn"},React.createElement("input",{type:"submit",value:n.Strings.Directions})))},u.prototype.onSubmit=function(n){n.preventDefault();var t=this.props,r=t.directionUrl,u=t.from,f=t.to;i.submitDirections(n,r,u,f)},u}(React.Component);i.BuildingDirectionsButton=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var i=this,t=this.props,r=t.from,u=t.to;return React.createElement("form",{className:"bw-bldForm",onSubmit:this.onSubmit.bind(this)},React.createElement("span",null,React.createElement("input",{id:"bw-bldFormFrom",className:"ctxt",type:"text",placeholder:n.Strings.DirectionsFrom,value:r,onChange:this.setFrom.bind(this)})),React.createElement("span",{className:"bw-bldFormSwap"},React.createElement("span",{className:"b_pointer",onClick:function(){return i.swapDirection()}})),React.createElement("span",null,React.createElement("input",{id:"bw-bldFormTo",className:"ctxt",type:"text",placeholder:n.Strings.DirectionsTo,value:u,onChange:this.setTo.bind(this)})),React.createElement("span",{className:"cbtn"},React.createElement("input",{type:"submit",value:n.Strings.DirectionsGo})))},u.prototype.setFrom=function(n){this.props.setDirectionFrom(n.target.value)},u.prototype.setTo=function(n){this.props.setDirectionTo(n.target.value)},u.prototype.swapDirection=function(){bfbInst.cLog("BLDSW");bfbTel.logClicked(n.EventScope.Building,"BLDSW");this.props.swapDirection()},u.prototype.onSubmit=function(n){n.preventDefault();var t=this.props,r=t.directionUrl,u=t.from,f=t.to;i.submitDirections(n,r,u,f)},u}(React.Component);i.BuildingDirectionsForm=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(n){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props.simpleHeaderProps;return React.createElement("div",null,React.createElement(n.SimpleHeader,i({},t)),this.renderFloorPlan())},u.prototype.renderFloorPlan=function(){var t=this.props.floorPlanProps;return t==null?null:React.createElement(n.FloorPlan,i({},t))},u}(React.Component);n.BuildingFloorPlan=r})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(i){function r(){var n=i!==null&&i.apply(this,arguments)||this;return n.compleationEventFired=!1,n}return t(r,i),r.prototype.componentDidMount=function(){var t=this.props.minMapWidth,n;this.refs.map!=null&&(n=Math.max(t,this.refs.map.clientWidth),this.props.setMapWidth(n));this.reportRenderCompletion()},r.prototype.componentDidUpdate=function(){this.reportRenderCompletion()},r.prototype.render=function(){var t=this.props,u=t.mapWidth,f=t.mapHeight,i=t.mapUrl,r=t.largeMapUrl;return i==null||r==null?null:React.createElement("div",{id:"bw-bldMap",ref:"map"},React.createElement("div",null,React.createElement("iframe",{width:u,height:f,src:i,scrolling:"no"}),React.createElement("div",{className:"bw-bldMapFullscreen"},React.createElement("a",{href:r},n.Strings.BuildingsFullScreenMap))))},r.prototype.reportRenderCompletion=function(){var n=this.props,t=n.mapWidth,i=n.mapUrl;t>0&&i!=null&&!this.compleationEventFired&&(this.compleationEventFired=!0,sj_evt.fire(r.onBawBuildingRendered))},r.onBawBuildingRendered="onBawBuildingRendered",r}(React.Component);i.BuildingMap=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(t){var i=t.building,r=t.appRouter,u=i.data,f=i.mapWidth,e=i.directionTo,o=i.directionFrom;return{building:u,cfg:t.cfg,theme:t.cfg.tenantMetadata.theme,mapWidth:f,directionTo:e,directionFrom:o,isContainerAttached:n.Reducers.AppRouter.isContainerAttached(r,n.AnswerPlacement.ContextRegionTop)}},u=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.componentDidMount=function(){bfbInst.sLog("BLDIN");bfbTel.logShown(n.EventScope.Building);var t=this.props,r=t.setBuildingDirectionTo,u=t.building;r(i.getAddress(u))},u.prototype.render=function(){var n=this.props,t=n.building,r=n.cfg,e=n.theme,u=n.mapWidth,o=n.directionTo,s=n.directionFrom,h=n.setBuildingDirectionTo,c=n.setBuildingMapWidth,l=n.isContainerAttached;if(t==null||!l)return null;var a={theme:e,title:i.getTitle(t)},f=i.getAddress(t),v={address:f,mapWidth:u,mapHeight:r.ft.bld.smallMapHeight,mapUrl:i.getSmallMapUrl(r,t,u),largeMapUrl:i.getLargeMapUrl(r,t,f),setMapWidth:c,minMapWidth:r.ft.bld.smallMapMinWidth},y={from:s,to:o,setDirectionTo:h,directionUrl:r.ft.bld.d};return React.createElement("div",{className:"bw-ans-content"},React.createElement(i.Building,{address:i.getAddress(t),simpleHeaderProps:a,mapProps:v,directionsFormProps:y,isSlim:!0}))},u}(React.Component);i.ContextRegionBuildingSearchContainer=i.simpleConnect(r,u)})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(n){return{cfg:n.cfg,documents:n.documents==null?null:n.documents.files}},u=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.componentDidMount=function(){bfbTel.logShown(n.EventScope.Document,"DOCS")},u.prototype.render=function(){var t=this.props,r=t.cfg,u=t.documents;return React.createElement("div",{className:"bw-ans-content"},React.createElement("div",{className:"bw-crdoc"},React.createElement(i.SlimHeader,{text:n.Strings.Documents,additionalClassName:"bw-crdttl"}),React.createElement(i.DocumentsContainer,{documents:u,pivot:n.DocumentSearchPivot.Personalized,maxResults:r.ft.docs.maxDocsInCxtRegion,isSlim:!0})))},u}(React.Component);i.ContextRegionDocumentSearchContainer=i.simpleConnect(r,u)})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var n=this.props.isSlim;return React.createElement("li",{className:n?"bw-docli":null},this.renderInfo(),this.renderDetails())},u.prototype.renderInfo=function(){var n=this.props,t=n.documentData,f=n.onMouseDown,r=n.isSlim,u=t.fileName,e=t.fileType,o=t.url;return React.createElement("div",{className:r?"bw-liWdCol":"bw-liCol1"},React.createElement("div",{className:"bw-liInfo"},React.createElement("a",{href:o,className:"bw-doch",title:u,onMouseDown:f},React.createElement(i.Icon,{className:"bw-"+e+" bw-fIcon"}),React.createElement("div",{className:i.combineCss("bw-tnc",r?"bw-crttl":"bw-ttl")},u)),this.renderLastModifiedDetails()))},u.prototype.renderDetails=function(){var n=this.props,t=n.documentData,r=n.showDetails,u=n.onDocLocationMouseDown,f=t.location,i=t.locationUrl;return r?React.createElement("div",{className:"bw-liCol2"},React.createElement("a",{className:"bw-tnc",title:i,href:i,onMouseDown:u},f),React.createElement("p",{className:"bw-meta"},this.renderHitHightlight())):null},u.prototype.renderLastModifiedDetails=function(){var t=this.props,i=t.documentData,f=t.onDocModifiedMouseDown,e=t.isSlim,n=i.lastModifiedBy,r=i.modifiedByUrl,u=i.lastModifiedTime;return n!=null?e?this.renderModifiedBySlim(r,n,f,u):r!=null?this.renderModifiedByWithUrl(r,n,f,u):this.renderModifiedByNoUrl(n,u):null},u.prototype.renderModifiedBySlim=function(t,i,r,u){return React.createElement("div",{className:"bw-dInfo"},React.createElement("span",{className:"bw-meta bw-tnc"},React.createElement("a",{className:"bw-meta",href:t,title:i,onMouseDown:r},n.Strings.DocumentLastModifiedBy," ",i),React.createElement("span",{className:"bw-tiny"}," • "),u))},u.prototype.renderModifiedByWithUrl=function(t,i,r,u){return React.createElement("div",{className:"bw-dInfo"},React.createElement("a",{className:"bw-meta bw-tnc",href:t,title:i,onMouseDown:r},n.Strings.DocumentLastModifiedBy," ",i),React.createElement("div",{className:"bw-meta"},u))},u.prototype.renderModifiedByNoUrl=function(t,i){return React.createElement("div",{className:"bw-dInfo"},React.createElement("div",{className:"bw-meta bw-tnc"},n.Strings.DocumentLastModifiedBy," ",t),React.createElement("div",{className:"bw-meta"},i))},u.prototype.renderHitHightlight=function(){var i=this.props.documentData,t=i.hitHighlightHtml;return n.nullOrWs(t)?null:React.createElement("span",{dangerouslySetInnerHTML:{__html:t}})},u}(React.Component);i.Document=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){var t=this.props,r=t.documents,u=t.showDetails,i=t.isSlim,f=t.onMouseDown,e=t.onDocModifiedMouseDown,o=t.onDocLocationMouseDown;return React.createElement("ul",{id:"bw-doc",className:i?null:"bw-list"},r.map(function(t,r){return React.createElement(n.Document,{key:r,documentData:t,showDetails:u,isSlim:i,onMouseDown:function(){return f(r)},onDocModifiedMouseDown:function(){return e(r)},onDocLocationMouseDown:function(){return o(r)}})}))},r}(React.Component);n.DocumentList=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(t){var i=t.cfg,r=t.userInfo,u=t.qrynf,f=t.searchScenario,e=n.Reducers.People.getHeroPersonId(t);return{cfg:i,userInfo:r,scenario:f,query:u.qry,personObjId:e,isInline:i.render.isInline}},u=function(r){function u(){var n=r!==null&&r.apply(this,arguments)||this;return n.isDataLogged=!1,n}return t(u,r),u.prototype.render=function(){var f=this,t=this.props,r=t.documents,c=t.pivot,l=t.maxResults,o=t.scenario,a=t.cfg,v=t.userInfo,y=t.query,p=t.personObjId,w=t.isInline,s=t.isSlim,h;if(r==null&&(r={data:null,error:null,isLoading:!1}),h=r.data,r.data==null||r.data.length===0)return i.renderSimpleProgress(r,o===n.GleamOption.People?"Documents":null,!0);this.isDataLogged||(this.isDataLogged=!0,this.instrumentData());var b=h.slice(0,l).map(function(n){return f.transformDocumentData(n)}),k=o===n.GleamOption.Documents,e=i.buildDocumentSeeMoreLink(y,p,k,c,v,a),d=function(){bfbInst.cLog(u.instEventId,"V",e.key);bfbTel.logClicked(n.EventScope.Document,"SM",e.key)};return React.createElement("div",null,React.createElement(i.DocumentList,{documents:b,showDetails:!w&&!s,isSlim:s,onMouseDown:function(n){return f.docClickInst(n,"N")},onDocModifiedMouseDown:function(n){return f.docClickInst(n,"MB")},onDocLocationMouseDown:function(n){return f.docClickInst(n,"L")}}),React.createElement(i.SeeMoreLink,{link:e,onMouseDown:d}))},u.prototype.instrumentData=function(){var i=this.props,r=i.documents,u=i.pivot,f=i.maxResults,t;r.data&&(t=0,r.data.forEach(function(i,r){r<f&&n.nullOrWs(i.HitHighlightedDescription)&&t++}),t>0&&(bfbInst.log("NoHhl","V",t.toString(),"P",n.DocumentSearchPivot[u]),bfbTel.logValue(n.EventScope.Document,"NoHitHighlighting",t,{Pivot:n.DocumentSearchPivot[u]})))},u.prototype.docClickInst=function(t,i){var r=this.props.pivot;bfbInst.cLog(u.instEventId,"I",t.toString(),"C",i,"P",n.DocumentSearchPivot[r]);bfbTel.logClicked(n.EventScope.Document,t,null,{C:i,P:r})},u.prototype.transformDocumentData=function(n){return{fileName:n.FileName,fileType:n.FileType,lastModifiedTime:this.getFormattedLastModifiedTime(n),lastModifiedBy:this.getDocModifiedBy(n),url:this.getDocUrl(n),location:this.getDocLocation(n),locationUrl:this.getDocLocationUrl(n),modifiedByUrl:this.getDocModifiedByUrl(n),hitHighlightHtml:this.getHitHighlight(n)}},u.prototype.getDocLocation=function(t){return n.buildDocLoc(t.PathArray,!0)},u.prototype.getDocLocationUrl=function(n){var t=n.PathArray;return t==null||t.length<1?null:"https://"+t.join("/")},u.prototype.getDocModifiedBy=function(n){return n.LastModifiedBy==null?null:n.LastModifiedBy.FullName},u.prototype.getDocModifiedByUrl=function(t){if(t.LastModifiedBy!=null){var i=t.LastModifiedBy,r=i.FullName,f=i.Email;return n.getUserUrl(r,f,u.docModifiedByFormCode)}return null},u.prototype.getDocUrl=function(n){return n.Url+"?web=1"},u.prototype.getHitHighlight=function(t){var i=t.HitHighlightedDescription,r,u;if(!n.nullOrWs(i)){r={"<c0>":"<strong>","<\/c0>":"<\/strong>","<ddd/>":"...","<t0/>":"","/r/n":""};for(u in r)r.hasOwnProperty(u)&&(i=i.replace(new RegExp(u,"g"),r[u]))}return i},u.prototype.getFormattedLastModifiedTime=function(t){var i=t.LastModifiedTime==null?t.LastAccessedTime:t.LastModifiedTime;return n.getFormattedTime(i)},u.instEventId="DC",u.docModifiedByFormCode="BAWMBL",u}(React.Component);i.DocumentsContainer=i.simpleConnect(r,u)})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(n){var i=n.cfg,t=n.documents;return{cfg:i,theme:i.tenantMetadata.theme,personName:t&&t.personName,keyword:t&&t.keyword,selectedPivot:t&&t.selectedPivot,documents:t&&t.files,allDocuments:t&&t.allFiles,showSingleTab:i.ft.d3s.e}},u=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.componentDidMount=function(){bfbTel.logShown(n.EventScope.Document,"DOCS")},u.prototype.render=function(){var t=this.props,f=t.theme,e=t.personName,o=t.keyword,r=t.selectedPivot,s=this.constructTitle(o,e),u=n.enumToArray(n.DocumentSearchPivot);return r==null&&(r=u[0]),React.createElement("div",null,React.createElement(i.SimpleHeader,{theme:f,title:s}),this.renderNavigationPivots(u,r),React.createElement("div",{className:"bw-pvtc"},this.renderDocuments(r)))},u.prototype.renderNavigationPivots=function(t,r){var e=this,u=this.props,o=u.showSingleTab,s=u.setDocumentsPivot,f;return o?null:(f=t.map(function(n){return{value:n,name:e.getPivotName(n)}}),React.createElement(i.NavigationPivots,{pivots:f,pivotInst:n.DocumentSearchPivot,selectedPivot:r,onClick:s}))},u.prototype.renderDocuments=function(t){var r=this.props,l=r.theme,a=r.personName,v=r.keyword,e=r.documents,o=r.allDocuments,h=r.gleamOption,s=r.cfg,c=r.showSingleTab,f=h===n.GleamOption.Documents?s.ft.docs.maxDocs:s.ft.docs.maxRecentDocs,u;return c?(u=o,(u.data==null||u.data.length==0)&&(u=e),React.createElement("div",{className:"bw-pvtc"},React.createElement(i.DocumentsContainer,{documents:u,pivot:n.DocumentSearchPivot.All,maxResults:f,isSlim:!1}))):React.createElement("div",{className:"bw-pvtc"},React.createElement(i.NavigationPivotWrapper,{pivot:n.DocumentSearchPivot.Personalized,selectedPivot:t},React.createElement(i.DocumentsContainer,{documents:e,pivot:n.DocumentSearchPivot.Personalized,maxResults:f,isSlim:!1})),React.createElement(i.NavigationPivotWrapper,{pivot:n.DocumentSearchPivot.All,selectedPivot:t},React.createElement(i.DocumentsContainer,{documents:o,pivot:n.DocumentSearchPivot.All,maxResults:f,isSlim:!1})))},u.prototype.constructTitle=function(t,i){return t!=null?""+n.strFormat(n.Strings.DocumentsAbout,t):i!=null?(i=n.toPascalCase(i),""+n.strFormat(n.Strings.DocumentsBy,i)):n.Strings.Documents},u.prototype.getPivotName=function(t){switch(t){case n.DocumentSearchPivot.Personalized:return n.Strings.Personalized;case n.DocumentSearchPivot.All:return n.Strings.AllResults}return""},u}(React.Component);i.DocumentSearchContainer=i.simpleConnect(r,u)})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.componentDidMount=function(){this.props.isVisible&&this.renderWhenReady();sb_st(function(){return sj_evt.fire(r.onBawFloorPlanLoaded)},500)},r.prototype.componentDidUpdate=function(){this.props.isVisible&&this.renderWhenReady()},r.prototype.render=function(){var n=this,t=this.props,r=t.officeLocation,i=t.showZoomButton,u=i?React.createElement("button",{onClick:function(){return n.onZoomIn()},className:"bw-fpNavZoomIn"}):null,f=i?React.createElement("button",{onClick:function(){return n.onZoomOut()},className:"bw-fpNavZoomOut"}):null;return React.createElement("div",{className:"bw-fp"},React.createElement("div",{ref:"container",className:"bw-fpIn"},React.createElement("div",{className:"bw-fpCont"},React.createElement("div",{className:"bw-fpTitle"},React.createElement("h2",null,r),this.renderBuildingLink()),React.createElement("div",{className:"bw-fpNav"},f,u,React.createElement("button",{onClick:function(){return n.onZoomReset()},className:"bw-fpNavZoomReset"})),React.createElement("canvas",{ref:"snapshotCanvas",id:"bw-drawingViewerSnapshot"}),React.createElement("canvas",{ref:"canvas",id:"bw-drawingViewer"}))))},r.prototype.renderBuildingLink=function(){var t=this.props,i=t.buildingMapUrl,r=t.onBuildingClick;return n.nullOrWs(i)?null:React.createElement("div",{className:"bw-fpBld"},React.createElement("span",{className:"bw-fpBldIcon"}),React.createElement("a",{href:i,onMouseDown:r},n.Strings.BuildingLocation))},r.prototype.getSnapshotElement=function(){return this.refs.snapshotCanvas},r.prototype.getCanvasElement=function(){return this.refs.canvas},r.prototype.resize=function(){var i=this.refs.container,r=this.getSnapshotElement(),f=this.getCanvasElement(),t={width:i.clientWidth,height:i.clientHeight},e=t.width-3+"px",u=t.height;return r.style.width=e,r.style.height=u-10+"px",f.style.height=3*u+"px",t.width>0&&t.height>0},r.prototype.renderWhenReady=function(){this.viewer==null&&this.resize()&&this.loadCanvas()},r.prototype.onZoomIn=function(){this.viewer!=null&&this.viewer.zoomIn()},r.prototype.onZoomOut=function(){this.viewer!=null&&this.viewer.zoomOut()},r.prototype.onZoomReset=function(){this.viewer!=null&&this.viewer.zoomExtents()},r.prototype.normalize=function(n){return n<.1?0:n},r.prototype.zoomToEntity=function(n,t,i){var f,e,u,o;if(t==null||t===NaN)return!1;if(f=t/2,n!=null&&n.d!=null&&(e=n.d.split("|"),e!=null&&e.length>0&&e[0]!=null&&(u=e[0].split(","),u!=null&&u.length===2&&u[0]!=null&&u[1]!=null))){var s=Number(u[0]),r=Number(u[1]),h=(r>f?r-f:f-r)*2;if(r=r>f?r-h:r+h,s!==NaN&&r!==NaN)return o={fromX:this.normalize(s-i),fromY:this.normalize(r-i),toX:this.normalize(s+i),toY:this.normalize(r+i)},this.viewer.zoomToBox(o.fromX,o.fromY,o.toX,o.toY),!0}return!1},r.prototype.loadCanvas=function(){var t=this,i=this.props.floorPlan,o=this.getSnapshotElement(),s=this.getCanvasElement(),f={canvasId:s.id,snapshotCanvasId:o.id,createCanvas:!1,showAllLayers:!1,invert:!1,highlightsAbovePlan:!1},u=i.floorData.metadata.dwf,e,r;u||(f.monochromeColour="#5c5c5c");this.viewer=new canvasviewer(f);this.viewer.addListener("wait",function(){return},this);this.viewer.addListener("resume",function(){return},this);this.viewer.addListener("refreshComplete",function(){t.renderingEventReported||(t.renderingEventReported=!0,sj_evt.fire(n.onBawFloorPlanRendered))},this);this.viewer.initPlan(i.floorData.floorplan);e=["A-BOMA","A-CASE-EXST","A-DOOR-CORE-EXST","A-DOOR-EXST","A-EQPM-EXST","A-FLOR-CORE-EVTR-EXST","A-FLOR-CORE-HRAL-EXST","A-FLOR-CORE-LEVL","A-FLOR-CORE-OVHD-EXST","A-FLOR-CORE-STRS-EXST","A-FLOR-HRAL-EXST","A-FLOR-SHEL-EXST","A-FLOR-SHEL-OTLN-EXST","A-FLOR-STRS-EXST","A-GLAZ-CORE-EXST","A-GLAZ-EXST","A-GLAZ-SHEL-EXST","A-GLAZ-SHEL-SILL-EXST","A-GLAZ-SILL-EXST","A-WALL-CORE-EXST","A-WALL-EXST","A-WALL-HEAD-EXST","A-WALL-MOVE-EXST","A-WALL-PRHT-EXST","A-WALL-SHEL-EXST","A-WALL-SHEL-HEAD-EXST","A-WALL-SHEL-PRHT-EXST","P-FIXT-EXST","RM","RM$","S-COLS-EXST","A-WALL-CORE-HEAD-EXST","A-DOOR-SHEL-EXST"];r={ehandles:[],layers:u?i.floorData.floorplan.lyrs.map(function(n){return n.n}):e,ents:i.floorData.floorplan.blks[0].ents};setTimeout(function(){var h,f,c,b,l,a,e,v,o,y,s,p,k,w,d,g;for(t.viewer.clearVisibleLayers(),h=i.floorData.metadata,f=0,c=r.layers;f<c.length;f++)b=c[f],t.viewer.addVisibleLayer(b);for(i.officeNumber!==""&&(r.ehandles=h.roomData.filter(function(n){return n.rm_id.value.trim()===i.officeNumber}).map(function(n){return n.ehandle.value})),l="rgba(0,0,0,0)",a="#FFFF00",e=0,v=h.roomData;e<v.length;e++)o=v[e],t.viewer.addHighlightEntity(o.ehandle.value,l,l,"",!0,!1),u||t.viewer.addLabel(o.ehandle.value,o.rm_id.value,"#000000",1,"Segoe UI Light");if(y=!1,r.ehandles.length>0){for(s=0,p=r.ehandles;s<p.length;s++)k=p[s],t.viewer.addHighlightEntity(k,a,a,"",!0,!1);r.ehandles.length===1&&(w=r.ents.filter(function(n){return n.h===r.ehandles[0]}),w.length===1&&u&&(d=u?50:350,g=parseFloat(i.floorData.floorplan.bnds.h),y=t.zoomToEntity(w[0],g,d)))}y||t.viewer.zoomExtents()},150)},r.onBawFloorPlanLoaded="onBawFloorPlanLoaded",r}(React.Component);i.FloorPlan=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(t){var f=t.cfg,u=t.people,o=t.userInfo,s=t.qrynf,e=t.dependency,h=u.card,i=n.Reducers.People.getHeroPersonState(t),r=i!=null&&i.floorPlan!=null?i.floorPlan.data:null;return{cfg:f,card:h,person:i,userInfo:o,floorPlan:r!=null?r.floorPlan:null,roomInfo:r!=null?r.roomInfo:null,isDependencyLoaded:n.Reducers.Dependency.isDependencyLoaded(e,n.ResourceDependency.FloorPlan),isDependencyLoading:n.Reducers.Dependency.isDependencyLoading(e,n.ResourceDependency.FloorPlan),isVisible:u.selectedPivot===n.PersonCardPivot.FloorPlan||u.selectedPivot==null&&s.intent===n.QueryIntent.Office,showZoomButton:!f.render.isInline}},u=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var o=this,r=this.props,s=r.cfg,h=r.card,t=r.person,c=r.roomInfo,u=r.floorPlan,l=r.isDependencyLoaded,a=r.isDependencyLoading,v=r.isVisible,y=r.showZoomButton,f,e;if(n.nullOrWs(h.heroPersonId)||t==null||t.data==null||t.floorPlan==null||u==null||u.floorData==null||!l){var p=t!=null&&t.floorPlan!=null?t.floorPlan.error:null,w=t==null||t.floorPlan==null||(t.floorPlan!=null?t.floorPlan.isLoading:!1)||a,b=n.Strings.FloorPlan.toLocaleLowerCase(),k=t!=null&&t.data!=null?t.data.FullName:null;return React.createElement(i.SimpleProgressContainer,{error:p,isLoading:w,queryOverwrite:b,searchTargetOverwrite:k})}return f=t.data.OfficeLocation,e=s.ft.bld.e?n.getBuildingMapUrl(c.buildingName):null,React.createElement(i.FloorPlan,{officeLocation:f,buildingMapUrl:e,onBuildingClick:function(){return o.clickInst("BLD")},isVisible:v,floorPlan:u,showZoomButton:y})},u.prototype.clickInst=function(t){bfbInst.cLog("FLP","V",t,"S","BLD");bfbTel.logClicked(n.EventScope.FloorPlan,t,"BLD")},u}(React.Component);i.FloorPlanContainer=i.simpleConnect(r,u)})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(i){function r(n){var t=i.call(this,n)||this;return t.onKeyDown=t.onKeyDown.bind(t),t.onDocumentClick=t.onDocumentClick.bind(t),t}return t(r,i),r.prototype.componentDidMount=function(){sj_be(_d,"click",this.onDocumentClick);sj_be(_d,"keydown",this.onKeyDown)},r.prototype.componentWillUnmount=function(){sj_ue(_d,"click",this.onDocumentClick);sj_ue(_d,"keydown",this.onKeyDown)},r.prototype.render=function(){var n=this.props,t=n.id,i=n.isOpen,r=n.children;return React.createElement("div",null,React.createElement("div",{id:t,className:i?"bw-gOpn":""},r))},r.prototype.onKeyDown=function(n){var t=this.props,i=t.isOpen,r=t.onNextItem,u=t.onPrevItem,f=t.onSelectItem;if(i)switch(n.keyCode){case 38:n.preventDefault();u();break;case 40:n.preventDefault();r();break;case 13:f()}},r.prototype.onDocumentClick=function(t){var i=this.props,r=i.isOpen,u=i.onDismiss,f=i.labelId;r&&!n.hasAncestor(t.target,f,2)&&u()},r}(React.Component);i.Gleam=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(n){var t=n.searchScenario,i=n.gleam,r=n.cfg,u=n.appRouter;return{searchScenario:t,gleam:i,cfg:r,ranking:u.ranking}},f=function(u){function f(n){var t=u.call(this,n)||this;return t.labelClick=t.labelClick.bind(t),t.dropDownClick=t.dropDownClick.bind(t),t.selectDropOption=t.selectDropOption.bind(t),t.instClick=t.instClick.bind(t),t}return t(f,u),f.prototype.componentDidMount=function(){bfbTel.logShown(n.EventScope.Gleam,"GLM")},f.prototype.render=function(){var t=this,n=this.props,u=n.gleam,f=n.cfg,o=n.closeGleam,s=n.searchScenario,h=r.getEnabledGleamOptions(f),e={id:"bw-glmOpt",isOpen:u.isOpen,labelId:"bw-gLabl",onDismiss:o,onPrevItem:function(){return t.moveDropOption(-1)},onNextItem:function(){return t.moveDropOption(1)},onSelectItem:this.selectDropOption};return React.createElement(r.Gleam,i({},e),React.createElement(r.GleamLabel,{id:e.labelId,icon:f.tenantMetadata.iconSmall,text:r.getGleamItemName(s),isSeparated:this.isSeparated(),onLabelClick:this.labelClick,onDropDownClick:this.dropDownClick}),React.createElement(r.GleamDropList,null,h.map(function(n){return React.createElement(r.GleamDropItem,{key:n,text:r.getGleamItemName(n),isSelected:u.dropOption===n,option:n,onClick:function(){return t.selectDropOption(n)}})})))},f.prototype.labelClick=function(){var t=this.props,i=t.ranking,r=t.setRanking;this.isSeparated()&&(this.instClick(),r({placement:n.AnswerPlacement.Pole,treatment:i!=null?i.treatment:null,rankingRuleId:n.RankingRuleId.UserExplicit}))},f.prototype.dropDownClick=function(){this.instClick();var n=this.props.toggleGleam;n()},f.prototype.isSeparated=function(){var n=this.props,t=n.ranking,i=n.gleam;return r.shouldGleamLabelOpenAnswer(t,i.dropOption)},f.prototype.instClick=function(t){bfbInst.cLog("GC","V",t==null?"":n.GleamOption[t]);bfbTel.logClicked(n.EventScope.Gleam,t)},f.prototype.selectDropOption=function(n){var t=this.props,u=t.gleam,f=t.setSearchScenario,e=t.setGleamOption,o=t.ranking,s=t.closeGleam,i;if(!r.shouldGleamOpenAnswer(o,n,u.dropOption)){s();return}i=n!=null?n:u.dropOption;this.instClick(i);i!=null&&(f(i),e(i))},f.prototype.moveDropOption=function(n){var u=this.props,e=u.gleam,o=u.cfg,s=u.setGleamDropOption,t=r.getEnabledGleamOptions(o),i,f;t.length<1||(i=e.dropOption!=null?t.indexOf(e.dropOption):0,i<0&&(i=0),f=t[(i+n+t.length)%t.length],f!=null&&s(f))},f}(React.Component);r.GleamContainer=r.simpleConnect(u,f)})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){var t=this.props,i=t.text,r=t.option,u=t.isSelected,f=t.onClick;return React.createElement("li",{onClick:f,className:u?"bw-selected":""},React.createElement("div",{className:"bw-gIcon "+n.getGleamItemIconClassName(r)}),React.createElement("div",null,React.createElement("span",null,i)))},r}(React.Component);n.GleamDropItem=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(n){function i(){return n!==null&&n.apply(this,arguments)||this}return t(i,n),i.prototype.render=function(){var n=this.props.children;return React.createElement("ul",null,n)},i}(React.Component);n.GleamDropList=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){var t=this.props,i=t.id,r=t.icon,u=t.text,f=t.isSeparated,e=t.onLabelClick,o=t.onDropDownClick,s=n.imgSrc(r,"png",!1);return React.createElement("div",{id:i,className:f?"bw-gs":"bw-gns"},React.createElement("div",{className:"bw-gTxt",onClick:e},React.createElement("img",{id:"bw-glmIcon",src:s}),React.createElement("div",{id:"bw-glmTxt"},u)),this.renderSeparator(),React.createElement("div",{className:"bw-gIconCtnr",onClick:o},React.createElement("div",{className:"bw-gIcon bw-gExp"})))},r.prototype.renderSeparator=function(){var n=this.props,t=n.onLabelClick,i=n.isSeparated,r=i?null:t;return React.createElement("div",{className:"bw-gSep",onClick:t},"|")},r}(React.Component);i.GleamLabel=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(n){function i(){return n!==null&&n.apply(this,arguments)||this}return t(i,n),i.prototype.render=function(){var t=this.props,n=t.data,i=t.onMouseDown;return React.createElement("li",null,React.createElement("div",{className:"bw-liCol1"},React.createElement("div",{className:"bw-liInfo"},React.createElement("a",{href:n.url,title:n.subject,onMouseDown:i},React.createElement("div",{className:"bw-tnc bw-ttl"},n.subject)),React.createElement("div",null,React.createElement("div",{className:"bw-meta bw-tnc",title:n.uniqueSenders},n.uniqueSenders),React.createElement("div",{className:"bw-meta"},n.receivedTime)))),React.createElement("div",{className:"bw-liCol2"},React.createElement("p",{className:"bw-meta"},n.bodyPreview)))},i}(React.Component);n.Conversation=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){var t=this.props,i=t.data,r=t.onMouseDown;return React.createElement("ul",{className:"bw-list"},i.map(function(t,i){return React.createElement(n.Conversation,{key:i,data:t,onMouseDown:r})}))},r}(React.Component);n.ConversationList=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(t){var i=t.cfg,u=t.group,r=t.qrynf;return{cfg:i,group:n.Reducers.Group.getHeroGroup(t),groupDetails:n.Reducers.Group.getAsyncHeroGroupDetails(t),queryIntent:r.intent}},f=function(u){function f(){var n=u!==null&&u.apply(this,arguments)||this;return n.compleationEventFired=!1,n}return t(f,u),f.prototype.render=function(){var n=this.buildInfoProps(),t=this.buildSeeMoreLinkProps();return React.createElement("div",{className:"bw-grpAbt"},React.createElement(r.Info,i({},n)),React.createElement(r.SeeMoreLink,i({},t)))},f.prototype.componentDidMount=function(){this.reportRenderCompleation()},f.prototype.componentDidUpdate=function(){this.reportRenderCompleation()},f.prototype.buildInfoProps=function(){var i=this.props,o=i.group,t=i.groupDetails,u=i.queryIntent,s=[r.createOtherInfo(o.Description,"Description",null,u),r.createOtherInfo(o.Mail,"Email",null,u,n.DataType.Email),r.createOtherInfo(n.Strings.Loading,"GroupOwners",null,u,n.DataType.GroupOwners)],e=t!=null?t.data:null,h={isLoading:t==null||t.isLoading,owners:e!=null&&e.GroupOwners!=null?e.GroupOwners.map(function(t){return{fullName:t.FullName,requeryUrl:n.getUserUrl(t.FullName,t.UserPrincipalName,f.groupOwnerForm)}}):null};return{items:r.getValidInfoItems(s),groupOwners:h,onMouseDown:function(t){bfbInst.cLog("ABT","V",t,"S","GRP");bfbTel.logClicked(n.EventScope.Group,t,"GRP")}}},f.prototype.buildSeeMoreLinkProps=function(){var t=this.props,i=t.cfg,r=t.group;return{link:{url:n.strFormat(i.ft.grpsrch.mailLink,r.Mail),displayText:n.Strings.SeeMoreOnOffice},onMouseDown:function(){bfbInst.cLog("ABT","V","SM","S","GRP");bfbTel.logClicked(n.EventScope.Group,"SM","GRP")}}},f.prototype.reportRenderCompleation=function(){var n=this.props.groupDetails;n==null||n.isLoading||(this.compleationEventFired=!0,sj_evt.fire(f.onBawGroupAboutRendered))},f.groupOwnerForm="BAWGRM",f.onBawGroupAboutRendered="onBawGroupAboutRendered",f}(React.Component);r.GroupAboutContainer=r.simpleConnect(u,f)})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(t){var i=t.cfg,r=n.Reducers.Group.getHeroGroupState(t),u=r.data,f=r.groupConversations;return{maxResults:i.ft.grpsrch.maxConvo,conversationLinkFormat:i.ft.grpsrch.convoLink,seeMoreLinkFormat:i.ft.grpsrch.mailLink,conversations:f,group:u}},f=function(u){function f(){return u!==null&&u.apply(this,arguments)||this}return t(f,u),f.prototype.render=function(){var n=this.props.conversations;return n==null||n.data==null||n.data.length===0?r.renderSimpleProgress(n,"GroupConversations"):React.createElement("div",{className:"bw-grpCvn"},this.renderConversationList(),this.renderSeeMoreLink())},f.prototype.renderConversationList=function(){var i=this,t=this.props,u=t.conversations,f=t.conversationLinkFormat,e=t.group,o=t.maxResults,s=u.data.filter(function(t){return t!=null&&!n.nullOrWs(t.ItemId)&&!n.nullOrWs(t.EmailSubject)}).slice(0,o).map(function(t){return{subject:t.EmailSubject,bodyPreview:t.BodyPreview,url:n.strFormat(f,t.ItemId.replace(/_/g,"%2B"),e.Mail),receivedTime:n.getFormattedTime(t.ReceivedOnDateTime),uniqueSenders:t.UniqueSenders==null?"":t.UniqueSenders.join("; ")}}),h=function(){return i.clickInst()};return React.createElement(r.ConversationList,{data:s,onMouseDown:h})},f.prototype.clickInst=function(t){t!=null?bfbInst.cLog(f.instEvtId,"V",t):bfbInst.cLog(f.instEvtId);bfbTel.logClicked(n.EventScope.Group,t,"GCONV")},f.prototype.renderSeeMoreLink=function(){var u=this,t=this.props,f=t.seeMoreLinkFormat,e=t.group,o={link:{url:n.strFormat(f,e.Mail),displayText:n.Strings.SeeMoreOnOffice},onMouseDown:function(){return u.clickInst("SM")}};return React.createElement(r.SeeMoreLink,i({},o))},f.instEvtId="GRPCONV",f}(React.Component);r.GroupConversationsContainer=r.simpleConnect(u,f)})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(t){var i=t.cfg,r=t.qrynf;return{groups:n.Reducers.Group.getAllGroups(t),theme:i.tenantMetadata.theme,query:r.qry}},f=function(u){function f(){return u!==null&&u.apply(this,arguments)||this}return t(f,u),f.prototype.componentDidMount=function(){bfbTel.logShown(n.EventScope.Group,"GDSMG")},f.prototype.render=function(){var t=this.props,u=t.groups,f=t.theme,e=t.query,o=t.setHeroGroupId,s=t.showHeroGroup,h=t.setRanking,c={theme:f,title:n.strFormat(n.Strings.ResultsFor,e)},l={data:u,onGroupClick:function(t){o(t);s();h({placement:n.AnswerPlacement.Pole,treatment:n.Treatment.Group,rankingRuleId:n.RankingRuleId.UserExplicit})},onGroupMouseDown:function(){bfbInst.cLog("GDSMG");bfbTel.logClicked(n.EventScope.Group,"GDSMG")}};return React.createElement("div",null,React.createElement(r.SimpleHeader,i({},c)),React.createElement(r.GroupDisambigList,i({},l)))},f}(React.Component);r.GroupDisambigContainer=r.simpleConnect(u,f)})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){var n=this,t=this.props.data;return React.createElement("div",{id:"bw-dg"},React.createElement("table",null,React.createElement("tbody",null,t.map(function(t,i){return React.createElement("tr",{key:i},n.renderInfoColumn(t),n.renderDescriptionColumn(t))}))))},r.prototype.renderInfoColumn=function(t){var i=this.props,r=i.onGroupMouseDown,u=i.onGroupClick;return React.createElement("td",{className:"bw-dgInfo bw-tnc",onClick:function(){return u(t.Id)},onMouseDown:r},React.createElement(n.ProfileImageContainer,{groupId:t.Id}),React.createElement("a",{title:t.DisplayName},React.createElement("span",{id:"bw-dgTtl"},t.DisplayName)))},r.prototype.renderDescriptionColumn=function(n){return React.createElement("td",{className:"bw-dgDesc bw-tnc",title:n.Description},n.Description)},r}(React.Component);n.GroupDisambigList=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(t){var i=t.cfg,r=n.Reducers.Group.getHeroGroupState(t),u=r.groupFiles,f=r.data;return{maxResults:i.ft.grpsrch.maxFile,seeMoreLinkFormat:i.ft.grpsrch.fileLink,files:u,group:f}},f=function(u){function f(){return u!==null&&u.apply(this,arguments)||this}return t(f,u),f.prototype.render=function(){var u=this,e=this.props,o=e.group,t=e.files,s=e.maxResults,h=e.seeMoreLinkFormat;if(t==null||t.data==null||t.data.length===0)return r.renderSimpleProgress(t,"GroupFiles");var c=t.data,l=c.slice(0,s).map(function(n){return u.transformDocumentData(n)}),a={link:r.buildGroupDocSeeMoreLinkUrl(h,o,t.data),onMouseDown:function(){bfbInst.cLog(f.instEvtId,"V","SM");bfbTel.logClicked(n.EventScope.Group,"SM","GFL")}};return React.createElement("div",{className:"bw-grpFile"},React.createElement(r.DocumentList,{documents:l,showDetails:!0,isSlim:!1,onMouseDown:function(){return u.clickInst()},onDocModifiedMouseDown:function(){return u.clickInst("MB")},onDocLocationMouseDown:function(){return u.clickInst("L")}}),React.createElement(r.SeeMoreLink,i({},a)))},f.prototype.getLocation=function(t){var i=t.Url.replace(/.*?:\/\//g,""),r=i.split("/");return n.buildDocLoc(r,!0)},f.prototype.transformDocumentData=function(t){return{fileName:t.Title,fileType:r.getDocType(t.Title,t.IsFolder),lastModifiedTime:n.getFormattedTime(t.LastModifiedTime),lastModifiedBy:t.LastModifiedBy!=null&&t.LastModifiedBy.GivenName!=null?t.LastModifiedBy.GivenName:"",url:t.Url,location:this.getLocation(t),locationUrl:t.Url}},f.prototype.clickInst=function(t){t!=null?bfbInst.cLog(f.instEvtId,"V",t):bfbInst.cLog(f.instEvtId);bfbTel.logClicked(n.EventScope.Group,"GFL",t)},f.instEvtId="GRPFILE",f}(React.Component);r.GroupFilesContainer=r.simpleConnect(u,f)})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){var n=this,t=this.props.groups;return React.createElement("ul",{className:"bw-list"},t.map(function(t,i){return n.renderGroup(t,i)}))},r.prototype.renderGroup=function(t,i){var u=this.props.onGroupMouseDown,r=t.group;return React.createElement("li",{key:i},React.createElement("div",{className:"bw-liCol1"},React.createElement("div",{className:"bw-liInfo"},React.createElement("a",{href:t.url,title:r.DisplayName,onMouseDown:u},React.createElement(n.ProfileImageContainer,{groupId:t.group.Id}),React.createElement("div",{className:"bw-tnc bw-ttl"},r.DisplayName)))),React.createElement("div",{className:"bw-liCol2"},React.createElement("p",null,r.Description)))},r}(React.Component);n.GroupList=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(t){var i=t.cfg,f=t.photo,r=n.Reducers.Group.getHeroGroupState(t),u=r.data,e=r.groupMembers;return{cfg:i,groupId:u.Id,members:e,seeMoreLinkUrl:n.strFormat(i.ft.grpsrch.memLink,u.Mail),photoState:f}},f=function(u){function f(){return u!==null&&u.apply(this,arguments)||this}return t(f,u),f.prototype.render=function(){var u=this.props,t=u.members,e=u.seeMoreLinkUrl;if(t==null||t.data==null||t.data.length===0)return r.renderSimpleProgress(t,"GroupMembers");var o=t.data,s=this.buildNameCards(o),h={link:{url:e,displayText:n.Strings.SeeMoreOnOffice},onMouseDown:function(){bfbInst.cLog(f.instEvtId,"V","SM");bfbTel.logClicked(n.EventScope.Group,"SM","GMBR")}};return React.createElement("div",{className:"bw-grpMem"},s.map(function(n,t){return React.createElement("div",{key:t,className:"bw-tile"},React.createElement(r.NameCard,i({},n)))}),React.createElement(r.SeeMoreLink,i({},h)))},f.prototype.buildNameCards=function(t){var u=this.props,i=u.cfg,e=u.photoState;return t.filter(function(t){return t!=null&&!n.nullOrWs(t.FullName)&&!n.nullOrWs(t.Email)}).slice(0,i.ft.grpsrch.maxMem).map(function(t){var u=e.personPhotos[t.Email],o=r.getNameCardModelFromGroupMember(t);return{url:n.getUserUrl(t.FullName,t.UserPrincipalName,f.memberForm),imageSrc:n.nullOrWs(u)?i.defaultProfileImage.url:n.imgSrc(u),enableOrgCount:i.ft.org.orgCount,type:n.NameCardType.GroupMember,model:o,onMouseDown:function(){bfbInst.cLog(f.instEvtId,"V","SM");bfbTel.logClicked(n.EventScope.Group,"SM","GMBR")},disablePresence:!i.ft.skyint.enableNonHeroPresence}})},f.memberForm="BAWGRM",f.instEvtId="GRPM",f}(React.Component);r.GroupMembersContainer=r.simpleConnect(u,f)})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(t){var r=t.cfg,i=n.Reducers.People.getHeroPersonState(t),u=i!=null&&i.groups!=null?i.groups:null;return{cfg:r,groups:u}},u=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var r=this,f=this.props,e=f.cfg,t=f.groups,o,s;return t==null||t.data==null||t.data.length===0?i.renderSimpleProgress(t,"Groups"):(o=this.buildSeeMoreLink(t.data,e),s=t.data.slice(0,e.ft.pgrp.maxGrp).map(function(t){return{group:t,url:n.getGroupUrl(t.DisplayName,t.Id,u.groupForm)}}),React.createElement("div",{className:"bw-pgrp"},React.createElement(i.GroupList,{groups:s,onGroupMouseDown:function(){return r.clickInst()}}),React.createElement(i.SeeMoreLink,{link:o,onMouseDown:function(){return r.clickInst("SM")}})))},u.prototype.clickInst=function(t){t==null?bfbInst.cLog(u.instEvtId):bfbInst.cLog(u.instEvtId,"V",t);bfbTel.logClicked(n.EventScope.Group,t)},u.prototype.buildSeeMoreLink=function(t,i){if(t.length===0)return null;var r=n.strFormat(i.ft.grpsrch.mailLink,t[0].Mail);return{displayText:n.Strings.SeeMoreOnOffice,url:r,key:"SeeMoreOnOffice"}},u.instEvtId="PGRP",u.groupForm="BAWGRC",u}(React.Component);i.GroupsContainer=i.simpleConnect(r,u)})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(t){var i=t.cfg,r=t.qrynf;return{cfg:i,heroGroup:n.Reducers.Group.getHeroGroup(t),selectedPivot:n.Reducers.Group.getGroupSelectedPivot(t),queryIntent:r.intent}},f=function(u){function f(n){return u.call(this,n)||this}return t(f,u),f.prototype.componentDidMount=function(){bfbTel.logShown(n.EventScope.Group,"GRP")},f.prototype.render=function(){var f=this.buildHeaderProps(),u=this.buildNavigationPivotsProps(),t=u.selectedPivot;return React.createElement("div",{className:"bw-grp"},React.createElement(r.Header,i({},f)),React.createElement(r.NavigationPivots,i({},u)),React.createElement("div",{className:"bw-pvtc"},React.createElement(r.NavigationPivotWrapper,{pivot:n.GroupSearchPivot.GroupAbout,selectedPivot:t},React.createElement(r.GroupAboutContainer,null)),React.createElement(r.NavigationPivotWrapper,{pivot:n.GroupSearchPivot.Members,selectedPivot:t},React.createElement(r.GroupMembersContainer,null)),React.createElement(r.NavigationPivotWrapper,{pivot:n.GroupSearchPivot.Files,selectedPivot:t},React.createElement(r.GroupFilesContainer,null)),React.createElement(r.NavigationPivotWrapper,{pivot:n.GroupSearchPivot.Conversations,selectedPivot:t},React.createElement(r.GroupConversationsContainer,null))))},f.prototype.getPivotName=function(t){switch(t){case n.GroupSearchPivot.GroupAbout:return n.Strings.About;case n.GroupSearchPivot.Members:return n.Strings.Members;case n.GroupSearchPivot.Files:return n.Strings.Files;case n.GroupSearchPivot.Conversations:return n.Strings.Conversations}return""},f.prototype.buildHeaderProps=function(){var i=this.props,r=i.cfg,t=i.heroGroup;return t==null?null:{theme:r.tenantMetadata.theme,title1:t.DisplayName,title2:n.Strings.Group,groupId:t.Id,email:t.Mail,clickInst:function(t){bfbInst.cLog("GHEAD","V",t);bfbTel.logClicked(n.EventScope.Group,t,"GHEAD")}}},f.prototype.buildNavigationPivotsProps=function(){var f=this,t=this.props,i=t.selectedPivot,e=t.setGroupPivot,o=t.queryIntent,s=n.enumToArray(n.GroupSearchPivot),r,u;return i==null&&(i=this.getDefaultPivot(o,n.GroupSearchPivot.GroupAbout)),r=s.map(function(n){return{value:n,name:f.getPivotName(n)}}),u={pivots:r,pivotInst:n.GroupSearchPivot,selectedPivot:i,onClick:e},u},f.prototype.getDefaultPivot=function(t,i){switch(t){case n.QueryIntent.GroupMembers:return n.GroupSearchPivot.Members;case n.QueryIntent.GroupFiles:return n.GroupSearchPivot.Files;case n.QueryIntent.GroupConversations:return n.GroupSearchPivot.Conversations}return i},f}(React.Component);r.GroupSearchContainer=r.simpleConnect(u,f)})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(u){function f(){return u!==null&&u.apply(this,arguments)||this}return t(f,u),f.prototype.render=function(){var n=this.props,t=n.heroGroup,u=n.bestMatchGroup,f=n.isVisible,e=n.showAllMatch,o=n.showLogo,s=n.logoBase64;if(t==null||u==null)return null;var h=this.buildGroupDisambigMessageProps(e),c={showLogo:o,base64Img:s},l={isVisible:f,disambigMessageProps:h,companyLogoProps:c};return React.createElement(r.DisambigNotification,i({},l))},f.prototype.buildGroupDisambigMessageProps=function(t){var i=this.props,e=i.query,c=i.heroGroup,o=i.heroGroupId,u=i.bestMatchGroup,f=i.setHeroGroupId,s=i.showGroupDisambig,h=i.showHeroGroup;return{isBestMatchClickable:u.Id!=o,bestMatch:u.DisplayName,bestWorkMatchIs:r.getBestWorkMatchIsParts(),showAllMatch:t,allMatch:e,viewAllMatchesFor:r.getViewAllMatchesForParts(),onBestMatchClick:function(t){t.preventDefault();f(u.Id);h();bfbInst.cLog("BMC","V","GRP");bfbTel.logClicked(n.EventScope.Group,"BMC","GDSMG")},onAllMatchClick:function(t){t.preventDefault();s();f(null);bfbInst.cLog("AMC","V","GRP");bfbTel.logClicked(n.EventScope.Group,"AMC","GDSMG")}}},f}(React.Component);r.GroupDisambigNotification=u})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(t){var i=t.cfg,r=t.qrynf,u=t.searchScenario,f=t.appRouter,e=t.ans;return{tenantIconSmall:i.tenantMetadata.iconSmall,query:r.qry,searchScenario:u,ranking:f.ranking,isNotificationVisible:e.mainline.isNotificationVisible,numGroups:n.Reducers.Group.getGroupsCount(t),heroGroup:n.Reducers.Group.getHeroGroup(t),heroGroupId:n.Reducers.Group.getHeroGroupId(t),bestMatchGroup:n.Reducers.Group.getBestMatchGroup(t),numPeople:n.Reducers.People.getPeopleCount(t),heroPerson:n.Reducers.People.getHeroPerson(t),heroPersonId:n.Reducers.People.getHeroPersonId(t),bestMatchPerson:n.Reducers.People.getBestMatchPerson(t)}},f=function(u){function f(){return u!==null&&u.apply(this,arguments)||this}return t(f,u),f.prototype.render=function(){var t=this.props,i=t.isNotificationVisible,r=t.searchScenario;if(!i)return null;switch(r){case n.GleamOption.People:return this.renderPersonDisambigNotification();case n.GleamOption.Group:return this.renderGroupDisambigNotification()}return null},f.prototype.renderPersonDisambigNotification=function(){var t=this.props,o=t.query,u=t.ranking,f=t.numPeople,s=t.heroPerson,h=t.heroPersonId,c=t.bestMatchPerson,l=t.tenantIconSmall,a=t.setHeroPersonId,v=t.showHeroPerson,y=t.showPersonDisambig,e=u!=null&&u.placement===n.AnswerPlacement.Pole,p=u!=null&&u.placement!==n.AnswerPlacement.None&&e&&f>1,w=f>1,b=!e,k={query:o,heroPerson:s,heroPersonId:h,bestMatchPerson:c,setHeroPersonId:a,showHeroPerson:v,showPersonDisambig:y,isVisible:p,showAllMatch:w,showLogo:b,logoBase64:l};return React.createElement("div",{id:"bw-ntfCtnr"},React.createElement(r.PersonDisambigNotification,i({},k)))},f.prototype.renderGroupDisambigNotification=function(){var t=this.props,e=t.query,u=t.ranking,f=t.numGroups,o=t.heroGroup,s=t.heroGroupId,h=t.bestMatchGroup,c=t.tenantIconSmall,l=t.setHeroGroupId,a=t.showHeroGroup,v=t.showGroupDisambig,y=u!=null&&u.placement!==n.AnswerPlacement.None&&f>1,p=f>1,w=u.placement!=n.AnswerPlacement.Pole,b={query:e,heroGroup:o,heroGroupId:s,bestMatchGroup:h,logoBase64:c,setHeroGroupId:l,showHeroGroup:a,isVisible:y,showAllMatch:p,showLogo:w,showGroupDisambig:v};return React.createElement(r.GroupDisambigNotification,i({},b))},f}(React.Component);r.NotificationContainer=r.simpleConnect(u,f)})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(u){function f(){return u!==null&&u.apply(this,arguments)||this}return t(f,u),f.prototype.render=function(){var n=this.props,t=n.showAllMatch,u=n.bestMatchPerson,f=n.isVisible,e=n.showLogo,o=n.logoBase64;if(u==null)return null;var s=this.buildPersonDisambigMessageProps(t),h={showLogo:e,base64Img:o},c={isVisible:f,disambigMessageProps:s,companyLogoProps:h};return React.createElement(r.DisambigNotification,i({},c))},f.prototype.buildPersonDisambigMessageProps=function(t){var i=this.props,e=i.query,o=i.heroPersonId,u=i.bestMatchPerson,f=i.setHeroPersonId,s=i.showHeroPerson,h=i.showPersonDisambig,c=i.showLogo;return{isBestMatchClickable:c||o!==u.ObjectId,bestMatch:r.getFormattedPersonTitle(u),bestWorkMatchIs:r.getBestWorkMatchIsParts(),showAllMatch:t,allMatch:e,viewAllMatchesFor:r.getViewAllMatchesForParts(),onBestMatchClick:function(t){t.preventDefault();f(u.ObjectId);s();bfbInst.cLog("BMC","V","PRSN");bfbTel.logClicked(n.EventScope.Person,"BMC","PDSMG")},onAllMatchClick:function(t){t.preventDefault();h();f(null);bfbInst.cLog("AMC","V","PRSN");bfbTel.logClicked(n.EventScope.Person,"AMC","PDSMG")}}},f}(React.Component);r.PersonDisambigNotification=u})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(t){var i=t.cfg,r=t.qrynf,u=t.people;return{cfg:i,orgChart:n.Reducers.People.getAsyncHeroPersonOrgChartState(t),hero:n.Reducers.People.getHeroPerson(t),isSkipManagersVisible:n.Reducers.Answer.getMainlineOrgChartIsSkipManagersVisible(t),isSkipExpanderHoverVisible:n.Reducers.Answer.getMainlineOrgChartIsExpanderHoverVisible(t),floorPlanState:n.Reducers.People.getHeroPersonFloorPlanState(t),qrynf:r,forceOrgMetaWrap:u.forceWrapDirectReportsMeta}},f=function(u){function f(n){var t=u.call(this,n)||this;return t.onExpanderClick=t.onExpanderClick.bind(t),t.inPlaceRequery=t.inPlaceRequery.bind(t),t}return t(f,u),f.prototype.render=function(){var n=this.props,t=n.orgChart,o=n.hero,s=n.cfg,h=n.qrynf;if(t==null||t.data==null)return r.renderSimpleProgress(t,"OrganizationChart");var i=t.data,u=i.peers,f=i.managers,e=i.directs;return React.createElement("div",{className:"bw-org"},this.renderManagementChain(f,u.length),this.renderHero(o,u,f,e),this.renderDirectReports(e),this.renderDrWhomLink(h,s.ft.org.drWhomUrl))},f.prototype.getFloorPlanInfo=function(){var r=this.props,u=r.cfg,i=r.floorPlanState,t;return!u.ft.fp.e||i==null||i.floorPlan==null?null:(t=i.roomInfo,{buildingName:t.buildingName,officeNumber:t.officeNumber,buildingMapUrl:u.ft.bld.e?n.getBuildingMapUrl(t.buildingName):null,requeryUrl:null,activateFloorPlan:null})},f.prototype.renderHero=function(t,u,e,o){var h=this.props,s=h.cfg,c=h.setPersonPivot,l={cfg:s,hero:t,peers:u,directs:o,manager:n.getNOrDefault(e,0),theme:s.tenantMetadata.theme,isFloorPlanEnabled:s.ft.fp.e,floorPlanInfo:this.getFloorPlanInfo(t),buildingInfo:r.buildBuildingInfo(s,t),onFloorPlanClick:function(){return c(n.PersonCardPivot.FloorPlan)},onNameCardClick:function(){return c(n.PersonCardPivot.PersonAbout)},onPeerClick:this.inPlaceRequery,maxShownPeers:6,useDirectLink:s.ft.org.dirLink,userLinkFormCode:f.formCode,enableNonHeroPresence:s.ft.skyint.enableNonHeroPresence};return React.createElement(r.OrgChartHero,i({},l))},f.prototype.instClick=function(t,i){bfbInst.instOrgChartClick(n.OrgChartPersonType[t],i);bfbTel.logClicked(n.EventScope.OrgChart,t,null,{ACT:i})},f.prototype.inPlaceRequery=function(t,i){i===void 0&&(i=n.QueryIntent.OrgChart);var r=this.props,u=r.searchPeopleInplace,f=r.setMainlineAnswerNotificationVisibility;u(t.FullName,t.UPN,t.ObjectId,i);f(!1)},f.prototype.buildOrgChartPersonProps=function(t,i){var s=this,l=this.props,o=l.cfg,p=l.setPersonPivot,u=i.person,a=i.type,v=i.numDirects,w=i.showActionButtons,b=i.showLine,y=t==n.NameCardType.OrgDirect||t==n.NameCardType.OrgManager?o.tenantMetadata.customInfoConfig:null,c=r.getNameCardModelFromPerson(u,y),h,e;return c.directReportsCount!=null||!v||(c.directReportsCount=v.toString()),h={enableOrgCount:o.ft.org.orgCount,type:t,model:c,onMouseDown:function(){return s.instClick(a)},fullNameTextColor:o.tenantMetadata.theme,underlineOrgInfo:y!=null},e=w?{person:u,instClick:function(n){return s.instClick(a,n)},isFloorPlanEnabled:o.ft.fp.e}:null,o.ft.org.dirLink?(h.url=n.getUserUrl(u.FullName,u.UPN,f.formCode,n.QueryIntent.OrgChart),e!=null&&(e.floorPlanUrl=n.getUserUrl(u.FullName,u.UPN,f.formCode,n.QueryIntent.Office))):(h.onClick=function(){return s.inPlaceRequery(u)},e!=null&&(e.onFloorPlanClick=function(){s.inPlaceRequery(u,n.QueryIntent.Office);p(n.PersonCardPivot.FloorPlan)})),{nameCardProps:h,lineProps:b?f.verticalLineProps:null,actionButtonsProps:e}},f.prototype.onExpanderClick=function(){var t=this.props,i=t.setMainlineAnswerOrgChartSkipManagersVisibility,r=t.isSkipManagersVisible;i(!r);bfbInst.instOrgChartClick();bfbTel.logClicked(n.EventScope.OrgChart,"EXP")},f.prototype.renderManagementChain=function(t,u){var o=this;if(t==null||t.length===0)return null;var f=this.props,s=f.isSkipManagersVisible,h=f.isSkipExpanderHoverVisible,c=f.setMainlineAnswerOrgChartExpanderHoverVisibility,l=f.cfg,a=t[0],v={person:a,type:n.OrgChartPersonType.Manager,showLine:!0,showActionButtons:!0,numDirects:u+1},y=this.buildOrgChartPersonProps(n.NameCardType.OrgManager,v),e=t.length>1?t.slice(1,t.length):null,p=e!=null?e.reverse().map(function(t){var i={person:t,type:n.OrgChartPersonType.SkipLevelManager,showLine:!0,showActionButtons:!1};return o.buildOrgChartPersonProps(n.NameCardType.OrgSkipManager,i)}):null,w={managerProps:y,skipManagersProps:p,isSkipManagersVisible:s,onExpanderClick:this.onExpanderClick,setExpanderHoverVisibility:c,isExpanderHoverVisibile:h,enableNonHeroPresence:l.ft.skyint.enableNonHeroPresence};return React.createElement(r.OrgChartManagementChain,i({},w))},f.prototype.renderDirectReports=function(t){var o=this,u=this.props,e=u.cfg,a=u.hero,s=u.forceOrgMetaWrap,h=u.setOrgChartWrapDirectMeta,c=t.map(function(t){var i={person:t,type:n.OrgChartPersonType.SkipLevelManager,showLine:!1,showActionButtons:!0};return o.buildOrgChartPersonProps(n.NameCardType.OrgDirect,i)}),l={theme:e.tenantMetadata.theme,verticalLineProp:f.verticalLineProps,horizontalLineProp:f.horizontalLineProps,directReportsPersonProps:c,numColumns:2,enableNonHeroPresence:e.ft.skyint.enableNonHeroPresence,forceOrgMetaWrap:s,setOrgChartWrapDirectMeta:h};return React.createElement(r.OrgChartDirectReports,i({},l))},f.prototype.renderDrWhomLink=function(t,i){var r=this;if(i!=null&&i.length>0)return React.createElement("div",{className:"bw-drwhom"},React.createElement("a",{href:i,onClick:function(){return r.instDrWhomLink()}},n.Strings.DrWhomLinkText))},f.prototype.instDrWhomLink=function(){bfbInst.cLog("ORGC","V","DrWhom");bfbTel.logClicked(n.EventScope.OrgChart,"DRWHOM")},f.formCode="BAWORG",f.verticalLineProps={x1:"50%",y1:"0",x2:"50%",y2:"100%"},f.horizontalLineProps={x1:"5%",x2:"95%",y1:"0",y2:"0"},f}(React.Component);r.OrgChartContainer=r.simpleConnect(u,f)})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(u){function f(){return u!==null&&u.apply(this,arguments)||this}return t(f,u),f.prototype.render=function(){var n=this.props,u=n.verticalLineProp,f=n.horizontalLineProp,t=n.directReportsPersonProps,e=n.forceOrgMetaWrap;if(t==null||t.length===0)return null;var o=u!=null?React.createElement(r.Line,i({},u)):null,s=f!=null?React.createElement(r.Line,i({},f)):null,h=e?"bw-orgDirectCtnr bw-noInlineMeta":"bw-orgDirectCtnr";return React.createElement("div",{className:h},React.createElement("div",{className:"bw-vert"},o),React.createElement("div",{className:"bw-hori"},s),this.renderDirectReportLabel(t),this.renderDirectReports(t))},f.prototype.renderDirectReportLabel=function(){var t=this.props.theme;return React.createElement("div",{className:"bw-dirLabl",style:{color:t}},n.Strings.DirectReportsLabel.toLocaleUpperCase())},f.prototype.renderDirectReports=function(n){var t=this.props,u=t.numColumns,f=t.enableNonHeroPresence,e=t.forceOrgMetaWrap,o=t.setOrgChartWrapDirectMeta,s=r.chunk(n,u),h=function(n){var h=!1,s;for(var t in n)if(n[t].nameCardProps.model.orgCount){h=!0;break}for(t in n)n[t].nameCardProps.reserveSpaceForOrgCount=h,n[t].nameCardProps.disablePresence=!f,n[t].nameCardProps.forceOrgMetaWrap=e,n[t].nameCardProps.setOrgChartWrapDirectMeta=o;if(s=n.map(function(n,t){return React.createElement(r.OrgChartPerson,i({key:t},n))}),n.length<u)for(t=n.length;t<u;t++)s.push(React.createElement(r.OrgChartPerson,i({key:t},n[0],{additionalClassName:"bw-invisi"})));return s};return React.createElement("div",{className:"bw-orgDirect"},s.map(function(n,t){return React.createElement("div",{key:t,className:"bw-row"},h(n))}))},f}(React.Component);r.OrgChartDirectReports=u})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(u){function f(t){var i=u.call(this,t)||this;return i.instClick=i.instClick.bind(i),i}return t(f,u),f.prototype.render=function(){var t=this.props.theme,i={borderTopColor:t};return React.createElement("div",{className:"bw-orgHero",style:i},React.createElement("div",{className:"bw-hero"},this.renderNameCard(),this.renderExtraMetaInfo()),this.renderPeers(),this.renderActionButtons())},f.prototype.renderPeerHoverContent=function(t,i,u){var f=this.props.cfg,e={enableOrgCount:f.ft.org.orgCount,type:n.NameCardType.OrgPeer,model:r.getNameCardModelFromPerson(t),disablePresence:!0,url:i,onClick:u};return React.createElement(r.MessageWrapper,null,React.createElement(r.OrgChartPerson,{nameCardProps:e}))},f.prototype.buildProfileImageContainersProps=function(t){var u=this,i=this.props,f=i.theme,e=i.useDirectLink,o=i.userLinkFormCode,s=i.onPeerClick;return t.map(function(t){var c=r.getMainEmail(t),l=t.FullName,i,h;return e?h=n.getUserUrl(t.FullName,t.UPN,o,n.QueryIntent.OrgChart):i=function(){return s(t)},{personEmail:c,personName:l,url:h,onClick:i,additionalStyle:{borderColor:f},contentToAppend:u.renderPeerHoverContent(t,h,i),disablePresence:!0}})},f.prototype.renderPeers=function(){var a=this,u=this.props,t=u.peers,f=u.manager,s=u.maxShownPeers,v=u.useDirectLink,y=u.userLinkFormCode,p=u.onPeerClick,o,l;if(t==null||t.length===0)return null;var e=s!=null?t.length-s:0,w=e>0?t.slice(0,t.length-e):t,b=this.buildProfileImageContainersProps(w),h,c;return v?c=n.getUserUrl(f.FullName,f.UPN,y,n.QueryIntent.OrgChart):h=function(){return p(f)},o=null,e>0&&f!=null&&(o=React.createElement("a",{onClick:h,href:c,className:"bw-smp",title:n.Strings.SeeAllPeers,onMouseDown:function(){return a.instClick("SMP")}},React.createElement("div",null,"+"+e))),l={labelStringKey:"PeersLabel",value:t.length.toString()},React.createElement("div",{className:"bw-peers"},React.createElement(r.MetaInfo,i({},l)),React.createElement(r.ProfileImageStrip,{profileImageContainersProps:b}),o)},f.prototype.renderPhoneMetaInfo=function(t){var u=r.getMainPhoneNumber(t),f=r.renderInfoItem(null,{type:n.DataType.Phone},u,this.instClick),e={labelStringKey:"BusinessPhone",value:f==null?null:u,elementValue:f};return React.createElement(r.MetaInfo,i({},e))},f.prototype.renderEmailMetaInfo=function(t){var u=r.getMainEmail(t),f=r.renderInfoItem(null,{type:n.DataType.Email},u,this.instClick),e={labelStringKey:"Email",value:u,elementValue:f};return React.createElement(r.MetaInfo,i({},e))},f.prototype.renderFloorPlanMetaInfo=function(t){var u=this.props,e=u.buildingInfo,o=u.floorPlanInfo,s=u.onFloorPlanClick,f=t.OfficeLocation,h=r.renderInfoItem(null,{type:n.DataType.Office},f,this.instClick,s,o,e),c={labelStringKey:"OfficeLocation",value:f,elementValue:h};return React.createElement(r.MetaInfo,i({},c))},f.prototype.renderCustomMetaInfo=function(n,t,u){var f=this.props.cfg.tenantMetadata.customInfoConfig,e={labelStringKey:f.labelKeyPrefix+"_"+t,value:n,elementValue:null};return React.createElement(r.MetaInfo,i({key:u},e))},f.prototype.renderCustomMetaInfos=function(n){var i=this,t=this.props.cfg.tenantMetadata.customInfoConfig;if(typeof t!="undefined"&&t!=null)return React.createElement("div",{className:"bw-pCtmInf"},t.personCustomInfos.map(function(t){var u=r.retrieveCustomPersonInfo(n,t.path);if(u!=null)return i.renderCustomMetaInfo(u,t.labelKey,t.path)}))},f.prototype.renderExtraMetaInfo=function(){var n=this.props.hero;return React.createElement("div",{className:"bw-metaCtnr"},this.renderPhoneMetaInfo(n),this.renderEmailMetaInfo(n),this.renderFloorPlanMetaInfo(n),this.renderCustomMetaInfos(n))},f.prototype.renderNameCard=function(){var c=this,t=this.props,o=t.cfg,u=t.hero,l=t.onNameCardClick,a=t.theme,f=t.directs,y=t.orgCount,v=t.enableNonHeroPresence,p=u.FullName,w=u.JobTitle,s=o.tenantMetadata.customInfoConfig,e=r.getNameCardModelFromPerson(u,s),h;return e.directReportsCount==null&&(e.directReportsCount=f!=null&&f.length>0?f.length.toString():null),h={enableOrgCount:o.ft.org.orgCount,type:n.NameCardType.OrgHero,model:e,onClick:l,onMouseDown:function(){return c.instClick()},fullNameTextColor:a,disablePresence:!v,underlineOrgInfo:s!=null},React.createElement(r.NameCard,i({},h))},f.prototype.renderActionButtons=function(){var n=this.props,t=n.hero,u=n.isFloorPlanEnabled,f=n.onFloorPlanClick,e={person:t,instClick:this.instClick,isFloorPlanEnabled:u,onFloorPlanClick:f};return React.createElement(r.OrgPersonActionButtons,i({},e))},f.prototype.instClick=function(t){bfbInst.instOrgChartClick(n.OrgChartPersonType[n.OrgChartPersonType.Hero],t);bfbTel.logClicked(n.EventScope.OrgChart,n.OrgChartPersonType.Hero,null,{ACT:t})},f}(React.Component);r.OrgChartHero=u})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(u){function f(n){var t=u.call(this,n)||this;return t.expanderOnMouseEvent=t.expanderOnMouseEvent.bind(t),t.expanderOnClick=t.expanderOnClick.bind(t),t}return t(f,u),f.prototype.render=function(){var n=this.props,t=n.managerProps,u=n.skipManagersProps,f=n.enableNonHeroPresence;return t.nameCardProps.disablePresence=!f,React.createElement("div",{className:"bw-orgManage"},this.renderSkipLevelManagers(u),React.createElement(r.OrgChartPerson,i({},t)))},f.prototype.expanderOnMouseEvent=function(n){var t=this.props,i=t.isExpanderHoverVisibile,r=t.setExpanderHoverVisibility;n?i||r(!0):i&&r(!1)},f.prototype.expanderOnClick=function(){var n=this.props,t=n.isSkipManagersVisible,i=n.onExpanderClick;i(!t)},f.prototype.renderExpanderHoverContent=function(t,i){var e,o;if(i!=null&&i.length!==0){var f=this.props,s=f.isExpanderHoverVisibile,h=f.isSkipManagersVisible,u;return t?(e=i.map(function(n){return{personEmail:n.nameCardProps.model.email,personName:n.nameCardProps.model.fullName,disablePresence:!0}}),u=React.createElement("div",null,React.createElement("div",null,n.Strings.SeeMoreOrg),React.createElement(r.ProfileImageStrip,{profileImageContainersProps:e}))):u=React.createElement("div",null,n.Strings.SeeLessOrg),o=r.combineCss(s?"":"bw-invisi",h?"":" bw-noskip"),React.createElement(r.MessageWrapper,{additionalClass:o},u)}},f.prototype.renderSkipLevelManagers=function(n){var t=this.props,u=t.isSkipManagersVisible,l=t.onExpanderClick,a=t.managerProps,v=t.enableNonHeroPresence,e,c;for(e in n)n[e].nameCardProps.disablePresence=!v;if(n==null||n.length===0)return null;var y=React.createElement(r.OrgChartPerson,i({},n[n.length-1])),f=n.length>1?n.slice(0,n.length-1):null,o=f!=null?f.map(function(n,t){return React.createElement(r.OrgChartPerson,i({key:t},n))}):null,s=null,h=null;return o!=null&&l!=null&&(c={isExpanded:u,onClick:this.expanderOnClick,showText:!1,onMouseEvent:this.expanderOnMouseEvent,overwriteIcon:function(t){return t?null:React.createElement("span",null,"+"+(n.length-1))}},s=React.createElement(r.Expander,i({},c)),h=React.createElement("div",{className:"bw-expLineCtnr"},React.createElement(r.Line,i({},a.lineProps)))),React.createElement("div",{className:"bw-orgSkip"},this.renderExpanderHoverContent(!u,f),s,h,React.createElement("div",{className:u?"":"b_hide"},o),y)},f}(React.Component);r.OrgChartManagementChain=u})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(n){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,f=t.nameCardProps,u=t.lineProps,r=t.actionButtonsProps,e=t.additionalClassName,o=u!=null?React.createElement(n.Line,i({},u)):null,s=r!=null?React.createElement(n.OrgPersonActionButtons,i({},r)):null,h=n.combineCss("bw-tile",r!=null?"bw-large":"",e);return React.createElement("li",{className:h},React.createElement(n.NameCard,i({},f)),s,o)},u}(React.Component);n.OrgChartPerson=r})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){var t=this.props,r=t.person,i=t.instClick,u=t.isFloorPlanEnabled,f=t.onFloorPlanClick,e=t.floorPlanUrl,o=u?React.createElement(n.FloorPlanActionButton,{isFloorPlanEnabled:u,onFloorPlanClick:f,url:e,instClick:i}):null;return React.createElement(n.ActionButtonsWrapper,null,React.createElement(n.PhoneActionButton,{phone:n.getMainPhoneNumber(r),instClick:i}),React.createElement(n.EmailActionButton,{email:n.getMainEmail(r),instClick:i}),o)},r}(React.Component);n.OrgPersonActionButtons=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(t){return{heroPerson:n.Reducers.People.getHeroPerson(t),cfg:t.cfg,ranking:t.appRouter.ranking}},f=function(u){function f(n){var t=u.call(this,n)||this;return t.instClick=t.instClick.bind(t),t}return t(f,u),f.prototype.componentDidMount=function(){bfbInst.sLog(f.instEventId);bfbTel.logShown(n.EventScope.Person,"PERS")},f.prototype.render=function(){var u=this,f=this.props,o=f.cfg,e=f.heroPerson,t;return e==null?null:(t={enableOrgCount:o.ft.org.orgCount,type:n.NameCardType.ContextRegion,model:r.getNameCardModelFromPerson(e),onClick:function(){return u.onExpandClick()}},React.createElement("div",{className:"bw-ans-content"},React.createElement(r.NameCard,i({},t)),React.createElement(r.ExpandButton,{onClick:function(){return u.onExpandClick()}}),React.createElement("div",{className:"bw-smact"},this.renderPhoneAction(),this.renderEmailAction(t.model.email),this.renderOrgChartAction(),this.renderFloorPlanAction())))},f.prototype.instClick=function(t){bfbInst.cLog(f.instEventId,t);bfbTel.logClicked(n.EventScope.Person,t,"PACT")},f.prototype.renderPhoneAction=function(){var n=this.props.heroPerson,t=r.getMainPhoneNumber(n);return React.createElement(r.PhoneActionButton,{phone:t,instClick:this.instClick})},f.prototype.renderEmailAction=function(n){return React.createElement(r.EmailActionButton,{email:n,instClick:this.instClick})},f.prototype.renderFloorPlanAction=function(){var n=this,t=this.props.cfg;return React.createElement(r.FloorPlanActionButton,{isFloorPlanEnabled:t.ft.fp.e,onFloorPlanClick:function(){return n.onFloorPlanClick()},instClick:this.instClick})},f.prototype.renderOrgChartAction=function(){var t=this,i=this.props.cfg;return i.ft.org.e?React.createElement(r.ActionButton,{type:r.ActionButtonType.Orgnization,title:n.Strings.OrgActionTitle,onClick:function(){return t.onOrgChartClick()}}):null},f.prototype.onFloorPlanClick=function(){var t=this.props.setPersonPivot;this.instClick("FP");t(n.PersonCardPivot.FloorPlan);this.expandMainlineAndRemoveContextRegion()},f.prototype.onOrgChartClick=function(){var t=this.props.setPersonPivot;this.instClick("OC");t(n.PersonCardPivot.Organization);this.expandMainlineAndRemoveContextRegion()},f.prototype.onExpandClick=function(){this.instClick("EXP");this.expandMainlineAndRemoveContextRegion()},f.prototype.expandMainlineAndRemoveContextRegion=function(){var t=this.props,i=t.ranking,r=t.setRanking;r({placement:n.AnswerPlacement.Pole,treatment:i.treatment,rankingRuleId:n.RankingRuleId.UserExplicit});i.placement===n.AnswerPlacement.ContextRegionBottom&&_ge("b_header").scrollIntoView()},f.instEventId="CRPERS",f}(React.Component);r.ContextRegionPersonSearchContainer=r.simpleConnect(u,f)})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var n=this;return React.createElement("div",{className:"bw-nc",onClick:function(){return n.onClick()},onMouseDown:function(t){return n.onMouseDown(t)}},this.renderProfileImageContainer(),this.renderInfo())},u.prototype.componentDidMount=function(){var t=this.props,e=t.type,o=t.forceOrgMetaWrap,u=t.setOrgChartWrapDirectMeta,i,r,f;e===n.NameCardType.OrgDirect&&!o&&u&&(i=ReactDOM.findDOMNode(this.refs.directReports),r=ReactDOM.findDOMNode(this.refs.orgCount),i&&r&&(f=i.offsetTop==r.offsetTop,f||u()))},u.prototype.onClick=function(){if(!this.state.isDragging){var t=this.props,i=t.url,r=t.onClick;r!=null&&r();n.nullOrWs(i)||n.navigateTo(i)}},u.prototype.onMouseDown=function(n){var f=this,t;this.setState({isDragging:!1});var i=[n.pageX,n.pageY],r=function(n){(Math.abs(n.pageX-i[0])>=3||Math.abs(n.pageY-i[1])>=3)&&f.setState({isDragging:!0})},u=function(){_d.removeEventListener("mousemove",r);_d.removeEventListener("mouseup",u)};_d.addEventListener("mousemove",r);_d.addEventListener("mouseup",u);t=this.props.onMouseDown;t!=null&&t()},u.prototype.renderProfileImageContainer=function(){var n=this.props,t=n.model,r=n.disablePresence;return React.createElement(i.ProfileImageContainer,{personEmail:t.email,personName:t.fullName,disablePresence:r})},u.prototype.renderInfo=function(){if(this.props.imageOnly)return null;var u=this.props,h=u.enableOrgCount,w=u.type,t=u.model,b=u.reserveSpaceForOrgCount,a=u.fullNameTextColor,k=u.underlineOrgInfo,r=function(n,t,r,u,f,e,o){return React.createElement(i.MetaInfo,{ref:n,labelStringKey:r,tooltip:u,value:t,showNullValue:e,additionalClassName:f,userCustomFormat:o})},d=n.nullOrWs(a)?null:{color:a},f=function(){return React.createElement("div",{style:d,className:"bw-tnc",title:t.fullName},t.fullName)},e=null,c=null,o=null,l=null;h&&(e=t.directReportsCount,c=t.directReportsCountDetail,o=t.orgCount,l=t.orgCountDetail);var g=!!e||!!o,v=!g&&b,s="bw-inlineMeta "+(k?"bw-undlnMeta":""),y=t.orgCountLabelKey?t.orgCountLabelKey:"OrgCountLabel",p=t.orgCountLabelKey?t.directReportsCountLabelKey:"DirectReportsLabel";switch(w){case n.NameCardType.OrgHero:return React.createElement("div",{className:"bw-pInfo"},f(),r("jobTitle",t.jobTitle),r("department",t.department,"Department"),r("directReports",e,p,c,s),r("orgCount",o,y,l,s));case n.NameCardType.OrgManager:case n.NameCardType.OrgDirect:return React.createElement("div",{className:"bw-pInfo"},f(),r("jobTitle",t.jobTitle),r("department",t.department,"Department"),r("directReports",e,p,c,s,h&&v),r("orgCount",o,y,l,s,h&&v));case n.NameCardType.ContextRegion:case n.NameCardType.DisambigSlim:return React.createElement("div",{className:"bw-pInfo"},f(),r("jobTitle",t.jobTitle),r("officeLocation",t.officeLocation));case n.NameCardType.OrgInline:case n.NameCardType.OrgSkipManager:case n.NameCardType.OrgPeer:case n.NameCardType.GroupMember:return React.createElement("div",{className:"bw-pInfo"},f(),r("jobTitle",t.jobTitle))}},u}(React.Component);i.NameCard=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(n){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,r=t.infoProps,u=t.onMouseDown;return React.createElement("div",{id:"bw-prsAbt"},React.createElement(n.Info,i({},r,{onMouseDown:u})),this.renderProfiles())},u.prototype.renderProfiles=function(){var t=this.props,i=t.profiles,r=t.onMouseDown;return i?React.createElement("div",null,React.createElement("ul",null,i.map(function(t,i){return React.createElement("li",{key:i},React.createElement("a",{href:t.url,onMouseDown:function(){return r(t.name)}},React.createElement(n.Icon,{className:"bw-plogo "+t.iconClassName+" bw-l"}),t.name))}))):null},u}(React.Component);n.PersonAbout=r})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var u=function(t){var i=t.cfg,r=t.userInfo,u=t.qrynf;return{cfg:i,userInfo:r,queryIntent:u.intent,floorPlanState:n.Reducers.People.getHeroPersonFloorPlanState(t)}},r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var o=this,r=this.props,t=r.card,u=r.person,f,e;return n.nullOrWs(t.heroPersonId)||u==null||u.data==null?React.createElement(i.SimpleProgressContainer,{error:t.error,isLoading:t.isLoading}):(f=this.buildInfoProperties(),e=this.buildProfiles(),React.createElement(i.PersonAbout,{infoProps:f,profiles:e,onMouseDown:function(n){return o.clickInst(n)}}))},u.prototype.clickInst=function(t){bfbInst.cLog("ABT","V",t,"S","PERS");bfbTel.logClicked(n.EventScope.Person,t)},u.prototype.buildProfiles=function(){var t=this.props,i=t.cfg,o=t.person,r=t.userInfo,u=[],f,e;return i.ft.dlv.e&&!n.nullOrWs(r.MySiteHostUrl)&&(f=i.ft.dlv.me.replace("{0}",r.MySiteHostUrl).replace("{1}",o.data.ObjectId),e={name:n.Strings.Delve,url:f,iconClassName:"bw-dlv"},u.push(e)),u},u.prototype.buildInfoProperties=function(){var o=this,u=this.props,e=u.cfg,s=u.person,r=u.queryIntent,f=u.floorPlanState,h=u.setPersonPivot,t=s.data,c=[i.createOtherInfo(t.Department,"Department",n.QueryIntent.Department,r),i.createPhoneInfo(t.BusinessPhoneNumbers,"BusinessPhone",r),i.createPhoneInfo(t.HomePhoneNumbers,"HomePhone",r),i.createPhoneInfo(t.MobilePhoneNumbers,"MobilePhone",r),i.createEmailInfo(t.EmailAddresses,"Email",r),i.createOtherInfo(t.MailNickname,"Alias",n.QueryIntent.Alias,r),i.createOtherInfo(t.OfficeLocation,"OfficeLocation",n.QueryIntent.Office,r,n.DataType.Office)],l=f==null||f.roomInfo==null?null:f.roomInfo;return{items:i.getValidInfoItems(c),floorPlan:i.buildFloorPlanInfo(e,t,l,h),building:i.buildBuildingInfo(e,t),onMouseDown:function(n){return o.clickInst(n)}}},u}(React.Component);i.PersonAboutContainerImpl=r;i.PersonAboutContainer=i.simpleConnect(u,r)})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(t){var i=t.cfg,r=t.qrynf,u=t.ans;return{cfg:i,theme:i.tenantMetadata.theme,query:r.qry,people:n.Reducers.People.getAllPeople(t),isSlimDisambigExpanded:u.inline.isDisambigExpanded,enableNonHeroPresence:i.ft.skyint.enableNonHeroPresence}},f=function(u){function f(){return u!==null&&u.apply(this,arguments)||this}return t(f,u),f.prototype.componentDidMount=function(){bfbTel.logShown(n.EventScope.Person,"PDSMG")},f.prototype.render=function(){var t=this.props,u=t.theme,f=t.query,e={theme:u,title:n.strFormat(n.Strings.ResultsFor,f)};return React.createElement("div",null,React.createElement(r.SimpleHeader,i({},e)),this.renderDisambigList())},f.prototype.renderDisambigList=function(){var t=this,n=this.props,h=n.isSlim,f=n.people,c=n.setHeroPersonId,l=n.showHeroPerson,e=n.enableNonHeroPresence,o=function(n){c(n);l()},s;if(h){var u=this.props,a=u.cfg,v=u.isSlimDisambigExpanded,y=u.expandInlineAnswerDisambig,p={enableOrgCount:a.ft.org.orgCount,people:f,onPersonClick:o,defaultShowCount:4,isExpanded:v,setExpansion:y,enableNonHeroPresence:e};return React.createElement(r.PersonDisambigSlimList,i({},p))}return s={data:f,onPersonClick:o,onPersonInfoMouseDown:function(){return t.clickInst("N")},onPersonEmailMouseDown:function(){return t.clickInst("EML")},onPersonPhoneMouseDown:function(){return t.clickInst("PHN")},enableNonHeroPresence:e},React.createElement(r.PersonDisambigList,i({},s))},f.prototype.clickInst=function(t){bfbInst.cLog("PDSMG","C",t);bfbTel.logClicked(n.EventScope.Person,"PDSMG",t)},f}(React.Component);r.PersonDisambigContainer=r.simpleConnect(u,f)})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var n=this,t=this.props.data;return React.createElement("div",{id:"bw-dg"},React.createElement("table",null,React.createElement("tbody",null,t.map(function(t,i){return React.createElement("tr",{key:i},n.renderInfoColumn(t),n.renderEmailColumn(t),n.renderPhoneColumn(t))}))))},u.prototype.renderInfoColumn=function(t){var r=this.props,u=r.onPersonInfoMouseDown,f=r.onPersonClick,e=r.enableNonHeroPresence,o=i.getMainEmail(t),s=i.getFormattedPersonTitle(t),h=n.nullOrWs(t.JobTitle)?null:React.createElement("span",{id:"bw-dgJt"}," - ",t.JobTitle);return React.createElement("td",{className:"bw-dgInfo bw-tnc",onClick:function(){return f(t.ObjectId)}},React.createElement(i.ProfileImageContainer,{personEmail:o,personName:t.FullName,disablePresence:!e}),React.createElement("a",{title:s,onMouseDown:u},React.createElement("span",{id:"bw-dgTtl"},t.FullName),h))},u.prototype.renderEmailColumn=function(n){var t=this.props,u=t.onPersonEmailMouseDown,f=t.onPersonClick,r=i.getMainEmail(n);return React.createElement("td",{className:"bw-dgEml bw-tnc"},React.createElement(i.Icon,{inline:!0}),React.createElement(i.EmailAction,{email:r,onMouseDown:u},r))},u.prototype.renderPhoneColumn=function(n){var r=this.props,u=r.onPersonPhoneMouseDown,f=r.onPersonClick,t=i.getMainPhoneNumber(n);return React.createElement("td",{className:(t==null?"b_hide ":"")+" bw-dgPhn bw-tnc"},React.createElement(i.Icon,{inline:!0}),React.createElement(i.PhoneAction,{phone:t,onMouseDown:u},t))},u}(React.Component);i.PersonDisambigList=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(u){function f(){return u!==null&&u.apply(this,arguments)||this}return t(f,u),f.prototype.render=function(){var n=this.props,t=n.people,i=n.defaultShowCount,r=n.isExpanded,u=n.setExpansion;return React.createElement("div",{id:"bw-dg-s"},this.renderDisambigList(t.slice(0,i)),this.renderExpander(t.slice(i)))},f.prototype.renderDisambigList=function(n){var t=this;return n.length===0?null:React.createElement("ul",null,n.map(function(n,i){return React.createElement("li",{key:i},t.renderNameCard(n))}))},f.prototype.renderNameCard=function(t){var u=this.props,f=u.enableOrgCount,e=u.onPersonClick,o=u.enableNonHeroPresence,s={enableOrgCount:f,type:n.NameCardType.DisambigSlim,model:r.getNameCardModelFromPerson(t),onClick:function(){return e(t.ObjectId)},disablePresence:!o};return React.createElement(r.NameCard,i({},s))},f.prototype.renderExpander=function(n){if(n.length===0)return null;var t=this.props,i=t.isExpanded,u=t.setExpansion;return React.createElement(r.Expander,{isExpanded:i,onClick:function(){return u(!i)}},this.renderDisambigList(n))},f}(React.Component);r.PersonDisambigSlimList=u})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var f=function(t){var i=t.cfg;return{cfg:i,person:n.Reducers.People.getHeroPerson(t)}},u=function(u){function f(){return u!==null&&u.apply(this,arguments)||this}return t(f,u),f.prototype.render=function(){var n=this.buildHeaderProperties(),t=this.buildInfoProperties();return React.createElement("div",null,React.createElement(r.Header,i({},n)),React.createElement("div",{id:"bw-person"},React.createElement(r.PersonAbout,{infoProps:t,onMouseDown:function(){}})))},f.prototype.buildInfoProperties=function(){var t=this.props.person,i=[r.createOtherInfo(t.Department,"Department",n.QueryIntent.Department,n.QueryIntent.None),r.createPhoneInfo(t.BusinessPhoneNumbers,"BusinessPhone",n.QueryIntent.None),r.createEmailInfo(t.EmailAddresses,"Email",n.QueryIntent.None),r.createOtherInfo(t.MailNickname,"Alias",n.QueryIntent.Alias,n.QueryIntent.None),r.createOtherInfo(t.OfficeLocation,"OfficeLocation",n.QueryIntent.Office,n.QueryIntent.None,n.DataType.Office)];return{items:r.getValidInfoItems(i),floorPlan:null,building:null}},f.prototype.buildHeaderProperties=function(){var t=this.props,u=t.cfg,n=t.person,i=r.getMainEmail(n);return{theme:u.tenantMetadata.theme,title1:n.FullName,title2:n.JobTitle?n.JobTitle.toUpperCase():null,email:i,personEmail:i,phone:r.getMainPhoneNumber(n)}},f}(React.Component);r.PersonPreviewContainerImpl=u;r.PersonPreviewContainer=r.simpleConnect(f,u)})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(t){var r=t.cfg,i=t.people,u=t.qrynf,f=i.card;return{cfg:r,selectedPivot:i.selectedPivot,card:f,person:n.Reducers.People.getHeroPersonState(t),queryIntent:u.intent}},f=function(u){function f(){return u!==null&&u.apply(this,arguments)||this}return t(f,u),f.prototype.componentDidMount=function(){bfbTel.logShown(n.EventScope.Person,"PERS")},f.prototype.render=function(){var h=this,f=this.props,u=f.cfg,t=f.selectedPivot,c=f.queryIntent,l=f.setPersonPivot,e=this.getPivots(u),o,s;return t==null&&(t=this.getDefaultPivot(u,c,e[0])),o=e.map(function(n){return{value:n,name:h.getPivotName(n)}}),s=this.buildHeaderProps(),React.createElement("div",null,React.createElement(r.Header,i({},s)),React.createElement("div",{id:"bw-prsn"},React.createElement(r.NavigationPivots,{pivots:o,pivotInst:n.PersonCardPivot,selectedPivot:t,onClick:l}),React.createElement("div",{className:"bw-pvtc"},this.renderAbout(u,t),this.renderDocuments(u,t),this.renderOrgChart(u,t),this.renderGroups(u,t),this.renderFloorPlan(u,t))))},f.prototype.getDefaultPivot=function(t,i,r){switch(i){case n.QueryIntent.OrgChart:if(t.ft.org.e)return n.PersonCardPivot.Organization;break;case n.QueryIntent.Office:if(t.ft.fp.e)return n.PersonCardPivot.FloorPlan;break;case n.QueryIntent.Group:if(t.ft.pgrp.e)return n.PersonCardPivot.Groups;break;case n.QueryIntent.PersonDocs:if(t.ft.docbrwse.e)return n.PersonCardPivot.Documents}return r},f.prototype.getPivots=function(t){var i=function(i){return(i!==n.PersonCardPivot.Documents||t.ft.docbrwse.e)&&(i!==n.PersonCardPivot.Organization||t.ft.org.e)&&(i!==n.PersonCardPivot.Groups||t.ft.pgrp.e)&&(i!==n.PersonCardPivot.FloorPlan||t.ft.fp.e)};return n.enumToArray(n.PersonCardPivot,i)},f.prototype.renderAbout=function(t,i){var u=this.props,f=u.card,e=u.person;return React.createElement(r.NavigationPivotWrapper,{pivot:n.PersonCardPivot.PersonAbout,selectedPivot:i},React.createElement(r.PersonAboutContainer,{card:f,person:e}))},f.prototype.renderDocuments=function(t,i){if(!t.ft.docbrwse.e)return null;var u=this.props.person,f=u!=null?u.files:null;return React.createElement(r.NavigationPivotWrapper,{pivot:n.PersonCardPivot.Documents,selectedPivot:i},React.createElement(r.DocumentsContainer,{documents:f,maxResults:t.ft.docs.maxRecentDocs,isSlim:!1}))},f.prototype.renderOrgChart=function(t,i){return t.ft.org.e?React.createElement(r.NavigationPivotWrapper,{pivot:n.PersonCardPivot.Organization,selectedPivot:i},React.createElement(r.OrgChartContainer,null)):null},f.prototype.renderGroups=function(t,i){return t.ft.pgrp.e?React.createElement(r.NavigationPivotWrapper,{pivot:n.PersonCardPivot.Groups,selectedPivot:i},React.createElement(r.GroupsContainer,null)):null},f.prototype.renderFloorPlan=function(t,i){return t.ft.fp.e?React.createElement(r.NavigationPivotWrapper,{pivot:n.PersonCardPivot.FloorPlan,selectedPivot:i},React.createElement(r.FloorPlanContainer,null)):null},f.prototype.getPivotName=function(t){switch(t){case n.PersonCardPivot.PersonAbout:return n.Strings.About;case n.PersonCardPivot.Documents:return n.Strings.Documents;case n.PersonCardPivot.Organization:return n.Strings.Organization;case n.PersonCardPivot.Groups:return n.Strings.Groups;case n.PersonCardPivot.FloorPlan:return n.Strings.FloorPlan}return""},f.prototype.buildHeaderProps=function(){var i=this.props,e=i.cfg,u=i.person,t=u!=null?u.data:null,f=r.getMainEmail(t);return{theme:e.tenantMetadata.theme,title1:t!=null?t.FullName:null,title2:t!=null&&!n.nullOrWs(t.JobTitle)?t.JobTitle:null,email:f,personEmail:f,phone:r.getMainPhoneNumber(t),clickInst:function(t){bfbInst.cLog("PHEAD","V",t);bfbTel.logClicked(n.EventScope.Person,"PHEAD")}}},f}(React.Component);r.PersonSearchContainer=r.simpleConnect(u,f)})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(n){var r=function(r){function u(){var n=r!==null&&r.apply(this,arguments)||this;return n.compleationEventFired=!1,n}return t(u,r),u.prototype.render=function(){var n=this.props.iframeUrl;return n==null?null:React.createElement("div",null,this.renderHeader(),React.createElement("div",{className:"bw-powerBi"},this.renderIframe()))},u.prototype.componentDidMount=function(){this.reportRenderCompletion()},u.prototype.componentDidUpdate=function(){this.reportRenderCompletion()},u.prototype.renderHeader=function(){var t=this.props.headerProps;return React.createElement(n.Header,i({},t))},u.prototype.renderIframe=function(){var n=this.props.iframeUrl;return n==null?null:React.createElement("iframe",{ref:"frame",src:n,seamless:!0,sandbox:"allow-popups allow-forms allow-same-origin allow-scripts"})},u.prototype.reportRenderCompletion=function(){var n=this.props.iframeUrl;this.refs.frame!=null&&this.refs.frame.clientWidth>0&&n!=null&&!this.compleationEventFired&&(this.compleationEventFired=!0,sj_evt.fire(u.onBawPowerBiRendered))},u.onBawPowerBiRendered="onBawPowerBiRendered",u}(React.Component);n.PowerBi=r})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var f=function(t){var i=t.cfg,r=t.powerBi,u=t.appRouter,f=r.data;return{theme:t.cfg.tenantMetadata.theme,cfg:i,data:f,isContainerAttached:n.Reducers.AppRouter.isContainerAttached(u,n.AnswerPlacement.Pole)}},u=function(u){function f(n){return u.call(this,n)||this}return t(f,u),f.prototype.componentDidMount=function(){bfbInst.sLog("POWBI");bfbTel.logShown(n.EventScope.PowerBi,"POWBI")},f.prototype.render=function(){var n=this.props.isContainerAttached;return n?this.renderPowerBi():null},f.prototype.renderPowerBi=function(){var n=this.buildPowerBiProps();return n==null?null:React.createElement(r.PowerBi,i({},n))},f.prototype.buildPowerBiProps=function(){var u=this.props,e=u.theme,f=u.cfg,r=u.data,t,i;if(r==null||r.Interpretations==null||r.Interpretations.length==0||(t=r.FrontendUrl,n.nullOrWs(f.ft.powerbi.urlOverride)||(t=f.ft.powerbi.urlOverride),n.nullOrWs(t))||(t[t.length-1]!="/"&&(t+="/"),i=r.Interpretations[0],n.nullOrWs(i.Link)))return null;var h=i.DisplayName,o=t+i.Link,s={theme:e,title1:i.DisplayName,title2:n.nullOrWs(i.ModelDisplayName)?null:i.ModelDisplayName};return{headerProps:s,iframeUrl:o}},f}(React.Component);r.PowerBiContainerImpl=u;r.PowerBiContainer=r.simpleConnect(f,u)})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var r=this.props,e=r.title,o=r.body,u=r.action,t=o,f;if(!t||!t.length||t.length===0)throw new Error("Unexpected RefQnA items argument");return f=u&&!n.nullOrWs(u.url)?this.renderAction(u):null,React.createElement("div",{id:"bw-rqna"},React.createElement("div",{className:"bw-qna-ttl"},e),React.createElement("div",{className:"bw-qna-bdy"},t.map(function(n,t){return React.createElement(i.RefQnaItem,{item:n,key:t})})),f)},u.prototype.renderAction=function(n){var t=n.url,i=n.title,r=this.props.onMouseDown;return React.createElement("div",{className:"bw-qna-ftr"},React.createElement("a",{href:t,onMouseDown:function(){return r(n)}},React.createElement("div",{className:"bw-msfont doublebookmark","data-tag":"bw-scrubFont"}),React.createElement("div",{id:"bw-aInfo"},React.createElement("div",{className:"bw-aTtl bw-tnc",title:i},i),React.createElement("div",{className:"bw-aLink bw-tnc",title:t},t))))},u}(React.Component);i.RefQna=r})(i=n.Components||(n.Components={}))}(n||(n={})),function(n){var t;(function(n){function t(n){return{id:n.Id,url:n.UriString,title:n.UriTitle}}n.buildRefQnaAction=t})(t=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var f=function(n){var t=n.cfg,i=n.refQna;return{cfg:t,refQna:i}},u=function(u){function f(){return u!==null&&u.apply(this,arguments)||this}return t(f,u),f.prototype.componentDidMount=function(){var t=this.props.refQna;bfbInst.log("RQA","ID",t.Id);bfbTel.logShown(n.EventScope.RefQna,t.Id)},f.prototype.render=function(){var n=this.props.refQna,t=r.buildRefQnaAction(n),u={title:n.Title,body:n.MarkdownJson,action:t,onMouseDown:this.onActionMouseDown.bind(this)};return React.createElement(r.RefQna,i({},u))},f.prototype.onActionMouseDown=function(n){bfbInst.instRefQnaActionClick(n.id)},f}(React.Component);r.RefQnaContainerImpl=u;r.RefQnaContainer=r.simpleConnect(f,u)})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var o=function(n){return React.createElement("a",{href:n.item.href,title:n.item.title},u(n))},s=function(n){return React.createElement("blockquote",{className:"qna-blockquote"},u(n))},h=function(){return React.createElement("br",null)},c=function(n){return React.createElement("code",{className:"qna-code "+n.item["class"]},u(n))},l=function(n){return React.createElement("div",null,u(n))},a=function(n){return React.createElement("em",null,u(n))},v=function(n){return React.createElement("h1",{className:"qna-h1"},u(n))},y=function(n){return React.createElement("h2",{className:"qna-h2"},u(n))},p=function(n){return React.createElement("h3",{className:"qna-h3"},u(n))},w=function(n){return React.createElement("h4",{className:"qna-h4"},u(n))},b=function(n){return React.createElement("hr",null,u(n))},k=function(n){return React.createElement("img",{src:n.item.src,title:n.item.title,alt:n.item.alt},u(n))},d=function(n){return React.createElement("li",null,u(n))},g=function(n){return React.createElement("ol",{className:"qna-list"},u(n))},nt=function(n){return React.createElement("p",{className:"qna-p"},u(n))},tt=function(n){return React.createElement("pre",null,u(n))},it=function(n){return React.createElement("strong",null,u(n))},rt=function(n){return React.createElement("span",null,n.item.text)},ut=function(n){return React.createElement("ul",{className:"qna-list"},u(n))},f=(r={},r[n.QnaItemType.a]=o,r[n.QnaItemType.blockquote]=s,r[n.QnaItemType.br]=h,r[n.QnaItemType.code]=c,r[n.QnaItemType.div]=l,r[n.QnaItemType.em]=a,r[n.QnaItemType.h1]=v,r[n.QnaItemType.h2]=y,r[n.QnaItemType.h3]=p,r[n.QnaItemType.h4]=w,r[n.QnaItemType.hr]=b,r[n.QnaItemType.img]=k,r[n.QnaItemType.li]=d,r[n.QnaItemType.ol]=g,r[n.QnaItemType.p]=nt,r[n.QnaItemType.pre]=tt,r[n.QnaItemType.strong]=it,r[n.QnaItemType.text]=rt,r[n.QnaItemType.ul]=ut,r),e=function(n){function i(){return n!==null&&n.apply(this,arguments)||this}return t(i,n),i.prototype.render=function(){return f[this.props.item.type]?f[this.props.item.type](this.props):null},i}(React.Component),u=function(t){return t.item.children==null?null:t.item.children.length===1&&t.item.children[0].type==n.QnaItemType.text?t.item.children[0].text:t.item.children.map(function(n,t){return React.createElement(e,{item:n,key:t})})},r;i.RefQnaItem=e})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i,r;(function(n){n[n.Email=0]="Email";n[n.Phone=1]="Phone";n[n.Location=2]="Location";n[n.Orgnization=3]="Orgnization"})(i=n.ActionButtonType||(n.ActionButtonType={}));r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,e=t.type,o=t.email,s=t.phone,h=t.onClick,r=t.onMouseDown,c=t.href,l=t.title,u="bw-action",a=this.getIconClassName(),f="bw-icon "+a;switch(e){case i.Email:return React.createElement(n.EmailAction,{email:o,iconClassName:f,className:u,onMouseDown:r});case i.Phone:return React.createElement(n.PhoneAction,{phone:s,iconClassName:f,className:u,onMouseDown:r});case i.Location:case i.Orgnization:default:return React.createElement("a",{className:u,href:c,onClick:h,title:l,onMouseDown:r},React.createElement(n.Icon,{className:f}))}},u.prototype.getIconClassName=function(){var n=this.props.type;switch(n){case i.Email:return"bw-mail";case i.Phone:return"bw-phn";case i.Location:return"bw-pin";case i.Orgnization:return"bw-org";default:return""}},u}(React.Component);n.ActionButton=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(n){function i(){return n!==null&&n.apply(this,arguments)||this}return t(i,n),i.prototype.render=function(){var n=this.props.children;return React.createElement("div",{className:"bw-actBtns"},n)},i}(React.Component);n.ActionButtonsWrapper=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(n){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,e=t.theme,r=t.children,u=t.headerProps,f=t.footerProps;return React.createElement("div",{id:"bw-alg"},React.createElement(n.AnswerHeader,i({},u)),React.createElement("div",{id:"bw-alg-tar"},r),React.createElement(n.AnswerFooter,i({},f)))},u}(React.Component);n.AlgoAnswerFrame=r})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(n){var t=n.cfg,i=t.tenantMetadata;return{theme:i.theme,base64Logo:i.iconLarge,tenantName:i.displayName,privacyLink:t.ft.prl,exploreLink:t.exploreLink}},f=function(u){function f(){return u!==null&&u.apply(this,arguments)||this}return t(f,u),f.prototype.render=function(){var t=this.props,u=t.theme,f=t.base64Logo,e=t.tenantName,o=t.children,s=t.privacyLink,v=t.exploreLink,h=t.renderAlgoAnswer,c={base64Logo:f,tenantName:e,showCorpOnlyMsg:!1,showWorkResultLabelSeparator:!1,onDismiss:function(){bfbInst.cLog("ACLS");bfbTel.logClicked(n.EventScope.BingAtWork,"DSMC","ANSAL");h(!1)}},l={showPrivacyLink:!0,showJobLink:!1,showTenantSearchLink:!1,privacyLink:s.deeplinkFormat,onFeedbackClick:function(){bfbInst.cLog("FDBK");bfbTel.logClicked(n.EventScope.Feedback);var t=_w.feedback;t!=null&&t.showForm()},onTenantSearchLinkClick:function(){return bfbInst.cLog("MOREL","Q")},exploreLink:null,useSimpleDisclaimer:!0},a={theme:u,headerProps:c,footerProps:l,additionalClassName:"bw-alg-frm"};return React.createElement(r.SimpleAnswerFrame,i({},a),o)},f}(React.Component);r.AlgoAnswerFrameContainer=r.simpleConnect(u,f)})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(n){var t=n.appRouter,r=n.ans,i=n.refQna;return{ranking:t.ranking,refQna:i}},u=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var r=this.props.ranking,t;return r==null||r.placement!==n.AnswerPlacement.Algo?null:(t=this.buildContent(),t==null)?null:React.createElement(i.AlgoAnswerFrameContainer,null,t)},u.prototype.buildContent=function(){var r=this.props.ranking,t;switch(r.treatment){case n.Treatment.RefQna:if(t=this.props.refQna,t&&t.MarkdownJson&&t.Title)return React.createElement(i.RefQnaContainer,null)}return null},u}(React.Component);i.AlgoAppRouterContainer=i.simpleConnect(r,u)})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(u){function f(){return u!==null&&u.apply(this,arguments)||this}return t(f,u),f.prototype.render=function(){return React.createElement("div",{className:"bw-foot"},this.renderLinks(),this.renderDisclaimer())},f.prototype.renderLinks=function(){var t=this.props,i=t.showJobLink,r=t.showPrivacyLink,f=t.showTenantSearchLink,e=t.privacyLink,o=t.jobLink,u=t.exploreLink;return React.createElement("div",null,this.renderLink(i,o,n.Strings.JobLink,{className:"bw-job"}),this.renderSeparator(i),this.renderLink(r,e,n.Strings.PrivacyLink),this.renderSeparator(r),this.renderFeedbackLink(),this.renderSeparator(!n.nullOrWs(u)),this.renderLink(!0,u,n.Strings.WhatIsThisLink),this.renderSeparator(f),this.renderSeeMoreLink())},f.prototype.renderSeparator=function(n){return n?React.createElement(r.FooterItemSeparator,null):null},f.prototype.renderLink=function(t,u,f,e){return(e===void 0&&(e=null),!t||n.nullOrWs(u))?null:React.createElement(r.FooterItemWrapper,null,React.createElement("a",i({href:u},e),f))},f.prototype.renderFeedbackLink=function(){var t=this.props.onFeedbackClick;return React.createElement(r.FooterItemWrapper,null,React.createElement("a",{id:"bw-fb",onClick:t},n.Strings.FeedbackLink))},f.prototype.renderSeeMoreLink=function(){var i=this.props,o=i.showTenantSearchLink,t=i.tenantSearchLink,u=i.query,s=i.onTenantSearchLinkClick,f,e;return!o||t==null||n.nullOrWs(t.name)||n.nullOrWs(t.url)||n.nullOrWs(u)?null:(f=/\{0\}/,e=t.url.replace(f,u),React.createElement(r.FooterItemWrapper,null,React.createElement("a",{id:"bw-fb",onClick:s,href:e},n.Strings.TenantSearch+t.name)))},f.prototype.renderDisclaimer=function(){var n=this.props.useSimpleDisclaimer;return n?React.createElement(r.SimpleDisclaimerContainer,null):React.createElement(r.DisclaimerContainer,null)},f}(React.Component);r.AnswerFooter=u})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(n){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,f=t.render,e=t.children,o=t.answerMinWidth,s=t.answerContentWidth,h=t.headerProps,c=t.footerProps,l=t.veilProps,a=t.marginBottom,r,u;return f?(r={minWidth:o,marginBottom:a},u={width:s},React.createElement("div",{id:"bw",className:"bw",style:r},React.createElement(n.NotificationContainer,null),React.createElement("div",{id:"bw-ans",className:"bw",style:u},React.createElement(n.AnswerHeader,i({},h)),React.createElement("div",{id:"bw-tar"},e),React.createElement(n.AnswerFooter,i({},c)),React.createElement(n.Veil,i({},l))))):null},u}(React.Component);n.AnswerFrame=r})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(t){var i=t.cfg,f=t.ans,e=t.veil,o=t.appRouter,s=t.qrynf,r=t.command,u=f.mainline,h=u.width,c=u.render;return{base64Logo:i.tenantMetadata.iconLarge,render:c,veil:e,answerContentWidth:h,privacyLink:i.ft.prl,jobLink:i.ft.job,tenantSearchLink:i.tenantMetadata.searchLink,tenantSearchLinkOn:i.ft.tsrch.e&&r!=null&&r.scenario==n.BfbResponseScenario.Task,exploreLink:i.exploreLink,tenantName:i.tenantMetadata.displayName,ranking:o.ranking,query:s.qry}},f=function(u){function f(){return u!==null&&u.apply(this,arguments)||this}return t(f,u),f.prototype.render=function(){var t=this.props,c=t.base64Logo,l=t.render,f=t.veil,e=t.privacyLink,o=t.jobLink,a=t.exploreLink,u=t.tenantSearchLink,v=t.tenantSearchLinkOn,s=t.answerContentWidth,y=t.tenantName,p=t.setNonWorkResultsVeilVisibility,w=t.ranking,b=t.setRanking,k=t.marginBottom,h=t.query,d={base64Logo:c,tenantName:y,showCorpOnlyMsg:!0,showWorkResultLabelSeparator:!0,onDismiss:function(){bfbInst.cLog("DSMC");bfbTel.logClicked(n.EventScope.BingAtWork,"DSMC","ANSML");b({placement:n.AnswerPlacement.None,treatment:w.treatment,rankingRuleId:n.RankingRuleId.UserExplicit})}},g={shouldRender:f.shouldRender,isVisible:f.isVisible,setVeilVisibility:p},nt={showPrivacyLink:e.e,showJobLink:o.e,showTenantSearchLink:v&&u!=null&&!n.nullOrWs(u.name)&&!n.nullOrWs(u.url),privacyLink:e.deeplinkFormat,jobLink:o.deeplinkFormat,tenantSearchLink:u,onFeedbackClick:function(){bfbInst.cLog("FDBK");bfbTel.logClicked(n.EventScope.Feedback);var t=_w.feedback;t!=null&&t.showForm()},onTenantSearchLinkClick:function(){return bfbInst.cLog("MOREL","Q",h)},exploreLink:a,useSimpleDisclaimer:!1,query:h},tt={render:l,answerContentWidth:s,answerMinWidth:s+200,headerProps:d,footerProps:nt,veilProps:g,marginBottom:k};return React.createElement(r.AnswerFrame,i({},tt),this.props.children)},f}(React.Component);r.AnswerFrameContainer=r.simpleConnect(u,f)})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(n){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){return React.createElement("div",{className:"bw-head"},this.renderWorkResultLabel(),this.renderDismissButton(),this.renderCorpOnlyMessage())},u.prototype.renderWorkResultLabel=function(){var t=this.props,r=t.base64Logo,u=t.showWorkResultLabelSeparator,f={companyLogoProps:{showLogo:!0,base64Img:r},showSeparator:u};return React.createElement(n.WorkResultLabel,i({},f))},u.prototype.renderDismissButton=function(){var t=this.props.onDismiss,r={onClick:t,additionalClassName:"bw-r"};return React.createElement(n.DismissButton,i({},r))},u.prototype.renderCorpOnlyMessage=function(){var t=this.props,i=t.tenantName,r=t.showCorpOnlyMsg;return r?n.renderCorpOnlyMessage(i,"bw-r","bw-l"):null},u}(React.Component);n.AnswerHeader=r})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){var t=this.props,i=t.showLogo,r=t.base64Img,u=n.imgSrc(r,"png",!1);return i?React.createElement("img",{className:"bw-clogo",src:u}):null},r}(React.Component);i.CompanyLogo=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(n){var t=n.cfg,r=n.appRouter,i=t.tenantMetadata;return{theme:t.tenantMetadata.theme,base64Logo:i.iconLarge,tenantName:i.displayName,ranking:r.ranking}},f=function(u){function f(){return u!==null&&u.apply(this,arguments)||this}return t(f,u),f.prototype.render=function(){var t=this.props,f=t.theme,e=t.base64Logo,o=t.tenantName,s=t.children,u=t.ranking,h=t.setRanking,c={base64Logo:e,tenantName:o,showCorpOnlyMsg:!1,showWorkResultLabelSeparator:!1,onDismiss:function(){bfbInst.cLog("CRCLS");bfbTel.logClicked(n.EventScope.BingAtWork,"DSMC","ANSCR");h({placement:n.AnswerPlacement.None,treatment:u.treatment,rankingRuleId:n.RankingRuleId.UserExplicit})}},l=r.combineCss("bw-cr-frm",u!=null&&u.treatment===n.Treatment.Documents?"bw-cr-docs":null),a={theme:f,headerProps:c,footerProps:{showPrivacyLink:!1,showJobLink:!1,showTenantSearchLink:!1,onFeedbackClick:null,exploreLink:null,useSimpleDisclaimer:!0,onTenantSearchLinkClick:null},additionalClassName:l};return React.createElement(r.SimpleAnswerFrame,i({},a),s)},f}(React.Component);r.ContextRegionAnswerFrameContainer=r.simpleConnect(u,f)})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(n){var t=n.appRouter;return{query:n.qrynf.qry,processingStatus:t.status,ranking:t.ranking}},u=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.componentDidMount=function(){bfbTel.logShown(n.EventScope.BfbController,"ANSCR")},u.prototype.render=function(){var t=this.props,e=t.placement,r=t.processingStatus,o=t.query,f=t.ranking,u;return f==null||f.placement!==e?null:r!=null?r!==n.ProcessingStatus.Started&&r!==n.ProcessingStatus.SsoPending?null:React.createElement(i.ContextRegionAnswerFrameContainer,null,React.createElement(i.ProgressContainer,{status:r,addQuotes:!0,query:o})):(u=this.buildContent(),u==null)?null:React.createElement(i.ContextRegionAnswerFrameContainer,null,u)},u.prototype.buildContent=function(){var t=this.props.ranking;switch(t.treatment){case n.Treatment.People:return React.createElement(i.ContextRegionPersonSearchContainer,null);case n.Treatment.Documents:return React.createElement(i.ContextRegionDocumentSearchContainer,null);case n.Treatment.Bookmarks:return React.createElement(i.ContextRegionBookmarkSearchContainer,null);case n.Treatment.Buildings:return React.createElement(i.ContextRegionBuildingSearchContainer,null)}return null},u}(React.Component);i.ContextRegionAppRouterContainer=i.simpleConnect(r,u)})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){var t=this.props,i=t.tenantName,r=t.additionalClassName,u=t.lockIconClassName;return React.createElement("p",{className:r},React.createElement("span",{className:"bw-lock "+u}),n.strFormat(n.Strings.CorpOnlyMessage,i))},r}(React.Component);i.CorpOnlyMessage=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){return React.createElement("p",null,this.renderBestMatchMsg()," ",this.renderAllMatchMsg())},r.prototype.renderBestMatchMsg=function(){var t=this.props,i=t.bestWorkMatchIs,r=t.isBestMatchClickable,u=t.bestMatch,f=t.onBestMatchClick;return React.createElement("span",null,i[0],this.renderBestMatchLink(),n.secondOrNull(i),React.createElement("span",null,"."))},r.prototype.renderBestMatchLink=function(){var n=this.props,i=n.isBestMatchClickable,t=n.bestMatch,r=n.onBestMatchClick;return i?React.createElement("a",{id:"bw-bm",onClick:r},t):React.createElement("span",null,t)},r.prototype.renderAllMatchMsg=function(){var t=this.props,r=t.showAllMatch,i=t.viewAllMatchesFor,u=t.allMatch,f=t.onAllMatchClick;return r?React.createElement("span",null,i[0],React.createElement("a",{id:"bw-sm",onClick:f},u),n.secondOrNull(i)):null},r}(React.Component);i.DisambigMessage=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(n){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,r=t.isVisible,u=t.disambigMessageProps,f=t.companyLogoProps;return React.createElement("div",{id:"bw-ntf",className:r?"":"b_hide"},React.createElement(n.CompanyLogo,i({},f)),React.createElement(n.DisambigMessage,i({},u)))},u}(React.Component);n.DisambigNotification=r})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var r=this.props,u=r.treatment,f=r.tenantName,t=null;switch(u){case n.Treatment.Documents:t=this.renderDocument();break;case n.Treatment.People:t=this.renderPerson();break;case n.Treatment.Bookmarks:case n.Treatment.Buildings:case n.Treatment.RefQna:t=i.renderCorpOnlyMessage(f,null,"bw-l");break;default:return null}return React.createElement("span",{className:"bw-disclmr"},t)},u.prototype.renderDocument=function(){var t=this.props.isSlim;return t?React.createElement("p",null,React.createElement("span",{className:"bw-lock bw-l"}),React.createElement("span",null,n.Strings.DocSearchShortPersonalizedDisclaimer),this.renderDisclaimerSeparator(),this.renderShortDocDisclaimer()):React.createElement("p",null,this.renderDocumentPersonalizedDisclaimer(),this.renderDocumentDisclaimer())},u.prototype.renderDisclaimerSeparator=function(){var n=this.props.isDisclaimerEnabled;return n?React.createElement("span",{className:"bw-spcbull"},"•"):null},u.prototype.renderShortDocDisclaimer=function(){var t=this.props,i=t.isDisclaimerEnabled,r=t.docPrivacyLinkUrl;return i?React.createElement("a",{className:"bw-meta",href:r,title:n.Strings.DocSearchLoggingDisclaimer},n.Strings.PrivacyLink):null},u.prototype.renderDocumentPersonalizedDisclaimer=function(){var t=this.props.documentSearchPivot;return t!=null&&t!==n.DocumentSearchPivot.Personalized?null:React.createElement("span",null,n.Strings.DocSearchPersonalizedDisclaimer,React.createElement("br",null))},u.prototype.renderDocumentDisclaimer=function(){var t=this.props.isDisclaimerEnabled;return t?React.createElement("span",null,n.Strings.DocSearchLoggingDisclaimer):null},u.prototype.renderPerson=function(){var t=this.props,r=t.tenantName,u=t.personCardPivot;switch(u){case n.PersonCardPivot.Documents:return this.renderPersonDocument();default:return i.renderCorpOnlyMessage(r,null,"bw-l")}},u.prototype.renderPersonDocument=function(){var t=this.props.personPrivacyLinkUrl;return React.createElement("p",null,n.Strings.PersonDocDisclaimer_Text,React.createElement("a",{href:t},n.Strings.PersonDocDisclaimer_LinkText),".")},u}(React.Component);i.Disclaimer=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(t){var u=t.cfg,f=t.disclaimer,i=t.documents,r=t.people,e=t.appRouter,o=t.userInfo,s=t.qrynf;return{cfg:u,isEnabled:f.isEnabled,ranking:e.ranking,documentSearchPivot:i!=null?i.selectedPivot:null,personCardPivot:r!=null?r.selectedPivot:null,userInfo:o,heroPersonId:n.Reducers.People.getHeroPersonId(t),queryIntent:s.intent}},u=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,c=t.isEnabled,u=t.cfg,r=t.ranking,l=t.documentSearchPivot,f=t.personCardPivot,e=t.userInfo,o=t.heroPersonId,a=t.queryIntent,s,h;return c?(s=f===n.PersonCardPivot.Documents&&e!=null&&!n.nullOrWs(o)?n.strFormat(u.ft.dlv.me,e.MySiteHostUrl,o):null,h=r!=null&&(r.placement===n.AnswerPlacement.ContextRegionTop||r.placement===n.AnswerPlacement.ContextRegionBottom),React.createElement(i.Disclaimer,{treatment:r==null?null:r.treatment,documentSearchPivot:l,personCardPivot:f,queryIntent:a,isDisclaimerEnabled:u.ft.dsclmr.e,personPrivacyLinkUrl:s,isSlim:h})):null},u}(React.Component);i.DisclaimerContainer=i.simpleConnect(r,u)})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(n){function i(){return n!==null&&n.apply(this,arguments)||this}return t(i,n),i.prototype.render=function(){var n=this.props,t=n.onClick,i=n.additionalClassName;return React.createElement("div",{className:"bw-cls "+(i||""),onClick:t},React.createElement("div",null))},i}(React.Component);n.DismissButton=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(n){function i(){return n!==null&&n.apply(this,arguments)||this}return t(i,n),i.prototype.render=function(){return React.createElement("div",{className:"bw-lln"},React.createElement("svg",null,React.createElement("line",{x1:"50%",y1:"0",x2:"50%",y2:"50%"}),React.createElement("line",{x1:"50%",y1:"50%",x2:"100%",y2:"50%"})))},i}(React.Component);n.ElbowLine=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,r=t.iconClassName,e=t.className,o=t.onMouseDown,u=t.email,s=t.children,f;return f=n.nullOrWs(r)?s:React.createElement(i.Icon,{className:r}),React.createElement("a",{className:e,href:"mailto:"+u,onMouseDown:o,title:n.strFormat(n.Strings.SendMail,u)},f)},u}(React.Component);i.EmailAction=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){var t=this.props,i=t.email,r=t.instClick;return React.createElement(n.ActionButton,{type:n.ActionButtonType.Email,onMouseDown:function(){return r("EML")},email:i})},r}(React.Component);n.EmailActionButton=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,r=t.email,u=t.themeDark,f=t.themeLight,e=t.onMouseDown,o="mailto:"+r,s=n.strFormat(n.Strings.SendMail,r);return React.createElement(i.SvgActionButton,{iconType:i.SvgIconType.Email,themeDark:u,themeLight:f,link:o,title:s,onMouseDown:e})},u}(React.Component);i.EmailLinkButton=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){var t=this.props.onClick;return React.createElement("div",{className:"bw-icon bw-exp",title:n.Strings.ExpandButtonTitle,onClick:t})},r}(React.Component);i.ExpandButton=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,u=t.isExpanded,e=t.onClick,f=t.showText,r=t.onMouseEvent,o=t.overwriteIcon,s=f==null||f?React.createElement("span",null,u?n.Strings.ExpandViewLess:n.Strings.ExpandViewMore):null,h=u?this.props.children:null,c=r!=null?function(){return r(!0)}:null,l=r!=null?function(){return r(!1)}:null;return React.createElement("div",{className:"bw-expCont"},h,React.createElement("div",{className:"bw-exp",onClick:e,onMouseOver:c,onMouseOut:l},s,React.createElement("span",null,React.createElement(i.ExpandIcon,{isExpanded:u,overwriteIcon:o}))))},u}(React.Component);i.Expander=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){var r=this.props,u=r.isExpanded,f=r.overwriteIcon,t=f!=null?f(u):null,e=t==null?React.createElement("svg",{width:"16px",height:"24px"},React.createElement("path",{d:"M0,22.9L10.9,12L0,1.1L1.1,0L13,12L1.1,24L0,22.9z"})):t,i="bw-expChev";return t==null&&(i=n.combineCss(i,u?"exp":"noexp")),React.createElement("div",{className:i},e)},r}(React.Component);n.ExpandIcon=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,r=t.url,u=t.onFloorPlanClick,f=t.isFloorPlanEnabled,e=t.instClick;return f?React.createElement(i.ActionButton,{type:i.ActionButtonType.Location,href:r,title:n.Strings.FloorActionTitle,onClick:u,onMouseDown:function(){return e("FLP")}}):null},u}(React.Component);i.FloorPlanActionButton=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(n){function i(){return n!==null&&n.apply(this,arguments)||this}return t(i,n),i.prototype.render=function(){return React.createElement("span",{className:"bw-fSep"},"·")},i}(React.Component);n.FooterItemSeparator=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(n){function i(){return n!==null&&n.apply(this,arguments)||this}return t(i,n),i.prototype.render=function(){var n=this.props.children;return React.createElement("span",{className:"bw-fItem"},n)},i}(React.Component);n.FooterItemWrapper=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){var t=this.props,i=t.theme,r=t.personEmail,u=t.personName,f=t.groupId,e=t.clickInst;return React.createElement(n.HeaderWrapper,{theme:i},this.renderProfileImageContainer(),this.renderTitle(),this.renderSkypeAction(),this.renderEmailAction(),this.renderPhoneAction())},r.prototype.renderProfileImageContainer=function(){var t=this.props,i=t.groupId,r=t.personEmail,u=t.personName;return i!=null||r!=null||u!=null?React.createElement(n.ProfileImageContainer,{groupId:i,personEmail:r,personName:u}):null},r.prototype.renderPhoneAction=function(){var t=this.props,i=t.phone,r=t.clickInst;return i!=null?React.createElement(n.PhoneLinkButton,{phone:i,onMouseDown:r?function(){return r("PHN")}:function(){}}):null},r.prototype.renderEmailAction=function(){var t=this.props,i=t.email,r=t.clickInst;return i!=null?React.createElement(n.EmailLinkButton,{email:i,onMouseDown:r?function(){return r("EML")}:function(){}}):null},r.prototype.renderSkypeAction=function(){var t=this.props,u=t.theme,i=t.personEmail,r=t.clickInst;return i!=null?React.createElement(n.SkypeLinkButton,{isMobile:!1,email:i,onMouseDown:r?function(){return r("IM")}:function(){}}):null},r.prototype.renderTitle=function(){var n=this.props,i=n.title1,t=n.title2;return React.createElement("div",{id:"bw-hTtl"},React.createElement("span",null,i),function(){return t!=null?React.createElement("span",null,React.createElement("span",{className:"bw-tSub"},"-"),React.createElement("span",{className:"bw-tSub"},t)):null}())},r}(React.Component);n.Header=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(n){function i(){return n!==null&&n.apply(this,arguments)||this}return t(i,n),i.prototype.render=function(){var n=this.props,t=n.theme,i=n.children,r={backgroundColor:t};return React.createElement("div",{id:"bw-cHead",style:r},i)},i}(React.Component);n.HeaderWrapper=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(n){function i(){return n!==null&&n.apply(this,arguments)||this}return t(i,n),i.prototype.render=function(){var n=this.props,t=n.className,r=n.inline,i="bw-noscrub";return r?React.createElement("span",{className:t,"data-tag":i}):React.createElement("div",{className:t,"data-tag":i})},i}(React.Component);n.Icon=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(r){function u(n){var t=r.call(this,n)||this;return t.activateFloorPlan=t.activateFloorPlan.bind(t),t}return t(u,r),u.prototype.render=function(){var n=this,t=this.props.items;return React.createElement("div",{className:"bw-info"},React.createElement("table",null,React.createElement("tbody",null,t.map(function(t,i){var r=t.value.map(function(i,r){return n.renderInfoValue(r,t,i)});return r.every(function(n){return n==null})?null:React.createElement("tr",{key:i},React.createElement("th",null,t.name),React.createElement("td",{className:"bw-infoVal bw-tnc"},r))}))))},u.prototype.activateFloorPlan=function(n){var t=this.props.floorPlan;n.preventDefault();t.activateFloorPlan!=null&&t.activateFloorPlan()},u.prototype.renderGroupOwnersInfo=function(t,i,r,u){var e=this.props.onMouseDown,f;return r==null?null:r.isLoading?React.createElement("span",{key:t},u):r.owners==null||r.owners.length===0?React.createElement("span",{key:t},n.Strings.Unavailable):(f=r.owners.map(function(n,t){return React.createElement("span",{key:t},React.createElement("a",{className:i.cssClass,href:n.requeryUrl,onMouseDown:function(){return e("GOWN")}},n.fullName),t===r.owners.length-1?null:React.createElement("span",null,", "))}),React.createElement("span",{key:t},f))},u.prototype.renderInfoValue=function(t,r,u){var f=this.props,o=f.onMouseDown,s=f.floorPlan,h=f.building,e;switch(r.type){case n.DataType.GroupOwners:return this.renderGroupOwnersInfo(t,r,this.props.groupOwners,u)}return e=i.renderInfoItem(t,r,u,o,this.activateFloorPlan,s,h),e!=null?e:r.type!=n.DataType.Phone?React.createElement("span",{key:t,className:r.cssClass},u):null},u}(React.Component);i.Info=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(n){var r=function(n){function r(){return n!==null&&n.apply(this,arguments)||this}return t(r,n),r.prototype.render=function(){var n=this.props,t=n.x1,r=n.x2,u=n.y1,f=n.y2,e={x1:t,x2:r,y1:u,y2:f};return React.createElement("svg",null,React.createElement("line",i({},e)))},r}(React.Component);n.Line=r})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(n){var t=n.appRouter,i=n.qrynf;return{query:i.qry,processingStatus:t.status,ranking:t.ranking}},f=function(u){function f(){return u!==null&&u.apply(this,arguments)||this}return t(f,u),f.prototype.componentDidMount=function(){bfbTel.logShown(n.EventScope.BfbController,"ANSML")},f.prototype.render=function(){var u=this.props,e=u.processingStatus,s=u.query,o=u.ranking,t,f;return o==null||o.placement!==n.AnswerPlacement.Pole?null:(t={},_ge("b_pole")!=null&&(t={marginBottom:"50px"}),e!=null)?React.createElement(r.AnswerFrameContainer,i({},t),React.createElement(r.ProgressContainer,{status:e,addQuotes:!0,query:s})):(f=this.buildContent(),f==null)?null:React.createElement(r.AnswerFrameContainer,i({},t),f)},f.prototype.buildContent=function(){var t=this.props.ranking,i=t==null?null:t.treatment;switch(i){case n.Treatment.People:return React.createElement(r.PersonSearchContainer,null);case n.Treatment.PeopleDisambig:return React.createElement(r.PersonDisambigContainer,{isSlim:!1});case n.Treatment.Documents:return React.createElement(r.DocumentSearchContainer,null);case n.Treatment.Bookmarks:return React.createElement(r.BookmarkContainer,{isSlim:!1});case n.Treatment.Buildings:return React.createElement(r.BuildingContainer,null);case n.Treatment.Group:return React.createElement(r.GroupSearchContainer,null);case n.Treatment.GroupDisambig:return React.createElement(r.GroupDisambigContainer,null);case n.Treatment.PowerBi:return React.createElement(r.PowerBiContainer,null)}return null},f}(React.Component);r.MainlineAppRouterContainer=r.simpleConnect(u,f)})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(n){function i(){return n!==null&&n.apply(this,arguments)||this}return t(i,n),i.prototype.render=function(){var n=this.props,t=n.children,i=n.additionalClass;return React.createElement("div",{className:"bw-msg "+(i||"")},React.createElement("div",{className:"bw-msgCont"},t),React.createElement("div",{className:"bw-triangle"}))},i}(React.Component);n.MessageWrapper=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,r=t.value,f=t.tooltip,l=t.showNullValue,e=t.elementValue,o=t.labelStringKey,a=t.additionalClassName,v=t.userCustomFormat,s=typeof r!="undefined"&&!n.nullOrWs(r),c;if(!s&&!l)return null;var u=!n.nullOrWs(o)&&s?n.Strings[o]:null,y=!f?u!=null?u+": "+r:r:f,h=React.createElement("div",{className:"bw-tnc"},r);return u!=null&&(h=v?React.createElement("div",{className:"bw-tnc"},React.createElement("span",{className:"bw-mCtm"},n.strFormat(u,r))):React.createElement("div",{className:"bw-tnc"},React.createElement("span",{className:"bw-mLabel"},u),React.createElement("span",null,": "),React.createElement("span",{className:"bw-mVal"},e!=null?e:r))),c=i.combineCss("bw-meta","bw-tnc",a),React.createElement("div",{className:c,title:y},h)},u}(React.Component);i.MetaInfo=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(i){function r(n){return i.call(this,n)||this}return t(r,i),r.prototype.render=function(){var t=this,n=this.props,i=n.pivots,r=n.selectedPivot,u=n.onClick;return React.createElement("div",null,React.createElement("ul",{className:"bw-pvt"},i.map(function(n){return React.createElement("li",{key:n.value,className:n.value==r?"s tab":"ns tab",href:"#","data-pivot":n.value,onClick:function(i){return t.onPivotClick(i,n.value)}},React.createElement("a",null,n.name))})))},r.prototype.onPivotClick=function(t,i){var r=this.props,f=r.onClick,u=r.pivotInst;t.preventDefault();bfbInst.cLog("TC","V",u[i]);bfbTel.logClicked(n.EventScope.BingAtWork,u[i],"PVT");f(i)},r}(React.Component);i.NavigationPivots=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(n){function i(){return n!==null&&n.apply(this,arguments)||this}return t(i,n),i.prototype.render=function(){var n=this.props,t=n.pivot,i=n.selectedPivot,r=n.children,u=t==i?"":"b_hide";return React.createElement("div",{className:u},r)},i}(React.Component);n.NavigationPivotWrapper=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){var t=this.props,i=t.iconClassName,f=t.className,e=t.onMouseDown,r=t.phone,o=t.children,u;return u=n.nullOrWs(i)?o:React.createElement("div",{className:i,"data-tag":"bw-noscrub"}),React.createElement("a",{className:f,href:n.getPhoneNumberUrl(r),onMouseDown:e,title:n.strFormat(n.Strings.CallNumber,r)},u)},r}(React.Component);i.PhoneAction=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){var t=this.props,i=t.phone,r=t.instClick;return React.createElement(n.ActionButton,{type:n.ActionButtonType.Phone,onMouseDown:function(){return r("PHN")},phone:i})},r}(React.Component);n.PhoneActionButton=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,r=t.phone,u=t.themeDark,f=t.themeLight,e=t.onMouseDown,o=n.getPhoneNumberUrl(r),s=n.strFormat(n.Strings.CallNumber,r);return React.createElement(i.SvgActionButton,{iconType:i.SvgIconType.Phone,themeDark:u,themeLight:f,link:o,title:s,onMouseDown:e})},u}(React.Component);i.PhoneLinkButton=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,c=t.imageSrc,f=t.dataEmail,e=t.dataName,l=t.additionalClassNames,a=t.activityString,o=t.url,s=t.onClick,h=t.additionalStyle,r={backgroundImage:c},u;return(r=h!=null?Object.assign(r,h):r,u={className:"bw-pImg "+l,style:r,title:a,"data-tag":"bw-scrubImg","data-email":n.nullOrWs(f)?null:f,"data-name":n.nullOrWs(e)?null:e},!n.nullOrWs(o))?React.createElement("a",i({href:o,onClick:s},u)):React.createElement("div",i({onClick:s},u))},u}(React.Component);r.ProfileImage=u})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(t){var i=t.cfg;return{cfg:i,presenceState:t.presence,getPhoto:function(i){return n.Reducers.Photo.getPhoto(t,i)},getPresence:function(i){return n.Reducers.OnlinePresence.getPresence(t,i)}}},u=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,h=t.cfg,r=t.personEmail,c=t.personName,l=t.groupId,a=t.getPhoto,v=t.getPresence,u=t.disablePresence,y=t.url,p=t.onClick,w=t.additionalStyle,f=t.contentToAppend,e=a(r||l),b=n.nullOrWs(e)?h.defaultProfileImage.url:n.imgSrc(e),o=u?null:v(r),k="bw-prsnc "+(r!=null&&!u?this.buildPresenceClassNames(o):""),d=this.buildActivityString(o),s=React.createElement(i.ProfileImage,{imageSrc:b,dataEmail:r,dataName:c,additionalClassNames:k,activityString:d,url:y,onClick:p,additionalStyle:w});return f!=null?React.createElement("div",{className:"bw-pImgCtnr"},s,f):s},u.prototype.buildPresenceClassNames=function(n){return n!=null?u.getPresenceHtmlClass(n.status):"bw-dft"},u.prototype.buildActivityString=function(t){var i=this.props.personName;return t?n.nullOrWs(i)||n.nullOrWs(t.activity)?i||t.activity:i+" – "+t.activity:""},u.getPresenceHtmlClass=function(t){switch(t){case n.PresenceStatus.Offline:return"bw-offln";case n.PresenceStatus.Online:return"bw-onln";case n.PresenceStatus.Away:return"bw-awy";case n.PresenceStatus.Busy:return"bw-bsy";case n.PresenceStatus.BeRightBack:return"bw-brb";case n.PresenceStatus.DoNotDisturb:return"bw-dnd";case n.PresenceStatus.Inactive:return"bw-idl";case n.PresenceStatus.Unknown:return"bw-unkn";default:return"bw-dft"}},u}(React.Component);i.ProfileImageContainer=i.simpleConnect(r,u)})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(n){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props.profileImageContainersProps;return React.createElement("div",{className:"bw-pImgs"},t.map(function(t,r){return React.createElement(n.ProfileImageContainer,i({key:r},t))}))},u}(React.Component);n.ProfileImageStrip=r})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){return React.createElement("div",null,React.createElement("div",{className:"bw-prg","data-tag":"bw-noscrub"},this.renderSpinner(),this.renderStatus(),this.renderFeedback()))},r.prototype.renderSpinner=function(){return this.props.showSpinner?React.createElement("div",{className:"bw-ld"}):null},r.prototype.renderStatus=function(){return this.props.hasStatusLinks?React.createElement("div",{id:"bw-prg-wlks"},this.props.statusMessage,React.createElement("ul",null,this.props.statusLinks.map(function(n,t){return React.createElement("li",{key:t},React.createElement("a",{href:n.url},n.displayText))}))):React.createElement("div",null,this.props.statusMessage)},r.prototype.renderFeedback=function(){return this.props.showGetFeedbackMsg?React.createElement("div",{className:"bw-prgFdbk"},React.createElement("a",{onClick:this.props.openFdbk},n.Strings.SuggestBookmarkLinkText)):null},r}(React.Component);i.Progress=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(n){var t=n.cfg,i=n.searchScenario,r=n.qrynf;return{mfa:t.ft.mfa,searchScenario:i,isInline:t.render.isInline}},u=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var e=this,r=this.props,u=r.query,t=r.status,o=r.searchScenario,s=r.isInline;u==null&&(u="");t==null&&(t=n.ProcessingStatus.Started);var h=t===n.ProcessingStatus.Started,c=t===n.ProcessingStatus.ErrorMfa,f=!s&&t===n.ProcessingStatus.NoResults&&o===n.GleamOption.Bookmarks,l=this.getStatusMessage(u,t,f),a=this.getStatusLinks(t);return React.createElement(i.Progress,{showSpinner:h,hasStatusLinks:c,statusMessage:l,openFdbk:function(){return e.openFdbk(u)},showGetFeedbackMsg:f,statusLinks:a})},u.prototype.getStatusMessage=function(t,i,r){var f=this.props,s=f.addQuotes,h=f.mfa,c=f.searchScenario,e=f.searchTargetOverwrite,u=e?e:t,o;u=s?'"'+n.rmDoubleQuotes(u)+'"':u;switch(i){case n.ProcessingStatus.Started:return""+n.strFormat(this.getString(n.ProcessingStatus.Started),u);case n.ProcessingStatus.Timeout:return n.Strings.TimedoutRequest;case n.ProcessingStatus.NoResults:return""+n.strFormat(this.getString(n.ProcessingStatus.NoResults),u)+(r?".":"");case n.ProcessingStatus.Complete:return"";case n.ProcessingStatus.SsoPending:return n.Strings.SsoIsPending;case n.ProcessingStatus.ErrorGeneral:return n.Strings.ErrorGeneral;case n.ProcessingStatus.ErrorMfa:return o=h.e?"MfaMessage":"TimedoutRequest",n.Strings[o];case n.ProcessingStatus.ErrorPrivateGroup:return n.Strings.ErrorPrivateGroup;default:return"Processing"}},u.prototype.openFdbk=function(t){var i=_w.feedback,r;i!=null&&(r=n.strFormat(n.Strings.SuggestBookmark,n.rmDoubleQuotes(t)),i.showForm(r))},u.prototype.getStatusLinks=function(t){var i=this.props.mfa;switch(t){case n.ProcessingStatus.ErrorMfa:if(i.e)return[{displayText:n.Strings.MfaLinkMessage,url:i.deeplinkFormat.replace("{0}",encodeURIComponent(window.location.href))}];default:return[]}},u.prototype.getString=function(t){var r=this.props,u=r.query,f=r.searchScenario,e=r.excludeScenarioInStatusMessage,i="";if(!e)switch(f){case n.GleamOption.People:i="People";break;case n.GleamOption.Documents:i="Document";break;case n.GleamOption.Bookmarks:i="Bookmark";break;case n.GleamOption.Group:i="Group"}return(u===n.Strings.FloorPlan.toLocaleLowerCase()&&(i="FloorPlan"),t===n.ProcessingStatus.Started)?n.Strings["Processing"+i+"RequestFor"]:t===n.ProcessingStatus.NoResults?n.Strings["No"+i+"ResultsFoundFor"]:""},u}(React.Component);i.ProgressContainer=i.simpleConnect(r,u)})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){var i=this.props,t=i.link,f=i.onMouseDown,r,u;return t==null||n.nullOrWs(t.url)?null:(r=t.displayText,u=t.url,React.createElement("a",{className:"bw-sm",href:u,onMouseDown:f},r))},r}(React.Component);i.SeeMoreLink=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(n){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,r=t.theme,u=t.children,f=t.headerProps,e=t.footerProps,o=t.additionalClassName,s={borderTopColor:r};return React.createElement("div",{id:"bw-s",className:o},React.createElement(n.AnswerHeader,i({},f)),React.createElement("div",{className:"bw-s-ans",style:s},u),React.createElement(n.AnswerFooter,i({},e)))},u}(React.Component);n.SimpleAnswerFrame=r})(r=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(n){var t=n.cfg,i=n.disclaimer,r=n.appRouter;return{isEnabled:i.isEnabled,ranking:r.ranking,cfg:t,tenantName:t.tenantMetadata.displayName}},u=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var r=this.props,o=r.isEnabled,t=r.ranking,u=r.cfg,s=r.tenantName,f,e;return o?(f=t!=null&&(t.placement===n.AnswerPlacement.ContextRegionTop||t.placement===n.AnswerPlacement.ContextRegionBottom),e=t==null?null:t.treatment,React.createElement(i.Disclaimer,{treatment:e,isDisclaimerEnabled:u.ft.dsclmr.e,tenantName:s,isSlim:f,docPrivacyLinkUrl:u.ft.prl.deeplinkFormat})):null},u}(React.Component);i.SimpleDisclaimerContainer=i.simpleConnect(r,u)})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){var t=this.props,i=t.theme,r=t.title;return React.createElement(n.HeaderWrapper,{theme:i},React.createElement("div",{id:"bw-hTtl"},r))},r}(React.Component);n.SimpleHeader=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(n){return{qrynf:n.qrynf,searchScenario:n.searchScenario}},u=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,u=t.error,h=t.searchScenario,c=t.isLoading,l=t.addQuotes,r=t.queryOverwrite,a=t.searchTargetOverwrite,f=t.qrynf,e=c?n.ProcessingStatus.Started:n.ProcessingStatus.NoResults,o,s;return u!=null&&(e=n.mapStatus(u,h)),o=!n.nullOrWs(r),s=n.nullOrWs(r)?f!=null?f.qry:null:r,React.createElement(i.ProgressContainer,{status:e,addQuotes:l,query:s,excludeScenarioInStatusMessage:o,searchTargetOverwrite:a})},u}(React.Component);i.SimpleProgressContainer=i.simpleConnect(r,u)})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return t(u,r),u.prototype.render=function(){var t=this.props,u=t.isMobile,r=t.email,f=t.themeDark,e=t.themeLight,o=t.onMouseDown,s=u?"ms-sfb://chat?id="+r:"sip:"+r,h=n.strFormat(n.Strings.OpenSkypeChat,r);return React.createElement(i.SvgActionButton,{iconType:i.SvgIconType.Skype,themeDark:f,themeLight:e,link:s,title:h,onMouseDown:o})},u}(React.Component);i.SkypeLinkButton=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){var t=this.props,i=t.text,r=t.additionalClassName;return React.createElement("div",{className:"bw-smh"},React.createElement("div",{className:n.combineCss("bw-tnc",r)},i))},r}(React.Component);n.SlimHeader=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i,r;(function(n){n[n.Email=0]="Email";n[n.Phone=1]="Phone";n[n.Skype=2]="Skype";n[n.Poi=3]="Poi"})(i=n.SvgIconType||(n.SvgIconType={}));r=function(n){function r(){return n!==null&&n.apply(this,arguments)||this}return t(r,n),r.prototype.render=function(){var n=this.props.type;switch(n){case i.Email:return this.renderEmail();case i.Phone:return this.renderPhone();case i.Skype:return this.renderSkype();case i.Poi:return this.renderPoi();default:return null}},r.prototype.renderEmail=function(){return React.createElement("svg",{className:"bw-si-email",viewBox:"0 0 20 20"},React.createElement("polyline",{points:"0.5 3.35 10.09 9.56 19.36 3.48"}),React.createElement("rect",{x:"0.5",y:"3.5",width:"19",height:"11"}))},r.prototype.renderPhone=function(){return React.createElement("svg",{className:"bw-si-phone",viewBox:"0 0 20 20"},React.createElement("path",{d:"M15.42,11.26a2.06,2.06,0,0,1,.78.15,2,2,0,0,1,.66.44l2,2a2,2,0,0,1,.44.66,2.08,2.08,0,0,1,0,1.57,2,2,0,0,1-.44.66q-.53.54-1,1a5.38,5.38,0,0,1-.9.7,3.72,3.72,0,0,1-1,.43,5.63,5.63,0,0,1-1.36.14,8.4,8.4,0,0,1-2.39-.36,13.23,13.23,0,0,1-2.44-1,17.52,17.52,0,0,1-2.38-1.52,20.5,20.5,0,0,1-2.2-1.93A21.17,21.17,0,0,1,3.34,12a17.27,17.27,0,0,1-1.5-2.38,13.32,13.32,0,0,1-1-2.42A8.34,8.34,0,0,1,.5,4.85,5.57,5.57,0,0,1,.64,3.49a3.82,3.82,0,0,1,.43-1,5.13,5.13,0,0,1,.7-.9q.41-.43,1-1A2.06,2.06,0,0,1,3.38.16,2,2,0,0,1,5,.16,2,2,0,0,1,5.61.6l2,2a2,2,0,0,1,.44.66,2.06,2.06,0,0,1,.15.78,1.81,1.81,0,0,1-.14.73,2.63,2.63,0,0,1-.34.58,3.4,3.4,0,0,1-.45.47c-.16.14-.31.28-.45.42a2.73,2.73,0,0,0-.34.41.8.8,0,0,0-.14.45.82.82,0,0,0,.25.6l5.11,5.11a.82.82,0,0,0,.6.25A.8.8,0,0,0,12.8,13a2.73,2.73,0,0,0,.41-.34c.14-.14.28-.29.42-.45a3.4,3.4,0,0,1,.47-.45,2.63,2.63,0,0,1,.58-.34A1.81,1.81,0,0,1,15.42,11.26Zm-.77,6.56a4.24,4.24,0,0,0,1.12-.13,2.89,2.89,0,0,0,.81-.36,4.22,4.22,0,0,0,.71-.59l.79-.8a.82.82,0,0,0,.25-.6.8.8,0,0,0-.13-.39,3.56,3.56,0,0,0-.35-.48q-.21-.25-.48-.52l-.52-.5L16.37,13,16,12.7a.83.83,0,0,0-.61-.25.78.78,0,0,0-.45.14,2.84,2.84,0,0,0-.41.34l-.42.45a3.66,3.66,0,0,1-.48.45,2.63,2.63,0,0,1-.58.34,1.81,1.81,0,0,1-.73.14,2.06,2.06,0,0,1-.78-.15,2,2,0,0,1-.66-.44L5.79,8.6a2,2,0,0,1-.44-.66,2.06,2.06,0,0,1-.15-.78,1.81,1.81,0,0,1,.14-.73,2.63,2.63,0,0,1,.34-.58,3.66,3.66,0,0,1,.45-.48l.45-.42a2.84,2.84,0,0,0,.34-.41.78.78,0,0,0,.14-.45.83.83,0,0,0-.25-.61l-.32-.34-.44-.47-.5-.52Q5.29,1.88,5,1.67a3.56,3.56,0,0,0-.48-.35.8.8,0,0,0-.39-.13.82.82,0,0,0-.6.25l-.79.79a4.76,4.76,0,0,0-.59.71,2.74,2.74,0,0,0-.37.81,4.2,4.2,0,0,0-.13,1.11A7.3,7.3,0,0,0,2,7,12,12,0,0,0,3,9.21a16.81,16.81,0,0,0,1.42,2.18,19.5,19.5,0,0,0,1.78,2,19.88,19.88,0,0,0,2,1.76,16.78,16.78,0,0,0,2.17,1.4,12,12,0,0,0,2.19.92A7.22,7.22,0,0,0,14.65,17.82Z"}))},r.prototype.renderSkype=function(){return React.createElement("svg",{className:"bw-si-skype",viewBox:"0 0 20 20"},React.createElement("path",{d:"M18.8,11.55a5.31,5.31,0,0,1,.7,2.63,5.19,5.19,0,0,1-.42,2.07,5.31,5.31,0,0,1-2.82,2.82,5.19,5.19,0,0,1-2.07.42,5.31,5.31,0,0,1-2.63-.7q-.39.07-.77.1t-.77,0a8.75,8.75,0,0,1-2.37-.32,9,9,0,0,1-2.13-.9,8.94,8.94,0,0,1-3.21-3.21,9,9,0,0,1-.9-2.13A8.75,8.75,0,0,1,1.07,10q0-.39,0-.77t.1-.77A5.31,5.31,0,0,1,.5,5.82,5.19,5.19,0,0,1,.92,3.74,5.31,5.31,0,0,1,3.74.92,5.19,5.19,0,0,1,5.82.5a5.31,5.31,0,0,1,2.63.7q.39-.07.77-.1t.77,0a8.75,8.75,0,0,1,2.38.32,9,9,0,0,1,2.13.9,8.94,8.94,0,0,1,3.21,3.21,9,9,0,0,1,.9,2.13A8.75,8.75,0,0,1,18.93,10q0,.39,0,.77T18.8,11.55ZM10,15.71a7.44,7.44,0,0,0,1.1-.08,6.15,6.15,0,0,0,1.06-.26,4.31,4.31,0,0,0,.94-.45,3.25,3.25,0,0,0,.76-.66,3,3,0,0,0,.51-.89,3.32,3.32,0,0,0,.19-1.15,2.93,2.93,0,0,0-.29-1.37,2.77,2.77,0,0,0-.76-.92,3.87,3.87,0,0,0-1.07-.58A10.43,10.43,0,0,0,11.25,9L10,8.74A8.42,8.42,0,0,1,9,8.47a2.31,2.31,0,0,1-.76-.39.78.78,0,0,1-.29-.64,1.12,1.12,0,0,1,.16-.62,1.25,1.25,0,0,1,.41-.4A1.76,1.76,0,0,1,9,6.21a3.1,3.1,0,0,1,.63-.06,3.3,3.3,0,0,1,1,.12,2.6,2.6,0,0,1,.66.3,2.45,2.45,0,0,1,.46.39l.36.39a1.85,1.85,0,0,0,.37.3.9.9,0,0,0,.48.12,1.51,1.51,0,0,0,.43-.06,1.09,1.09,0,0,0,.36-.18.89.89,0,0,0,.25-.3.91.91,0,0,0,.09-.42A1.47,1.47,0,0,0,13.89,6a2.41,2.41,0,0,0-.58-.64,4.17,4.17,0,0,0-.82-.49,6.68,6.68,0,0,0-.93-.34,7.08,7.08,0,0,0-.92-.2,5.53,5.53,0,0,0-.78-.06,7.25,7.25,0,0,0-1.56.17A4.39,4.39,0,0,0,6.88,5a3.1,3.1,0,0,0-1,1,2.9,2.9,0,0,0-.39,1.54,3.29,3.29,0,0,0,.19,1.16,2.43,2.43,0,0,0,.53.85,2.91,2.91,0,0,0,.84.59,6.11,6.11,0,0,0,1.11.39l1.41.36,1.41.36a2.57,2.57,0,0,1,.42.15,1.37,1.37,0,0,1,.36.23A1.11,1.11,0,0,1,12,12a1,1,0,0,1,.09.44,1.14,1.14,0,0,1-.2.67,1.66,1.66,0,0,1-.51.47,2.36,2.36,0,0,1-.67.27,2.92,2.92,0,0,1-.69.09,3.12,3.12,0,0,1-1-.15,2.4,2.4,0,0,1-.7-.38,2.53,2.53,0,0,1-.47-.49l-.37-.49a1.83,1.83,0,0,0-.4-.38,1,1,0,0,0-.55-.15,1.14,1.14,0,0,0-.77.28,1,1,0,0,0-.32.75,1.55,1.55,0,0,0,.11.57,2.49,2.49,0,0,0,.27.51,2.92,2.92,0,0,0,.83.82,4.85,4.85,0,0,0,1.07.52,6.28,6.28,0,0,0,1.18.28A8.56,8.56,0,0,0,10,15.71Z"}))},r.prototype.renderPoi=function(){return React.createElement("svg",{className:"bw-si-poi",viewBox:"0 0 20 20"},React.createElement("path",{d:"M10,0.5c-3.59,0-6.5,3.078-6.5,6.875c0,3.413, 5.251, 9.678, 6.314, 10.911c0.1, 0.115, 0.273, 0.115, 0.373, 0c1.063-1.233, 6.314-7.498, 6.314-10.911C16.5, 3.578, 13.59, 0.5, 10, 0.5z"}),React.createElement("circle",{cx:"10",cy:"7",r:"2.5"}))},r}(React.Component);n.SvgIcon=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return t(r,i),r.prototype.render=function(){var t=this.props,u=t.iconType,i=t.themeDark,r=t.themeLight,f=t.link,e=t.title,o=t.onMouseDown,s=i==null||r==null,h=s?null:{borderColor:r,backgroundColor:i};return React.createElement("a",{className:"bw-slb",style:h,href:f,title:e,onMouseDown:o},React.createElement(n.SvgIcon,{type:u}))},r}(React.Component);n.SvgActionButton=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(i){var r=function(i){function r(n){return i.call(this,n)||this}return t(r,i),r.prototype.render=function(){var n=this.props,i=n.shouldRender,r=n.isVisible,u=n.setVeilVisibility,t;return i?(t="bw-veilCntnr "+(r?"":"bw-nonVeil"),React.createElement("div",{ref:"veilContainer",className:t},this.renderDrawer(),React.createElement("div",{ref:"veilButton",className:"bw-veil",onClick:function(){return u(!1)}}))):null},r.prototype.componentDidUpdate=function(){var n=this.props.isVisible;sb_st(function(){sj_evt.fire(n?r.onVeilShow:r.onVeilHidden)},r.veilAnimationCompletionInMilliseconds)},r.prototype.componentDidMount=function(){var n=this;this.props.shouldRender&&(this.setVeilSize(),sj_evt.bind("onPP",function(){n.trySetVeilSize()},!0))},r.prototype.renderDrawer=function(){var t=this.props,i=t.isVisible,r=t.setVeilVisibility;return React.createElement("div",{className:"bw-veilDrawer",onClick:function(){return r(!i)}},i?n.Strings.HideNonWorkResultsVeil:n.Strings.ShowNonWorkResultsVeil)},r.prototype.setVeilSize=function(){var i=this,n,t;this.trySetVeilSize()||(n=10,t=setInterval(function(){n--<=0?(clearInterval(t),t=null):i.trySetVeilSize()&&(n=0)},50))},r.prototype.trySetVeilSize=function(){var n=_ge("b_content"),t=this.getVeilButtonElement(),i=this.getVeilContainerElement();if(t!=null&&i!=null&&n!=null){var r=n.getBoundingClientRect(),u=i.getBoundingClientRect(),f=r.bottom-u.bottom,e=f,o=_d.body.getBoundingClientRect().width;return t.setAttribute("style","height: "+e+"px; width: "+o+"px"),!0}return!1},r.prototype.getVeilButtonElement=function(){return this.refs.veilButton},r.prototype.getVeilContainerElement=function(){return this.refs.veilContainer},r.onVeilHidden="onVeilHidden",r.onVeilShow="onVeilShow",r.veilAnimationCompletionInMilliseconds=1e3,r}(React.Component);i.Veil=r})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var i;(function(n){var i=function(n){function i(){return n!==null&&n.apply(this,arguments)||this}return t(i,n),i.prototype.render=function(){return React.createElement("div",{className:"bw-vln"},React.createElement("svg",null,React.createElement("line",{x1:"0",y1:"0",x2:"0",y2:"100%"})))},i}(React.Component);n.VerticalLine=i})(i=n.Components||(n.Components={}))}(n||(n={}));t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();i=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var r;(function(r){var u=function(u){function f(){return u!==null&&u.apply(this,arguments)||this}return t(f,u),f.prototype.render=function(){var t=this.props.companyLogoProps;return React.createElement("div",{className:"bw-rl"},React.createElement(r.CompanyLogo,i({},t)),this.renderSeparator(),React.createElement("div",{className:"bw-beta"},n.Strings.BetaMessage))},f.prototype.renderSeparator=function(){var t=this.props.showSeparator,n=t?{x1:"50%",y1:"30%",x2:"50%",y2:"70%"}:null;return n!=null?React.createElement(r.Line,i({},n)):null},f}(React.Component);r.WorkResultLabel=u})(r=n.Components||(n.Components={}))}(n||(n={})),function(n){var t;(function(t){function i(t,i,r){i!=null&&(r===n.UxDesignVersion.V1_1?ReactDOM.render(React.createElement(ReactRedux.Provider,{store:t.getStore()},React.createElement(n.Components2.NavHeaderPlacementContainer,null)),i):ReactDOM.render(React.createElement(ReactRedux.Provider,{store:t.getStore()},React.createElement(n.Components.MainlineAppRouterContainer,null)),i))}function r(t,i,r,u){i!=null&&(u===n.UxDesignVersion.V1_1?ReactDOM.render(React.createElement(ReactRedux.Provider,{store:t.getStore()},React.createElement(n.Components2.ContextRegionPlacementContainer,{placement:r})),i):ReactDOM.render(React.createElement(ReactRedux.Provider,{store:t.getStore()},React.createElement(n.Components.ContextRegionAppRouterContainer,{placement:r})),i))}function u(t,i,r){i!=null&&(r===n.UxDesignVersion.V1_1?ReactDOM.render(React.createElement(ReactRedux.Provider,{store:t.getStore()},React.createElement(n.Components2.AlgoPlacementContainer,null)),i):ReactDOM.render(React.createElement(ReactRedux.Provider,{store:t.getStore()},React.createElement(n.Components.AlgoAppRouterContainer,null)),i))}function f(t,i,r){i!=null&&(r===n.UxDesignVersion.V1_1?ReactDOM.render(React.createElement(ReactRedux.Provider,{store:t.getStore()},React.createElement(n.Components2.GleamContainer,null)),i):ReactDOM.render(React.createElement(ReactRedux.Provider,{store:t.getStore()},React.createElement(n.Components.GleamContainer,null)),i))}function e(t,i,r){r===n.UxDesignVersion.V1_1?ReactDOM.render(React.createElement(ReactRedux.Provider,{store:t.getStore()},React.createElement(n.Components2.NavHeaderBookmark,null)),i):ReactDOM.render(React.createElement(ReactRedux.Provider,{store:t.getStore()},React.createElement(n.Components.BookmarkContainer,{isSlim:!1})),i)}function o(t,i,r){r===n.UxDesignVersion.V1_1?ReactDOM.render(React.createElement(ReactRedux.Provider,{store:t.getStore()},React.createElement(n.Components2.PersonPreview,null)),i):ReactDOM.render(React.createElement(ReactRedux.Provider,{store:t.getStore()},React.createElement(n.Components.PersonPreviewContainer,null)),i)}t.renderMainlineAppRouter=i;t.renderContextRegionAppRouter=r;t.renderAlgoAppRouter=u;t.renderGleam=f;t.renderBookmarkPreview=e;t.renderPersonPreview=o})(t=n.NativeRender||(n.NativeRender={}))}(n||(n={}));new n.BundleReady("OnScriptLoad:BingAtWork:BfbContentBundle")}sj_evt.bind("OnScriptLoad:BfbDependencies",function(){sj_evt.bind("OnScriptLoad:BfbPreBundle",function(){t(n)},!0,null,!0)},!0,null,!0)}(BingAtWork||(BingAtWork={}));new BingAtWork.BundleReady("OnScriptLoad:BingAtWork:BfbBundle")